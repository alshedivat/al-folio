<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Your Malware Is Talking. I’m Listening. | Manuel Boll </title> <meta name="author" content="Manuel Boll"> <meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design. "> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://kaeptenbalu.github.io/news/announcement_10/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Manuel</span> Boll </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">home </a> </li> <li class="nav-item "> <a class="nav-link" href="/about/">whoami </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Your Malware Is Talking. I’m Listening.</h1> <p class="post-meta"> Created on January 13, 2026 by Manuel Boll </p> <p class="post-tags"> <i class="fa-solid fa-calendar fa-sm"></i> 2026   ·   <i class="fa-solid fa-hashtag fa-sm"></i> telegram   <i class="fa-solid fa-hashtag fa-sm"></i> malware   <i class="fa-solid fa-hashtag fa-sm"></i> threat-intel   <i class="fa-solid fa-hashtag fa-sm"></i> ail </p> </header> <article class="post-content"> <div id="markdown-content"> <p>Communication has always been a core component of technical systems. Long before modern messaging platforms, IRC channels were used to surface system state and events. IRC was less about conversation and more about transport. Telegram plays a similar role today. It provides globally reachable infrastructure, a stable API, and immediate visibility. In environments involving compromised systems, this communication layer becomes critical: between a target system and its operator, there is always an exchange of execution results, errors, files, and screenshots. Telegram is often chosen because it is easy to integrate and requires little additional infrastructure. It may be used purely for message transport or drift into a lightweight control interface via bots. While these setups can be secured, safeguards are not always applied consistently. Tokens are reused, environments overlap, and chats accumulate history. Telegram bots are controlled entirely through their tokens and chat identifiers. When embedded into software and reused across deployments, they become fixed communication endpoints that continuously emit structured, timestamped data into chats acting as live logs. To observe this communication at scale, I built a dedicated toolchain,<a href="https://github.com/kaeptenbalu/MalwareBotReplayer" rel="external nofollow noopener" target="_blank">MalwareBotReplayer</a>, to collect, validate, and mirror Telegram bot traffic over time. Telegram is therefore not just a messenger, but often an unintentional log file — and log files tend to reveal more than intended.</p> <hr> <h2 id="overview-the-toolchain">Overview: The Toolchain</h2> <p>The pipeline consists of five clearly separated steps. Each step has a single responsibility and builds on the previous one. PocketBase accompanies the entire toolchain as a persistent state and metadata layer.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>get_tg_connections_files.py
↓
get_bot.py
↓
prepare_bot.py
↓
forward_message.py
↓
AIL Framework
</code></pre></div></div> <hr> <h2 id="1-collecting-input-data--get_tg_connections_filespy">1. Collecting Input Data – get_tg_connections_files.py</h2> <p>The first step is intentionally simple. This script downloads all the Files which communication to api.telegram.org from VirusTotal using the official API and stores them locally in JSON files. Rate limits are respected, and all subsequent processing operates exclusively on these local files. At this stage, no evaluation takes place. There is no classification or behavioral assessment.</p> <p><img src="https://github.com/kaeptenbalu/kaeptenbalu.github.io/blob/main/assets/img/comunication_files_vt.png?raw=true" alt="comunication_files_vt"></p> <h2 id="2-extraction-and-validation--get_botpy">2. Extraction and Validation – get_bot.py</h2> <p>The second step performs the actual selection. The script processes the collected JSON files and makes for every file an api request to vt to get the <code class="language-plaintext highlighter-rouge">contacted_urls</code> of the file in there it is focusing primarily on the <code class="language-plaintext highlighter-rouge">contacted_urls</code>. Telegram Bot API URLs appear frequently, often including complete bot tokens and chatids. These informations are not indicators, they are identities. Possession of a token and chatid allows direct interaction with the bot and access to its communication context. Before a token is used further, it is validated against the Telegram API. A simple <code class="language-plaintext highlighter-rouge">getMe</code> request is sufficient to determine whether the bot exists and responds:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"</span><span class="s">https://api.telegram.org/bot</span><span class="si">{</span><span class="n">token</span><span class="si">}</span><span class="s">/getMe</span><span class="sh">"</span>
</code></pre></div></div> <p>All valid results are stored in PocketBase, which becomes the authoritative source of truth for state throughout the entire pipeline.</p> <p><img src="https://github.com/kaeptenbalu/kaeptenbalu.github.io/blob/main/assets/img/token_chatid_vt.png?raw=true" alt="token_chatid_vt"></p> <p><img src="https://github.com/kaeptenbalu/kaeptenbalu.github.io/blob/main/assets/img/pocketbase_db.png?raw=true" alt="pocketbase_db"></p> <h2 id="3-bot-preparation--prepare_botpy">3. Bot Preparation – prepare_bot.py</h2> <p>Telegram bots cannot add themselves to groups. They cannot manage their own visibility. For this organizational step, a regular Telegram user account is used, controlled via Telethon. The preparation script invites validated bots into a controlled Telegram group. If webhooks are configured, they are temporarily removed and later restored. The intention is not to alter behavior permanently, but to make communication observable without disrupting existing workflows. PocketBase remains central at this stage as well. States are updated, target chat identifiers are stored (the id of the controlled Telegram group) and failure conditions are tracked. The process is fully resumable, allowing the system to scale to hundreds of bots without losing track of progress or consistency.</p> <h2 id="4-mirroring-communication--forward_messagepy">4. Mirroring Communication – forward_message.py</h2> <p>The heart of the toolchain is the forwarding script. Messages are not interpreted, filtered, or analyzed. They are mirrored. Telegram provides the forwardMessages API endpoint, which allows multiple messages to be forwarded in batches. The script iterates sequentially over message identifiers and persists progress after each block:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">last_id</span> <span class="o">=</span> <span class="n">rec</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="sh">"</span><span class="s">lastmessageid</span><span class="sh">"</span><span class="p">)</span>
<span class="n">start_id</span> <span class="o">=</span> <span class="mi">1</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">last_id</span> <span class="k">else</span> <span class="nf">int</span><span class="p">(</span><span class="n">last_id</span><span class="p">)</span>
</code></pre></div></div> <p>This mechanism ensures that forwarding can be paused, resumed, or restarted at any time without data loss or duplication. Rate limits are respected, delays honored, and every API response archived for traceability.</p> <h2 id="5-downstream-processing--ail-framework">5. Downstream Processing – AIL Framework</h2> <p>In the final step, mirrored chats are ingested into the AIL Framework. Using the Telegram feeder, messages are indexed, correlated, and retained for long-term analysis. The value does not lie in individual findings but in repetition. Identical patterns, recurring infrastructure, and consistent workflows emerge across many bots over time. Telegram provides context; AIL provides structure. This turns ephemeral chat messages into longitudinal data that can be searched, correlated, and reasoned about beyond individual incidents.</p> <p><img src="https://github.com/kaeptenbalu/kaeptenbalu.github.io/blob/main/assets/img/ail_findings.png?raw=true" alt="ail_findings"></p> <p><img src="https://github.com/kaeptenbalu/kaeptenbalu.github.io/blob/main/assets/img/ail_chats.png?raw=true" alt="ail_chats"></p> <hr> <h2 id="when-authors-execute-their-own-software">When Authors Execute Their Own Software</h2> <p>One of the most revealing aspects of mirrored communication is that it does not originate exclusively from compromised systems. A significant portion of the observed data comes from the operators themselves. Authors frequently execute their own software. Sometimes deliberately, as part of testing or development. Sometimes unintentionally, in environments that are closer to production than intended. Debug builds are run against real infrastructure, test deployments reuse live credentials, and communication pipelines remain unchanged across stages. As a result, Telegram chats often contain information not only from victims, but from the operators’ own systems as well. Over time, observed artifacts include C2 server credentials, Cloudflare configuration data, panel URLs, debug output, screenshots, <code class="language-plaintext highlighter-rouge">whoami</code> results, geolocation data, and in some cases even webcam images originating from the authors’ machines. This behavior is not exceptional. It is a recurring pattern. The underlying idea of observing threat actor communication through their own operational channels was originally articulated in the article <a href="https://polygonben.github.io/malware%20analysis/Compromising-Threat-Actor-Communications/" rel="external nofollow noopener" target="_blank"><em>“Compromising Threat Actor Communications”</em> by polygonben</a>. That work demonstrated how operator side execution and misconfiguration can expose internal details through the same channels used to monitor victims. What becomes clear when observing this behavior over time is that communication pipelines rarely distinguish between internal and external contexts. Once a message reaches the bot, it is treated the same way regardless of origin. Development output, test results, and real-world data all end up in the same chat. Telegram does not enforce separation of environments. It preserves history, context, and metadata by design. When operators reuse bots, tokens, and chats across stages, the platform effectively turns into a shared log file for everything that passes through it. These disclosures are rarely intentional. They are side effects of convenience, iteration speed, and human error.</p> <p><img src="https://github.com/kaeptenbalu/kaeptenbalu.github.io/blob/main/assets/img/actor.png?raw=true" alt="actor"></p> <h2 id="conclusion">Conclusion</h2> <p>Telegram is not a specialized offensive tool. It is a communication medium.</p> <p>And precisely because of that, it becomes a source. Not through exploits or vulnerabilities, but through visibility. Systems that speak produce records. Records collected over time produce insight.</p> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2026 Manuel Boll. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a>. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Made with ❤️ and Mate. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>