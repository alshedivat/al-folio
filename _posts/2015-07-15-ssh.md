---
layout: post
title: SSH config
date: 2015-07-15 15:09:00
description: useful configuration settings for ssh
---

### Key generation

To generate key pairs  under ~/.ssh/id_rsa

{% highlight Bash %}

# -C is the comment appended at id_rsa.pub
ssh-keygen -t rsa -b 4096 -C "your_email@example.com"

{% endhighlight %}

### Credential management, just like opengpg
{% highlight Bash %}

# start ssh agent
eval `ssh-agent`
# kill ssh agent
ssh-agent -k
# put the following to ~/.bashrc for auto start of ssh-agent upon loginï¼Œand killing ssh-agent after log out
eval $(ssh-agent -s) > /dev/null
trap 'test -n "$SSH_AGENT_PID" && eval `/usr/bin/ssh-agent -k` > /dev/null' 0

{% endhighlight %}

### Send authorized public keys

> ssh-copy-id -i ~/.ssh/id_rsa.pub user@host

OR

> ssh user@host 'mkdir -p .ssh && cat >> .ssh/authorized_keys' < ~/.ssh/id_rsa.pub

### Login config with $HOME/.ssh/config

> **Tips** \
> scp can directly use the settings, e.g., scp \<file\> target-8022 \
> VS Code Remote Extension can also directly read the settings

{% highlight Bash %}

Host *
    AddKeysToAgent yes      # add private keys to ssh-agent
    UseKeychain yes         # save credentials to agent
    ServerAliveInterval 10  
    ServerAliveCountMax 3

Host jump-box
  HostName Gateway_server
  User NAME
  Port 22
  IdentityFile ~/.ssh/id_rsa

Host target-8022
  HostName 10.37.0.39
  Port 8022
  User USER
  IdentityFile ~/.ssh/id_rsa
  ProxyCommand ssh -q -W %h:%p jump-box
  RemoteForward 4000 localhost:4000

  Host target-8023
  HostName 10.37.0.39
  Port 8023
  User USER
  IdentityFile ~/.ssh/id_rsa
  ProxyCommand ssh -q -W %h:%p jump-box
  RemoteForward 4000 localhost:4000

{% endhighlight %}