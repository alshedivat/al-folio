<ul class="card-text font-weight-light list-group list-group-flush">
  {%- comment -%}
  Normalize start/end (handle YYYY, YYYY-MM, YYYY-MM-DD) using string ops only.
  Build sortable keys as YYYYMMDD (strings). Primary sort = end, secondary = start.
  {%- endcomment -%}
  {% assign pairs = "" | split: "" %}
  {% for vol in data[1] %}
    {%- assign raw_start = vol.startDate | default: "" | append: "" -%}
    {%- assign raw_end   = vol.endDate   | default: "" | append: "" -%}

    {%- if raw_start == "" -%}
      {%- assign start_iso = "1900-01-01" -%}
    {%- elsif raw_start.size == 4 -%}
      {%- assign start_iso = raw_start | append: "-01-01" -%}
    {%- elsif raw_start.size == 7 -%}
      {%- assign start_iso = raw_start | append: "-01" -%}
    {%- else -%}
      {%- assign start_iso = raw_start -%}
    {%- endif -%}

    {%- if raw_end == "" -%}
      {%- assign end_iso = "2100-12-31" -%}
    {%- elsif raw_end.size == 4 -%}
      {%- assign end_iso = raw_end | append: "-12-31" -%}
    {%- elsif raw_end.size == 7 -%}
      {%- assign end_iso = raw_end | append: "-28" -%}
    {%- else -%}
      {%- assign end_iso = raw_end -%}
    {%- endif -%}

    {%- assign start_key = start_iso | remove: "-" | slice: 0, 8 -%}
    {%- assign end_key   = end_iso   | remove: "-" | slice: 0, 8 -%}

    {% capture pair %}{{ end_key }}-{{ start_key }}::{{ forloop.index0 }}{% endcapture %}
    {% assign pairs = pairs | push: pair %}
  {% endfor %}

  {% assign pairs = pairs | sort | reverse %}

  {% for pair in pairs %}
    {% assign idx = pair | split: '::' | last | plus: 0 %}
    {% assign content = data[1][idx] %}

    <li class="list-group-item">
      <div class="row">
        <div class="col-xs-2 cl-sm-2 col-md-2 text-center date-column">
          {%- assign s_raw = content.startDate | default: "" | append: "" -%}
          {%- assign e_raw = content.endDate   | default: "" | append: "" -%}

          {%- if s_raw != "" -%}
            {%- if s_raw.size == 4 -%}
              {%- assign start_label = s_raw -%}
            {%- elsif s_raw.size == 7 -%}
              {%- assign start_label = s_raw | replace: "-", "." -%}
            {%- else -%}
              {%- assign start_label = s_raw | slice: 0, 7 | replace: "-", "." -%}
            {%- endif -%}

            {%- if e_raw == "" -%}
              {%- assign end_label = "Present" -%}
            {%- elsif e_raw.size == 4 -%}
              {%- assign end_label = e_raw -%}
            {%- elsif e_raw.size == 7 -%}
              {%- assign end_label = e_raw | replace: "-", "." -%}
            {%- else -%}
              {%- assign end_label = e_raw | slice: 0, 7 | replace: "-", "." -%}
            {%- endif -%}

            {%- assign date = start_label | append: " - " | append: end_label -%}
          {%- else -%}
            {%- assign date = "" -%}
          {%- endif -%}

          <table class="table-cv">
            <tbody>
              <tr>
                <td>
                  {% if date != "" %}
                    <span class="badge font-weight-bold danger-color-dark text-uppercase align-middle" style="min-width: 75px">{{ date }}</span>
                  {% endif %}
                </td>
              </tr>
              {% if content.location %}
                <tr>
                  <td>
                    <p class="location">
                      <i class="fa-solid fa-location-dot iconlocation"></i>
                      {{ content.location }}
                    </p>
                  </td>
                </tr>
              {% endif %}
            </tbody>
          </table>
        </div>

        <div class="col-xs-10 cl-sm-10 col-md-10 mt-2 mt-md-0">
          <h6 class="title font-weight-bold ml-1 ml-md-4">
            <a href="{{ content.url }}">{{ content.position }}</a>
          </h6>
          <h6 class="ml-1 ml-md-4" style="font-size: 0.95rem">{{ content.organization }}</h6>
          <h6 class="ml-1 ml-md-4" style="font-size: 0.95rem; font-style: italic">{{ content.summary }}</h6>
          <ul class="items">
            {% for item in content.highlights %}
              <li><span class="item">{{ item }}</span></li>
            {% endfor %}
          </ul>
        </div>
      </div>
    </li>
  {% endfor %}
</ul>