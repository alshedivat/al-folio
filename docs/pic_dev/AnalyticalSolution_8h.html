<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PICurv: AnalyticalSolution.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PICurv<span id="projectnumber">&#160;0.1.0</span>
   </div>
   <div id="projectbrief">A Parallel Particle-In-Cell Solver for Curvilinear LES</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('AnalyticalSolution_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">AnalyticalSolution.h File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;petscpf.h&gt;</code><br />
<code>#include &lt;petscdmswarm.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;petsctime.h&gt;</code><br />
<code>#include &lt;petscdmcomposite.h&gt;</code><br />
<code>#include &quot;<a class="el" href="variables_8h_source.html">variables.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ParticleSwarm_8h_source.html">ParticleSwarm.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="walkingsearch_8h_source.html">walkingsearch.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="grid_8h_source.html">grid.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="logging_8h_source.html">logging.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="io_8h_source.html">io.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="setup_8h_source.html">setup.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="interpolation_8h_source.html">interpolation.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for AnalyticalSolution.h:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="AnalyticalSolution_8h__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="AnalyticalSolution_8h__dep__incl.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
</div>
</div>
<p><a href="AnalyticalSolution_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a208f989b8e9d4dcdfbe727212ade0e03" id="r_a208f989b8e9d4dcdfbe727212ade0e03"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="AnalyticalSolution_8h.html#a208f989b8e9d4dcdfbe727212ade0e03">SetLocalCartesianField</a>(fieldName,  fieldValue,  coor,  FieldInitialization,  Constant)</td></tr>
<tr class="memdesc:a208f989b8e9d4dcdfbe727212ade0e03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic macro to select the appropriate local Cartesian field setter based on field type.  <br /></td></tr>
<tr class="separator:a208f989b8e9d4dcdfbe727212ade0e03"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad358f49191579d343dee83d4f58c1ceb" id="r_ad358f49191579d343dee83d4f58c1ceb"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="AnalyticalSolution_8h.html#ad358f49191579d343dee83d4f58c1ceb">SetLocalCartesianField_Scalar</a> (const char *fieldName, PetscReal *scalarField, <a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a> *coor, PetscInt FieldInitialization, PetscReal Constant)</td></tr>
<tr class="memdesc:ad358f49191579d343dee83d4f58c1ceb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the local Cartesian scalar field based on input coordinates.  <br /></td></tr>
<tr class="separator:ad358f49191579d343dee83d4f58c1ceb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe02409e02e745056dc01e825fbb855a" id="r_afe02409e02e745056dc01e825fbb855a"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="AnalyticalSolution_8h.html#afe02409e02e745056dc01e825fbb855a">SetLocalCartesianField_Vector</a> (const char *fieldName, <a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a> *vecField, <a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a> *coor, PetscInt FieldInitialization, PetscReal Constant)</td></tr>
<tr class="memdesc:afe02409e02e745056dc01e825fbb855a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the local Cartesian vector field based on input coordinates.  <br /></td></tr>
<tr class="separator:afe02409e02e745056dc01e825fbb855a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f6d9a5e07dcc5277229bf27b261912a" id="r_a0f6d9a5e07dcc5277229bf27b261912a"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="AnalyticalSolution_8h.html#a0f6d9a5e07dcc5277229bf27b261912a">SetAnalyticalCartesianField</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, const char *fieldName)</td></tr>
<tr class="memdesc:a0f6d9a5e07dcc5277229bf27b261912a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets an analytical Cartesian field (scalar or vector) for cell centers based on a field name.  <br /></td></tr>
<tr class="separator:a0f6d9a5e07dcc5277229bf27b261912a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29a5f5265bd8b87a0d20bfe713a9e8d6" id="r_a29a5f5265bd8b87a0d20bfe713a9e8d6"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="AnalyticalSolution_8h.html#a29a5f5265bd8b87a0d20bfe713a9e8d6">SetAnalyticalContravariantField</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, const char *fieldName)</td></tr>
<tr class="memdesc:a29a5f5265bd8b87a0d20bfe713a9e8d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets an analytical contravariant field (Ucont) at nodes, where each component is evaluated using the physical coordinates of its respective face center.  <br /></td></tr>
<tr class="separator:a29a5f5265bd8b87a0d20bfe713a9e8d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab57f534174916f5cb70cf35a296edaa1" id="r_ab57f534174916f5cb70cf35a296edaa1"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="AnalyticalSolution_8h.html#ab57f534174916f5cb70cf35a296edaa1">SetAnalyticalSolution</a> (Vec tempVec, PetscInt FieldInitialization)</td></tr>
<tr class="memdesc:ab57f534174916f5cb70cf35a296edaa1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies the analytical solution to the position vector.  <br /></td></tr>
<tr class="separator:ab57f534174916f5cb70cf35a296edaa1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbdea0181878c415ae991a9fb2a2b823" id="r_adbdea0181878c415ae991a9fb2a2b823"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="AnalyticalSolution_8h.html#adbdea0181878c415ae991a9fb2a2b823">ApplyAnalyticalBC</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, const char *fieldName)</td></tr>
<tr class="memdesc:adbdea0181878c415ae991a9fb2a2b823"><td class="mdescLeft">&#160;</td><td class="mdescRight">Applies analytical boundary conditions to a specified global vector or scalar field.  <br /></td></tr>
<tr class="separator:adbdea0181878c415ae991a9fb2a2b823"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62dfa993750dc34d1729c575bb1dde66" id="r_a62dfa993750dc34d1729c575bb1dde66"><td class="memItemLeft" align="right" valign="top">PetscErrorCode&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="AnalyticalSolution_8h.html#a62dfa993750dc34d1729c575bb1dde66">SetInitialInteriorField</a> (<a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *user, const char *fieldName)</td></tr>
<tr class="memdesc:a62dfa993750dc34d1729c575bb1dde66"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the initial values for the INTERIOR of a specified Eulerian field.  <br /></td></tr>
<tr class="separator:a62dfa993750dc34d1729c575bb1dde66"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a208f989b8e9d4dcdfbe727212ade0e03" name="a208f989b8e9d4dcdfbe727212ade0e03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a208f989b8e9d4dcdfbe727212ade0e03">&#9670;&#160;</a></span>SetLocalCartesianField</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SetLocalCartesianField</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">fieldName, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">fieldValue, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">coor, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">FieldInitialization, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">Constant&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">    _Generic((fieldValue), \</div>
<div class="line">    <a class="code hl_struct" href="variables__old_8h.html#structCmpnts">Cmpnts</a>*:    <a class="code hl_function" href="AnalyticalSolution_8h.html#afe02409e02e745056dc01e825fbb855a">SetLocalCartesianField_Vector</a>, \</div>
<div class="line">    PetscReal*: <a class="code hl_function" href="AnalyticalSolution_8h.html#ad358f49191579d343dee83d4f58c1ceb">SetLocalCartesianField_Scalar</a> \</div>
<div class="line">    )(fieldName, fieldValue, coor,FieldInitialization,Constant)</div>
<div class="ttc" id="aAnalyticalSolution_8h_html_ad358f49191579d343dee83d4f58c1ceb"><div class="ttname"><a href="AnalyticalSolution_8h.html#ad358f49191579d343dee83d4f58c1ceb">SetLocalCartesianField_Scalar</a></div><div class="ttdeci">PetscErrorCode SetLocalCartesianField_Scalar(const char *fieldName, PetscReal *scalarField, Cmpnts *coor, PetscInt FieldInitialization, PetscReal Constant)</div><div class="ttdoc">Sets the local Cartesian scalar field based on input coordinates.</div></div>
<div class="ttc" id="aAnalyticalSolution_8h_html_afe02409e02e745056dc01e825fbb855a"><div class="ttname"><a href="AnalyticalSolution_8h.html#afe02409e02e745056dc01e825fbb855a">SetLocalCartesianField_Vector</a></div><div class="ttdeci">PetscErrorCode SetLocalCartesianField_Vector(const char *fieldName, Cmpnts *vecField, Cmpnts *coor, PetscInt FieldInitialization, PetscReal Constant)</div><div class="ttdoc">Sets the local Cartesian vector field based on input coordinates.</div></div>
<div class="ttc" id="avariables__old_8h_html_structCmpnts"><div class="ttname"><a href="variables__old_8h.html#structCmpnts">Cmpnts</a></div><div class="ttdoc">A 3D point or vector with PetscScalar components.</div><div class="ttdef"><b>Definition</b> <a href="variables_8h_source.html#l00100">variables.h:100</a></div></div>
</div><!-- fragment -->
<p>Generic macro to select the appropriate local Cartesian field setter based on field type. </p>
<p>This macro dispatches to:</p><ul>
<li>SetLocalCartesianField_Vector if the field value pointer is of type Cmpnts*</li>
<li>SetLocalCartesianField_Scalar if the field value pointer is of type PetscReal*</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fieldName</td><td>Field name for logging. </td></tr>
    <tr><td class="paramname">fieldValue</td><td>Pointer to the cell's field value (either Cmpnts* or PetscReal*). </td></tr>
    <tr><td class="paramname">coor</td><td>Pointer to the coordinate (Cmpnts*) to be used in the computation. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="AnalyticalSolution_8h_source.html#l00033">33</a> of file <a class="el" href="AnalyticalSolution_8h_source.html">AnalyticalSolution.h</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   34</span>           :    <a class="code hl_function" href="AnalyticalSolution_8h.html#afe02409e02e745056dc01e825fbb855a">SetLocalCartesianField_Vector</a>, \</div>
<div class="line"><span class="lineno">   35</span>    PetscReal*: <a class="code hl_function" href="AnalyticalSolution_8h.html#ad358f49191579d343dee83d4f58c1ceb">SetLocalCartesianField_Scalar</a> \</div>
<div class="line"><span class="lineno">   36</span>    )(fieldName, fieldValue, coor,FieldInitialization,Constant)</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="adbdea0181878c415ae991a9fb2a2b823" name="adbdea0181878c415ae991a9fb2a2b823"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbdea0181878c415ae991a9fb2a2b823">&#9670;&#160;</a></span>ApplyAnalyticalBC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode ApplyAnalyticalBC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fieldName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies analytical boundary conditions to a specified global vector or scalar field. </p>
<p>This function acts as a dispatcher based on the fieldName. It determines the appropriate DM and Vec from the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> and calls field-specific helper routines (e.g., ApplyAnalyticalBC_Vector, ApplyAnalyticalBC_Scalar) to set boundary values according to a predefined analytical function (e.g., sin(coord)).</p>
<p>This should be called AFTER setting interior values and BEFORE updating local ghosts.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> containing DMs, coordinates, and field Vecs. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fieldName</td><td>Name of the field to apply BCs to ("Ucat", "Ucont", "P", "Nvert").</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode 0 on success, non-zero on failure. </dd></dl>

</div>
</div>
<a id="a0f6d9a5e07dcc5277229bf27b261912a" name="a0f6d9a5e07dcc5277229bf27b261912a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f6d9a5e07dcc5277229bf27b261912a">&#9670;&#160;</a></span>SetAnalyticalCartesianField()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode SetAnalyticalCartesianField </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fieldName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets an analytical Cartesian field (scalar or vector) for cell centers based on a field name. </p>
<p>This function looks up the field within the user context by comparing the provided field name against the supported names:</p><ul>
<li>Vector fields: "Ucat" and "Ucont"</li>
<li>Scalar fields: "P" and "nvert"</li>
</ul>
<p>If the field is found, the function verifies that the DM block size matches the expected value (3 for vector fields and 1 for scalar fields), retrieves local DM information for both the coordinate DM (da) and the cell-centered DM (fda), interpolates the corner-based coordinates (from da) to cell centers, and then updates the field using the generic helper macro SetLocalCartesianField. Interior cells are updated with the interpolated coordinates, and boundary cells are updated using the original coordinate data.</p>
<p>If the field name is not found in the user context, the function throws an error.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure containing:<ul>
<li>da: DM for coordinate (corner) data.</li>
<li>fda: DM for cell-centered data.</li>
<li>Ucat: vector field (<a class="el" href="variables__old_8h.html#structCmpnts" title="A 3D point or vector with PetscScalar components.">Cmpnts</a> ***)</li>
<li>Ucont: vector field (<a class="el" href="variables__old_8h.html#structCmpnts" title="A 3D point or vector with PetscScalar components.">Cmpnts</a> ***)</li>
<li>P: scalar field (PetscReal ***)</li>
<li>nvert: scalar field (PetscReal ***) </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fieldName</td><td>Name of the field to update.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode 0 on success, non-zero on failure. </dd></dl>

</div>
</div>
<a id="a29a5f5265bd8b87a0d20bfe713a9e8d6" name="a29a5f5265bd8b87a0d20bfe713a9e8d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29a5f5265bd8b87a0d20bfe713a9e8d6">&#9670;&#160;</a></span>SetAnalyticalContravariantField()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode SetAnalyticalContravariantField </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fieldName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets an analytical contravariant field (Ucont) at nodes, where each component is evaluated using the physical coordinates of its respective face center. </p>
<p>This function:</p><ol type="1">
<li>Interpolates nodal physical coordinates to the centers of i-faces, j-faces, and k-faces for the cells relevant to the current rank, storing them in temporary local arrays.</li>
<li>For each node (i,j,k) owned by the current rank (where Ucont components are stored): a. Retrieves the pre-calculated physical coordinate of the i-face center. b. Evaluates the analytical function for U^1 using this i-face center coordinate. c. Retrieves the pre-calculated physical coordinate of the j-face center. d. Evaluates the analytical function for U^2 using this j-face center coordinate. e. Retrieves the pre-calculated physical coordinate of the k-face center. f. Evaluates the analytical function for U^3 using this k-face center coordinate. g. Stores these (U^1, U^2, U^3) into user-&gt;Ucont[k][j][i].</li>
</ol>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">user</td><td>Pointer to the <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> structure. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fieldName</td><td>Name of the field to update (currently only "Ucont").</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode 0 on success, non-zero on failure. </dd></dl>

</div>
</div>
<a id="ab57f534174916f5cb70cf35a296edaa1" name="ab57f534174916f5cb70cf35a296edaa1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab57f534174916f5cb70cf35a296edaa1">&#9670;&#160;</a></span>SetAnalyticalSolution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode SetAnalyticalSolution </td>
          <td>(</td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>tempVec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>FieldInitialization</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Applies the analytical solution to the position vector. </p>
<p>This function updates each entry in the provided PETSc vector by computing its sine, thereby replacing each position with sin(position).</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tempVec</td><td>The PETSc Vec containing particle positions which will be used to store the velocities. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on success. </dd></dl>

</div>
</div>
<a id="a62dfa993750dc34d1729c575bb1dde66" name="a62dfa993750dc34d1729c575bb1dde66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62dfa993750dc34d1729c575bb1dde66">&#9670;&#160;</a></span>SetInitialInteriorField()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode SetInitialInteriorField </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structUserCtx">UserCtx</a> *&#160;</td>
          <td class="paramname"><em>user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fieldName</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the initial values for the INTERIOR of a specified Eulerian field. </p>
<p>This function initializes the interior nodes of <code>Ucont</code> based on a profile selected by <code>user-&gt;FieldInitialization</code>. It explicitly skips any node that lies on a global boundary, as those values are set by the Boundary System's <code>Initialize</code> methods.</p>
<p>The initialization is directional, aligned with the primary INLET face that was identified by the parser. This ensures the initial flow is physically meaningful.</p>
<p>Supported <code>user-&gt;FieldInitialization</code> profiles for "Ucont":</p><ul>
<li>0: Zero Velocity. All interior components of Ucont are set to 0.</li>
<li>1: Constant Normal Velocity. The contravariant velocity component normal to the inlet direction is set such that the physical velocity normal to those grid planes is a constant <code>uin</code>. Other contravariant components are zero.</li>
<li>2: Poiseuille Normal Velocity. The contravariant component normal to the inlet direction is set with a parabolic profile.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">user</td><td>The main <a class="el" href="variables__old_8h.html#structUserCtx" title="User-defined context containing data specific to a single computational grid level.">UserCtx</a> struct, containing all simulation data and configuration. </td></tr>
    <tr><td class="paramname">fieldName</td><td>A string ("Ucont" or "P") identifying which field to initialize. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode 0 on success. </dd></dl>

<p class="definition">Definition at line <a class="el" href="initialcondition_8c_source.html#l00030">30</a> of file <a class="el" href="initialcondition_8c_source.html">initialcondition.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   31</span>{</div>
<div class="line"><span class="lineno">   32</span>    PetscErrorCode ierr;</div>
<div class="line"><span class="lineno">   33</span>    PetscFunctionBeginUser;</div>
<div class="line"><span class="lineno">   34</span> </div>
<div class="line"><span class="lineno">   35</span>    <a class="code hl_struct" href="variables_8h.html#structSimCtx">SimCtx</a> *simCtx = user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">simCtx</a>;</div>
<div class="line"><span class="lineno">   36</span>    </div>
<div class="line"><span class="lineno">   37</span>    <a class="code hl_define" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code hl_define" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code hl_enumvalue" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a>, <span class="stringliteral">&quot;Setting initial INTERIOR field for &#39;%s&#39; with profile %d.\n&quot;</span>, fieldName, simCtx-&gt;<a class="code hl_variable" href="variables_8h.html#a483945572b5ab1461a864ee1e3eb1d37">FieldInitialization</a>);</div>
<div class="line"><span class="lineno">   38</span> </div>
<div class="line"><span class="lineno">   39</span>    <span class="comment">// This function currently only implements logic for Ucont.</span></div>
<div class="line"><span class="lineno">   40</span>    <span class="keywordflow">if</span> (strcmp(fieldName, <span class="stringliteral">&quot;Ucont&quot;</span>) != 0) {</div>
<div class="line"><span class="lineno">   41</span>        <a class="code hl_define" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code hl_define" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>, <a class="code hl_enumvalue" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Skipping SetInitialInteriorField for non-Ucont field &#39;%s&#39;.\n&quot;</span>, fieldName);</div>
<div class="line"><span class="lineno">   42</span>        PetscFunctionReturn(0);</div>
<div class="line"><span class="lineno">   43</span>    }</div>
<div class="line"><span class="lineno">   44</span> </div>
<div class="line"><span class="lineno">   45</span>    <span class="comment">// --- 1. Get references to required data and PETSc arrays ---</span></div>
<div class="line"><span class="lineno">   46</span>    DM            fieldDM = user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>;</div>
<div class="line"><span class="lineno">   47</span>    Vec           fieldVec = user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a69c3a361d1aac3bdc14f971bda57e032">Ucont</a>;</div>
<div class="line"><span class="lineno">   48</span>    DMDALocalInfo info;</div>
<div class="line"><span class="lineno">   49</span>    ierr = DMDAGetLocalInfo(fieldDM, &amp;info); CHKERRQ(ierr);</div>
<div class="line"><span class="lineno">   50</span> </div>
<div class="line"><span class="lineno">   51</span>    Vec      localCoor;</div>
<div class="line"><span class="lineno">   52</span>    <a class="code hl_struct" href="variables__old_8h.html#structCmpnts">Cmpnts</a> ***coor_arr;</div>
<div class="line"><span class="lineno">   53</span>    ierr = DMGetCoordinatesLocal(user-&gt;<a class="code hl_variable" href="variables__old_8h.html#af031acb43b014d5ac788aa9003491e75">da</a>, &amp;localCoor); CHKERRQ(ierr);</div>
<div class="line"><span class="lineno">   54</span>    ierr = DMDAVecGetArrayRead(user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, localCoor, &amp;coor_arr); CHKERRQ(ierr);</div>
<div class="line"><span class="lineno">   55</span>    </div>
<div class="line"><span class="lineno">   56</span>    <a class="code hl_struct" href="variables__old_8h.html#structCmpnts">Cmpnts</a> ***csi_arr, ***eta_arr, ***zet_arr;</div>
<div class="line"><span class="lineno">   57</span>    ierr = DMDAVecGetArrayRead(user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a9693ebf5c9ea601d5ebaf6d24cc60721">lCsi</a>, &amp;csi_arr); CHKERRQ(ierr);</div>
<div class="line"><span class="lineno">   58</span>    ierr = DMDAVecGetArrayRead(user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, user-&gt;<a class="code hl_variable" href="variables__old_8h.html#ad4296b10d8eb7b065165582f5cc85897">lEta</a>, &amp;eta_arr); CHKERRQ(ierr);</div>
<div class="line"><span class="lineno">   59</span>    ierr = DMDAVecGetArrayRead(user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a414751d7a391a78834cdce87b52a066f">lZet</a>, &amp;zet_arr); CHKERRQ(ierr);</div>
<div class="line"><span class="lineno">   60</span>   </div>
<div class="line"><span class="lineno">   61</span>    <span class="comment">// --- 2. Compute Cell-Center Coordinates (only if needed by the selected profile) ---</span></div>
<div class="line"><span class="lineno">   62</span>    <a class="code hl_struct" href="variables__old_8h.html#structCmpnts">Cmpnts</a> ***cent_coor = NULL;</div>
<div class="line"><span class="lineno">   63</span>    PetscInt xs_cell=0, xm_cell=0, ys_cell=0, ym_cell=0, zs_cell=0, zm_cell=0;</div>
<div class="line"><span class="lineno">   64</span>    </div>
<div class="line"><span class="lineno">   65</span>    <span class="keywordflow">if</span> (simCtx-&gt;<a class="code hl_variable" href="variables_8h.html#a483945572b5ab1461a864ee1e3eb1d37">FieldInitialization</a> == 2) { <span class="comment">// Profile 2 (Poiseuille) requires cell centers.</span></div>
<div class="line"><span class="lineno">   66</span>      <span class="comment">/*</span></div>
<div class="line"><span class="lineno">   67</span><span class="comment">        ierr = GetOwnedCellRange(&amp;info, 0, &amp;xs_cell, &amp;xm_cell); CHKERRQ(ierr);</span></div>
<div class="line"><span class="lineno">   68</span><span class="comment">        ierr = GetOwnedCellRange(&amp;info, 1, &amp;ys_cell, &amp;ym_cell); CHKERRQ(ierr);</span></div>
<div class="line"><span class="lineno">   69</span><span class="comment">        ierr = GetOwnedCellRange(&amp;info, 2, &amp;zs_cell, &amp;zm_cell); CHKERRQ(ierr);</span></div>
<div class="line"><span class="lineno">   70</span><span class="comment">      */</span></div>
<div class="line"><span class="lineno">   71</span>      ierr = <a class="code hl_function" href="setup_8h.html#a25ce912d8aafa319a8c915cd350c7322">GetGhostedCellRange</a>(&amp;info,&amp;user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a58c51750e5a9172516dd2af41fd5fd42">neighbors</a>,0, &amp;xs_cell, &amp;xm_cell); CHKERRQ(ierr);</div>
<div class="line"><span class="lineno">   72</span>      ierr = <a class="code hl_function" href="setup_8h.html#a25ce912d8aafa319a8c915cd350c7322">GetGhostedCellRange</a>(&amp;info,&amp;user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a58c51750e5a9172516dd2af41fd5fd42">neighbors</a>,1, &amp;ys_cell, &amp;ym_cell); CHKERRQ(ierr);</div>
<div class="line"><span class="lineno">   73</span>      ierr = <a class="code hl_function" href="setup_8h.html#a25ce912d8aafa319a8c915cd350c7322">GetGhostedCellRange</a>(&amp;info,&amp;user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a58c51750e5a9172516dd2af41fd5fd42">neighbors</a>,2, &amp;zs_cell, &amp;zm_cell); CHKERRQ(ierr);</div>
<div class="line"><span class="lineno">   74</span>      </div>
<div class="line"><span class="lineno">   75</span>        <span class="keywordflow">if</span> (xm_cell &gt; 0 &amp;&amp; ym_cell &gt; 0 &amp;&amp; zm_cell &gt; 0) {</div>
<div class="line"><span class="lineno">   76</span>            ierr = <a class="code hl_define" href="setup_8h.html#a0e1e86f6c7ecdee0c26e62b2458ab455">Allocate3DArray</a>(&amp;cent_coor, zm_cell, ym_cell, xm_cell); CHKERRQ(ierr);</div>
<div class="line"><span class="lineno">   77</span>            ierr = <a class="code hl_define" href="interpolation_8h.html#ab10820f766502b3dc7acaca2e61c5628">InterpolateFieldFromCornerToCenter</a>(coor_arr, cent_coor, user); CHKERRQ(ierr);</div>
<div class="line"><span class="lineno">   78</span>            <a class="code hl_define" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code hl_define" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code hl_enumvalue" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>, <span class="stringliteral">&quot;Computed temporary cell-center coordinates for Poiseuille profile.\n&quot;</span>);</div>
<div class="line"><span class="lineno">   79</span>        }</div>
<div class="line"><span class="lineno">   80</span>    }</div>
<div class="line"><span class="lineno">   81</span>    </div>
<div class="line"><span class="lineno">   82</span>    <span class="comment">// --- 3. Loop Over Owned Nodes and Apply Initial Condition to Interior ---</span></div>
<div class="line"><span class="lineno">   83</span>    <a class="code hl_struct" href="variables__old_8h.html#structCmpnts">Cmpnts</a> ***ucont_arr;</div>
<div class="line"><span class="lineno">   84</span>    ierr = DMDAVecGetArray(fieldDM, fieldVec, &amp;ucont_arr); CHKERRQ(ierr);</div>
<div class="line"><span class="lineno">   85</span>    </div>
<div class="line"><span class="lineno">   86</span>    PetscInt i, j, k;</div>
<div class="line"><span class="lineno">   87</span>    <span class="keyword">const</span> PetscInt mx = info.mx, my = info.my, mz = info.mz; <span class="comment">// Global node dimensions</span></div>
<div class="line"><span class="lineno">   88</span>    <span class="keyword">const</span> PetscInt xs = info.xs, xe = info.xs + info.xm;</div>
<div class="line"><span class="lineno">   89</span>    <span class="keyword">const</span> PetscInt ys = info.ys, ye = info.ys + info.ym;</div>
<div class="line"><span class="lineno">   90</span>    <span class="keyword">const</span> PetscInt zs = info.zs, ze = info.zs + info.zm;</div>
<div class="line"><span class="lineno">   91</span>    </div>
<div class="line"><span class="lineno">   92</span>    <span class="keyword">const</span> <a class="code hl_struct" href="variables__old_8h.html#structCmpnts">Cmpnts</a> uin = simCtx-&gt;<a class="code hl_variable" href="variables_8h.html#ac503944447b87fc650e0ffa74a780b36">InitialConstantContra</a>; <span class="comment">// Max/average velocity from user options</span></div>
<div class="line"><span class="lineno">   93</span>    <span class="comment">// Flow into a negative face (e.g., -Zeta at k=0) is in the positive physical direction (+z).</span></div>
<div class="line"><span class="lineno">   94</span>    <span class="comment">// Flow into a positive face (e.g., +Zeta at k=mz-1) is in the negative physical direction (-z).</span></div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span>    <a class="code hl_define" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code hl_define" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code hl_enumvalue" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,<span class="stringliteral">&quot;InitialConstantContra = (%.3f, %.3f, %.3f)\n&quot;</span>,(<span class="keywordtype">double</span>)uin.<a class="code hl_variable" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>, (<span class="keywordtype">double</span>)uin.<a class="code hl_variable" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>, (<span class="keywordtype">double</span>)uin.<a class="code hl_variable" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>);</div>
<div class="line"><span class="lineno">   97</span>    </div>
<div class="line"><span class="lineno">   98</span>    <span class="keyword">const</span> PetscReal flow_direction_sign = (user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a27bce072860da2f1a8a54d94b2b9497f">identifiedInletBCFace</a> % 2 == 0) ? 1.0 : -1.0;</div>
<div class="line"><span class="lineno">   99</span>        </div>
<div class="line"><span class="lineno">  100</span>    <span class="keywordflow">for</span> (k = zs; k &lt; ze; k++) {</div>
<div class="line"><span class="lineno">  101</span>        <span class="keywordflow">for</span> (j = ys; j &lt; ye; j++) {</div>
<div class="line"><span class="lineno">  102</span>            <span class="keywordflow">for</span> (i = xs; i &lt; xe; i++) {</div>
<div class="line"><span class="lineno">  103</span>                </div>
<div class="line"><span class="lineno">  104</span>                <span class="comment">// The crucial check to ensure we only modify interior nodes.</span></div>
<div class="line"><span class="lineno">  105</span>                <span class="keyword">const</span> PetscBool is_interior = (i &gt; 0 &amp;&amp; i &lt; mx - 1 &amp;&amp;</div>
<div class="line"><span class="lineno">  106</span>                                               j &gt; 0 &amp;&amp; j &lt; my - 1 &amp;&amp;</div>
<div class="line"><span class="lineno">  107</span>                                               k &gt; 0 &amp;&amp; k &lt; mz - 1);</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>                <span class="keywordflow">if</span> (is_interior) {</div>
<div class="line"><span class="lineno">  110</span>                    <a class="code hl_struct" href="variables__old_8h.html#structCmpnts">Cmpnts</a> ucont_val = {0.0, 0.0, 0.0}; <span class="comment">// Default to zero velocity</span></div>
<div class="line"><span class="lineno">  111</span>                    PetscReal normal_velocity_mag = 0.0;</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>                    <span class="comment">// Step A: Determine the magnitude of the desired physical normal velocity.</span></div>
<div class="line"><span class="lineno">  114</span>                    <span class="keywordflow">switch</span> (simCtx-&gt;<a class="code hl_variable" href="variables_8h.html#a483945572b5ab1461a864ee1e3eb1d37">FieldInitialization</a>) {</div>
<div class="line"><span class="lineno">  115</span>                        <span class="keywordflow">case</span> 0: <span class="comment">// Zero initial velocity</span></div>
<div class="line"><span class="lineno">  116</span>                            normal_velocity_mag = 0.0;</div>
<div class="line"><span class="lineno">  117</span>                            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  118</span>                <span class="keywordflow">case</span> 1: <span class="comment">/* Constant Normal Velocity */</span></div>
<div class="line"><span class="lineno">  119</span>                    <span class="keywordflow">if</span> (user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a27bce072860da2f1a8a54d94b2b9497f">identifiedInletBCFace</a> == <a class="code hl_enumvalue" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafa19d65b9e7835046cd7e2ca88cc7cb611">BC_FACE_NEG_X</a> ||</div>
<div class="line"><span class="lineno">  120</span>                user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a27bce072860da2f1a8a54d94b2b9497f">identifiedInletBCFace</a> == <a class="code hl_enumvalue" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafabbe50296e7a96e9818fa4d11bcc4443c">BC_FACE_POS_X</a>) {</div>
<div class="line"><span class="lineno">  121</span>                normal_velocity_mag = uin.<a class="code hl_variable" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><span class="lineno">  122</span>                    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a27bce072860da2f1a8a54d94b2b9497f">identifiedInletBCFace</a> == <a class="code hl_enumvalue" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafad74ee1b3767f0c8d5251abe91549c99a">BC_FACE_NEG_Y</a> || user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a27bce072860da2f1a8a54d94b2b9497f">identifiedInletBCFace</a> == <a class="code hl_enumvalue" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafa9c068efc5178fd37591bbcdf5e86b3fb">BC_FACE_POS_Y</a>) {</div>
<div class="line"><span class="lineno">  123</span>               normal_velocity_mag = uin.<a class="code hl_variable" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><span class="lineno">  124</span>                    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  125</span>               normal_velocity_mag = uin.<a class="code hl_variable" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>;</div>
<div class="line"><span class="lineno">  126</span>                    }</div>
<div class="line"><span class="lineno">  127</span>              <span class="keywordflow">break</span>; </div>
<div class="line"><span class="lineno">  128</span>                        <span class="keywordflow">case</span> 2: <span class="comment">// Poiseuille Normal Velocity</span></div>
<div class="line"><span class="lineno">  129</span>                            {</div>
<div class="line"><span class="lineno">  130</span>                                                  <span class="comment">// This profile assumes flow is aligned with the k-index direction.</span></div>
<div class="line"><span class="lineno">  131</span>                                <span class="comment">// It uses grid indices (i,j) to define the cross-section, which works for bent geometries.</span></div>
<div class="line"><span class="lineno">  132</span>                                PetscReal u0 = 0.0;</div>
<div class="line"><span class="lineno">  133</span>                                <span class="keywordflow">if</span> (user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a27bce072860da2f1a8a54d94b2b9497f">identifiedInletBCFace</a> &lt;= <a class="code hl_enumvalue" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafabbe50296e7a96e9818fa4d11bcc4443c">BC_FACE_POS_X</a>) u0 = uin.<a class="code hl_variable" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>;</div>
<div class="line"><span class="lineno">  134</span>                                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a27bce072860da2f1a8a54d94b2b9497f">identifiedInletBCFace</a> &lt;= <a class="code hl_enumvalue" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafa9c068efc5178fd37591bbcdf5e86b3fb">BC_FACE_POS_Y</a>) u0 = uin.<a class="code hl_variable" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>;</div>
<div class="line"><span class="lineno">  135</span>                                <span class="keywordflow">else</span> u0 = uin.<a class="code hl_variable" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>; <span class="comment">// Assumes Z-like inlet direction</span></div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>                                <span class="comment">// Define channel geometry in &quot;index space&quot; based on global grid dimensions</span></div>
<div class="line"><span class="lineno">  138</span>                                <span class="comment">// We subtract 2.0 because the interior runs from index 1 to mx-2 (or my-2).</span></div>
<div class="line"><span class="lineno">  139</span>                                <span class="keyword">const</span> PetscReal i_width  = (PetscReal)(mx - 2);</div>
<div class="line"><span class="lineno">  140</span>                                <span class="keyword">const</span> PetscReal j_width  = (PetscReal)(my - 2);</div>
<div class="line"><span class="lineno">  141</span>                                <span class="keyword">const</span> PetscReal i_center = 1.0 + i_width / 2.0;</div>
<div class="line"><span class="lineno">  142</span>                                <span class="keyword">const</span> PetscReal j_center = 1.0 + j_width / 2.0;</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>                                <span class="comment">// Create normalized coordinates for the current point (i,j), ranging from -1 to 1</span></div>
<div class="line"><span class="lineno">  145</span>                                <span class="keyword">const</span> PetscReal i_norm = (i - i_center) / (i_width / 2.0);</div>
<div class="line"><span class="lineno">  146</span>                                <span class="keyword">const</span> PetscReal j_norm = (j - j_center) / (j_width / 2.0);</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span>                                <span class="comment">// Apply the parabolic profile for a rectangular/square channel</span></div>
<div class="line"><span class="lineno">  149</span>                                <span class="comment">// V(i,j) = V_max * (1 - i_norm^2) * (1 - j_norm^2)</span></div>
<div class="line"><span class="lineno">  150</span>                                <span class="keyword">const</span> PetscReal profile_i = 1.0 - i_norm * i_norm;</div>
<div class="line"><span class="lineno">  151</span>                                <span class="keyword">const</span> PetscReal profile_j = 1.0 - j_norm * j_norm;</div>
<div class="line"><span class="lineno">  152</span>                                normal_velocity_mag = u0 * profile_i * profile_j;</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span>                                <span class="comment">// Clamp to zero for any points outside the channel (or due to minor float errors)</span></div>
<div class="line"><span class="lineno">  155</span>                                <span class="keywordflow">if</span> (normal_velocity_mag &lt; 0.0) {</div>
<div class="line"><span class="lineno">  156</span>                                    normal_velocity_mag = 0.0;</div>
<div class="line"><span class="lineno">  157</span>                                }</div>
<div class="line"><span class="lineno">  158</span>                            }</div>
<div class="line"><span class="lineno">  159</span>                            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  160</span>                <span class="comment">/*</span></div>
<div class="line"><span class="lineno">  161</span><span class="comment">                                PetscReal r_sq = 0.0;</span></div>
<div class="line"><span class="lineno">  162</span><span class="comment">                                const PetscInt i_local = i - xs_cell, j_local = j - ys_cell, k_local = k - zs_cell;</span></div>
<div class="line"><span class="lineno">  163</span><span class="comment">                                if (cent_coor &amp;&amp; i_local &gt;= 0 &amp;&amp; i_local &lt; xm_cell &amp;&amp; j_local &gt;= 0 &amp;&amp; j_local &lt; ym_cell &amp;&amp; k_local &gt;= 0 &amp;&amp; k_local &lt; zm_cell) {</span></div>
<div class="line"><span class="lineno">  164</span><span class="comment">                                    const Cmpnts* center = &amp;cent_coor[k_local][j_local][i_local];</span></div>
<div class="line"><span class="lineno">  165</span><span class="comment">                                    if (user-&gt;identifiedInletBCFace &lt;= BC_FACE_POS_X) r_sq = center-&gt;y * center-&gt;y + center-&gt;z * center-&gt;z;</span></div>
<div class="line"><span class="lineno">  166</span><span class="comment">                                    else if (user-&gt;identifiedInletBCFace &lt;= BC_FACE_POS_Y) r_sq = center-&gt;x * center-&gt;x + center-&gt;z * center-&gt;z;</span></div>
<div class="line"><span class="lineno">  167</span><span class="comment">                                    else r_sq = center-&gt;x * center-&gt;x + center-&gt;y * center-&gt;y;</span></div>
<div class="line"><span class="lineno">  168</span><span class="comment">                    // pick the correct contravariant component for centerline speed </span></div>
<div class="line"><span class="lineno">  169</span><span class="comment">                    PetscReal u0;</span></div>
<div class="line"><span class="lineno">  170</span><span class="comment">                    if (user-&gt;identifiedInletBCFace == BC_FACE_NEG_X ||</span></div>
<div class="line"><span class="lineno">  171</span><span class="comment">                    user-&gt;identifiedInletBCFace == BC_FACE_POS_X) {</span></div>
<div class="line"><span class="lineno">  172</span><span class="comment">                      u0 = uin.x;</span></div>
<div class="line"><span class="lineno">  173</span><span class="comment">                    } else if (user-&gt;identifiedInletBCFace == BC_FACE_NEG_Y ||</span></div>
<div class="line"><span class="lineno">  174</span><span class="comment">                           user-&gt;identifiedInletBCFace == BC_FACE_POS_Y) {</span></div>
<div class="line"><span class="lineno">  175</span><span class="comment">                      u0 = uin.y;</span></div>
<div class="line"><span class="lineno">  176</span><span class="comment">                    } else {</span></div>
<div class="line"><span class="lineno">  177</span><span class="comment">                      u0 = uin.z;</span></div>
<div class="line"><span class="lineno">  178</span><span class="comment">                    }</span></div>
<div class="line"><span class="lineno">  179</span><span class="comment">                    // now form the parabolic profile as before </span></div>
<div class="line"><span class="lineno">  180</span><span class="comment">                                    normal_velocity_mag = 2.0 * u0 * (1.0 - 4.0 * r_sq);</span></div>
<div class="line"><span class="lineno">  181</span><span class="comment">                                }</span></div>
<div class="line"><span class="lineno">  182</span><span class="comment">                            }</span></div>
<div class="line"><span class="lineno">  183</span><span class="comment">                            break;</span></div>
<div class="line"><span class="lineno">  184</span><span class="comment">                */</span></div>
<div class="line"><span class="lineno">  185</span>                        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  186</span>                            <a class="code hl_define" href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a>(<a class="code hl_define" href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a>, <a class="code hl_enumvalue" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a>, <span class="stringliteral">&quot;Unrecognized FieldInitialization profile %d. Defaulting to zero.\n&quot;</span>, simCtx-&gt;<a class="code hl_variable" href="variables_8h.html#a483945572b5ab1461a864ee1e3eb1d37">FieldInitialization</a>);</div>
<div class="line"><span class="lineno">  187</span>                            normal_velocity_mag = 0.0;</div>
<div class="line"><span class="lineno">  188</span>                            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  189</span>                    }</div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>                    <span class="comment">// Step B: Apply direction sign and set the correct contravariant component.</span></div>
<div class="line"><span class="lineno">  192</span>                    <span class="comment">// The contravariant component U^n = v_n * Area_n, where v_n is the physical normal velocity.</span></div>
<div class="line"><span class="lineno">  193</span>                    <span class="keywordflow">if</span> (normal_velocity_mag != 0.0) {</div>
<div class="line"><span class="lineno">  194</span>               <span class="keyword">const</span> PetscReal signed_normal_vel = normal_velocity_mag * flow_direction_sign*user-&gt;<a class="code hl_variable" href="variables__old_8h.html#accf2da0245f804c37780b4653a16f9f3">GridOrientation</a>;</div>
<div class="line"><span class="lineno">  195</span>                        </div>
<div class="line"><span class="lineno">  196</span>                        <span class="keywordflow">if</span> (user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a27bce072860da2f1a8a54d94b2b9497f">identifiedInletBCFace</a> == <a class="code hl_enumvalue" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafa19d65b9e7835046cd7e2ca88cc7cb611">BC_FACE_NEG_X</a> || user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a27bce072860da2f1a8a54d94b2b9497f">identifiedInletBCFace</a> == <a class="code hl_enumvalue" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafabbe50296e7a96e9818fa4d11bcc4443c">BC_FACE_POS_X</a>) {</div>
<div class="line"><span class="lineno">  197</span>                            <span class="keyword">const</span> PetscReal area_i = sqrt(csi_arr[k][j][i].x * csi_arr[k][j][i].x + csi_arr[k][j][i].y * csi_arr[k][j][i].y + csi_arr[k][j][i].z * csi_arr[k][j][i].z);</div>
<div class="line"><span class="lineno">  198</span>                </div>
<div class="line"><span class="lineno">  199</span>                            ucont_val.<a class="code hl_variable" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a> = signed_normal_vel * area_i;</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>                <a class="code hl_define" href="logging_8h.html#a1543cd95db1569c7d901fd4b9a3a43d7">LOG_LOOP_ALLOW</a>(<a class="code hl_define" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code hl_enumvalue" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,k,50,<span class="stringliteral">&quot; ucont_val.x = %.6f (signed_normal_vel=%.3f  area=%.4f)\n&quot;</span>,ucont_val.<a class="code hl_variable" href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">x</a>, signed_normal_vel, area_i);</div>
<div class="line"><span class="lineno">  202</span>                        } </div>
<div class="line"><span class="lineno">  203</span>                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a27bce072860da2f1a8a54d94b2b9497f">identifiedInletBCFace</a> == <a class="code hl_enumvalue" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafad74ee1b3767f0c8d5251abe91549c99a">BC_FACE_NEG_Y</a> || user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a27bce072860da2f1a8a54d94b2b9497f">identifiedInletBCFace</a> == <a class="code hl_enumvalue" href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafa9c068efc5178fd37591bbcdf5e86b3fb">BC_FACE_POS_Y</a>) {</div>
<div class="line"><span class="lineno">  204</span>                            <span class="keyword">const</span> PetscReal area_j = sqrt(eta_arr[k][j][i].x * eta_arr[k][j][i].x + eta_arr[k][j][i].y * eta_arr[k][j][i].y + eta_arr[k][j][i].z * eta_arr[k][j][i].z);</div>
<div class="line"><span class="lineno">  205</span>                 </div>
<div class="line"><span class="lineno">  206</span>                            ucont_val.<a class="code hl_variable" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a> = signed_normal_vel * area_j;</div>
<div class="line"><span class="lineno">  207</span> </div>
<div class="line"><span class="lineno">  208</span>                <a class="code hl_define" href="logging_8h.html#a1543cd95db1569c7d901fd4b9a3a43d7">LOG_LOOP_ALLOW</a>(<a class="code hl_define" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code hl_enumvalue" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,k,50,<span class="stringliteral">&quot; ucont_val.y = %.6f (signed_normal_vel=%.3f  area=%.4f)\n&quot;</span>,ucont_val.<a class="code hl_variable" href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">y</a>, signed_normal_vel, area_j);</div>
<div class="line"><span class="lineno">  209</span>                        } </div>
<div class="line"><span class="lineno">  210</span>                        <span class="keywordflow">else</span> { <span class="comment">// Z-inlet</span></div>
<div class="line"><span class="lineno">  211</span>                            <span class="keyword">const</span> PetscReal area_k = sqrt(zet_arr[k][j][i].x * zet_arr[k][j][i].x + zet_arr[k][j][i].y * zet_arr[k][j][i].y + zet_arr[k][j][i].z * zet_arr[k][j][i].z);</div>
<div class="line"><span class="lineno">  212</span> </div>
<div class="line"><span class="lineno">  213</span>                            ucont_val.<a class="code hl_variable" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a> = signed_normal_vel * area_k;</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>                <a class="code hl_define" href="logging_8h.html#a1543cd95db1569c7d901fd4b9a3a43d7">LOG_LOOP_ALLOW</a>(<a class="code hl_define" href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a>,<a class="code hl_enumvalue" href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a>,k,50,<span class="stringliteral">&quot; i,j,k,ucont_val.z = %d, %d, %d, %.6f (signed_normal_vel=%.3f  area=%.4f)\n&quot;</span>,i,j,k,ucont_val.<a class="code hl_variable" href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">z</a>, signed_normal_vel, area_k);</div>
<div class="line"><span class="lineno">  216</span>                        }</div>
<div class="line"><span class="lineno">  217</span>                    }</div>
<div class="line"><span class="lineno">  218</span>                    ucont_arr[k][j][i] = ucont_val;</div>
<div class="line"><span class="lineno">  219</span>                } <span class="comment">// end if(is_interior)</span></div>
<div class="line"><span class="lineno">  220</span>            }</div>
<div class="line"><span class="lineno">  221</span>        }</div>
<div class="line"><span class="lineno">  222</span>    }</div>
<div class="line"><span class="lineno">  223</span>    ierr = DMDAVecRestoreArray(fieldDM, fieldVec, &amp;ucont_arr); CHKERRQ(ierr);</div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span>    <span class="comment">// --- 5. Cleanup: Restore arrays and free temporary memory ---</span></div>
<div class="line"><span class="lineno">  226</span>    ierr = DMDAVecRestoreArrayRead(user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, localCoor, &amp;coor_arr); CHKERRQ(ierr);</div>
<div class="line"><span class="lineno">  227</span>    ierr = DMDAVecRestoreArrayRead(user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a9693ebf5c9ea601d5ebaf6d24cc60721">lCsi</a>, &amp;csi_arr); CHKERRQ(ierr);</div>
<div class="line"><span class="lineno">  228</span>    ierr = DMDAVecRestoreArrayRead(user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, user-&gt;<a class="code hl_variable" href="variables__old_8h.html#ad4296b10d8eb7b065165582f5cc85897">lEta</a>, &amp;eta_arr); CHKERRQ(ierr);</div>
<div class="line"><span class="lineno">  229</span>    ierr = DMDAVecRestoreArrayRead(user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a69966d928601d61d4f526636f84396c5">fda</a>, user-&gt;<a class="code hl_variable" href="variables__old_8h.html#a414751d7a391a78834cdce87b52a066f">lZet</a>, &amp;zet_arr); CHKERRQ(ierr);</div>
<div class="line"><span class="lineno">  230</span>    </div>
<div class="line"><span class="lineno">  231</span>    <span class="keywordflow">if</span> (cent_coor) {</div>
<div class="line"><span class="lineno">  232</span>        ierr = <a class="code hl_define" href="setup_8h.html#a22b5c669feeea4b3ad4ffd152590dcb4">Deallocate3DArray</a>(cent_coor, zm_cell, ym_cell); CHKERRQ(ierr);</div>
<div class="line"><span class="lineno">  233</span>    }</div>
<div class="line"><span class="lineno">  234</span> </div>
<div class="line"><span class="lineno">  235</span>    PetscFunctionReturn(0);</div>
<div class="line"><span class="lineno">  236</span>}</div>
<div class="ttc" id="ainterpolation_8h_html_ab10820f766502b3dc7acaca2e61c5628"><div class="ttname"><a href="interpolation_8h.html#ab10820f766502b3dc7acaca2e61c5628">InterpolateFieldFromCornerToCenter</a></div><div class="ttdeci">#define InterpolateFieldFromCornerToCenter(field, centfield, user)</div><div class="ttdoc">Generic macro to call the appropriate interpolation function based on the field type.</div><div class="ttdef"><b>Definition</b> <a href="interpolation_8h_source.html#l00036">interpolation.h:36</a></div></div>
<div class="ttc" id="alogging_8h_html_a1543cd95db1569c7d901fd4b9a3a43d7"><div class="ttname"><a href="logging_8h.html#a1543cd95db1569c7d901fd4b9a3a43d7">LOG_LOOP_ALLOW</a></div><div class="ttdeci">#define LOG_LOOP_ALLOW(scope, level, iterVar, interval, fmt,...)</div><div class="ttdoc">Logs a message inside a loop, but only every interval iterations.</div><div class="ttdef"><b>Definition</b> <a href="logging_8h_source.html#l00319">logging.h:319</a></div></div>
<div class="ttc" id="alogging_8h_html_a3758dd5d300a594312c95bc393378df0"><div class="ttname"><a href="logging_8h.html#a3758dd5d300a594312c95bc393378df0">LOCAL</a></div><div class="ttdeci">#define LOCAL</div><div class="ttdoc">Logging scope definitions for controlling message output.</div><div class="ttdef"><b>Definition</b> <a href="logging_8h_source.html#l00044">logging.h:44</a></div></div>
<div class="ttc" id="alogging_8h_html_a3de33738fd3c7e77bffbcfaefc3e7645"><div class="ttname"><a href="logging_8h.html#a3de33738fd3c7e77bffbcfaefc3e7645">GLOBAL</a></div><div class="ttdeci">#define GLOBAL</div><div class="ttdoc">Scope for global logging across all processes.</div><div class="ttdef"><b>Definition</b> <a href="logging_8h_source.html#l00045">logging.h:45</a></div></div>
<div class="ttc" id="alogging_8h_html_a4a671b0e347e0a22b0df806f246d5d11"><div class="ttname"><a href="logging_8h.html#a4a671b0e347e0a22b0df806f246d5d11">LOG_ALLOW</a></div><div class="ttdeci">#define LOG_ALLOW(scope, level, fmt,...)</div><div class="ttdoc">Logging macro that checks both the log level and whether the calling function is in the allowed-funct...</div><div class="ttdef"><b>Definition</b> <a href="logging_8h_source.html#l00207">logging.h:207</a></div></div>
<div class="ttc" id="alogging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a6e98ff471e3ce6c4ef2d75c37ee51837">LOG_INFO</a></div><div class="ttdeci">@ LOG_INFO</div><div class="ttdoc">Informational messages about program execution.</div><div class="ttdef"><b>Definition</b> <a href="logging_8h_source.html#l00032">logging.h:32</a></div></div>
<div class="ttc" id="alogging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9a8f6fe15bfe15104da6d1b360194a5400">LOG_WARNING</a></div><div class="ttdeci">@ LOG_WARNING</div><div class="ttdoc">Non-critical issues that warrant attention.</div><div class="ttdef"><b>Definition</b> <a href="logging_8h_source.html#l00030">logging.h:30</a></div></div>
<div class="ttc" id="alogging_8h_html_aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e"><div class="ttname"><a href="logging_8h.html#aca1fd1d8935433e6ba2e3918214e07f9ab9f002c6ffbfd511da8090213227454e">LOG_DEBUG</a></div><div class="ttdeci">@ LOG_DEBUG</div><div class="ttdoc">Detailed debugging information.</div><div class="ttdef"><b>Definition</b> <a href="logging_8h_source.html#l00033">logging.h:33</a></div></div>
<div class="ttc" id="asetup_8h_html_a0e1e86f6c7ecdee0c26e62b2458ab455"><div class="ttname"><a href="setup_8h.html#a0e1e86f6c7ecdee0c26e62b2458ab455">Allocate3DArray</a></div><div class="ttdeci">#define Allocate3DArray(array, nz, ny, nx)</div><div class="ttdef"><b>Definition</b> <a href="setup_8h_source.html#l00028">setup.h:28</a></div></div>
<div class="ttc" id="asetup_8h_html_a22b5c669feeea4b3ad4ffd152590dcb4"><div class="ttname"><a href="setup_8h.html#a22b5c669feeea4b3ad4ffd152590dcb4">Deallocate3DArray</a></div><div class="ttdeci">#define Deallocate3DArray(array, nz, ny)</div><div class="ttdef"><b>Definition</b> <a href="setup_8h_source.html#l00035">setup.h:35</a></div></div>
<div class="ttc" id="asetup_8h_html_a25ce912d8aafa319a8c915cd350c7322"><div class="ttname"><a href="setup_8h.html#a25ce912d8aafa319a8c915cd350c7322">GetGhostedCellRange</a></div><div class="ttdeci">PetscErrorCode GetGhostedCellRange(const DMDALocalInfo *info_nodes, const RankNeighbors *neighbors, PetscInt dim, PetscInt *xs_cell_global_out, PetscInt *xm_cell_local_out)</div><div class="ttdoc">Gets the global cell range for a rank, including boundary cells.</div><div class="ttdef"><b>Definition</b> <a href="setup_8c_source.html#l01396">setup.c:1396</a></div></div>
<div class="ttc" id="avariables_8h_html_a483945572b5ab1461a864ee1e3eb1d37"><div class="ttname"><a href="variables_8h.html#a483945572b5ab1461a864ee1e3eb1d37">SimCtx::FieldInitialization</a></div><div class="ttdeci">PetscInt FieldInitialization</div><div class="ttdef"><b>Definition</b> <a href="variables_8h_source.html#l00511">variables.h:511</a></div></div>
<div class="ttc" id="avariables_8h_html_ac503944447b87fc650e0ffa74a780b36"><div class="ttname"><a href="variables_8h.html#ac503944447b87fc650e0ffa74a780b36">SimCtx::InitialConstantContra</a></div><div class="ttdeci">Cmpnts InitialConstantContra</div><div class="ttdef"><b>Definition</b> <a href="variables_8h_source.html#l00512">variables.h:512</a></div></div>
<div class="ttc" id="avariables_8h_html_afc4c17936462d8236c21005c4cf6bbafa19d65b9e7835046cd7e2ca88cc7cb611"><div class="ttname"><a href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafa19d65b9e7835046cd7e2ca88cc7cb611">BC_FACE_NEG_X</a></div><div class="ttdeci">@ BC_FACE_NEG_X</div><div class="ttdef"><b>Definition</b> <a href="variables_8h_source.html#l00201">variables.h:201</a></div></div>
<div class="ttc" id="avariables_8h_html_afc4c17936462d8236c21005c4cf6bbafa9c068efc5178fd37591bbcdf5e86b3fb"><div class="ttname"><a href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafa9c068efc5178fd37591bbcdf5e86b3fb">BC_FACE_POS_Y</a></div><div class="ttdeci">@ BC_FACE_POS_Y</div><div class="ttdef"><b>Definition</b> <a href="variables_8h_source.html#l00202">variables.h:202</a></div></div>
<div class="ttc" id="avariables_8h_html_afc4c17936462d8236c21005c4cf6bbafabbe50296e7a96e9818fa4d11bcc4443c"><div class="ttname"><a href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafabbe50296e7a96e9818fa4d11bcc4443c">BC_FACE_POS_X</a></div><div class="ttdeci">@ BC_FACE_POS_X</div><div class="ttdef"><b>Definition</b> <a href="variables_8h_source.html#l00201">variables.h:201</a></div></div>
<div class="ttc" id="avariables_8h_html_afc4c17936462d8236c21005c4cf6bbafad74ee1b3767f0c8d5251abe91549c99a"><div class="ttname"><a href="variables_8h.html#afc4c17936462d8236c21005c4cf6bbafad74ee1b3767f0c8d5251abe91549c99a">BC_FACE_NEG_Y</a></div><div class="ttdeci">@ BC_FACE_NEG_Y</div><div class="ttdef"><b>Definition</b> <a href="variables_8h_source.html#l00202">variables.h:202</a></div></div>
<div class="ttc" id="avariables_8h_html_structSimCtx"><div class="ttname"><a href="variables_8h.html#structSimCtx">SimCtx</a></div><div class="ttdoc">The master context for the entire simulation.</div><div class="ttdef"><b>Definition</b> <a href="variables_8h_source.html#l00474">variables.h:474</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a27bce072860da2f1a8a54d94b2b9497f"><div class="ttname"><a href="variables__old_8h.html#a27bce072860da2f1a8a54d94b2b9497f">UserCtx::identifiedInletBCFace</a></div><div class="ttdeci">BCFace identifiedInletBCFace</div><div class="ttdoc">Legacy field for particle system compatibility.</div><div class="ttdef"><b>Definition</b> <a href="variables_8h_source.html#l00602">variables.h:602</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a322702c716e6e140d71515d0b3e111b1"><div class="ttname"><a href="variables__old_8h.html#a322702c716e6e140d71515d0b3e111b1">UserCtx::simCtx</a></div><div class="ttdeci">SimCtx * simCtx</div><div class="ttdoc">Back-pointer to the master simulation context.</div><div class="ttdef"><b>Definition</b> <a href="variables_8h_source.html#l00585">variables.h:585</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a414751d7a391a78834cdce87b52a066f"><div class="ttname"><a href="variables__old_8h.html#a414751d7a391a78834cdce87b52a066f">UserCtx::lZet</a></div><div class="ttdeci">Vec lZet</div><div class="ttdef"><b>Definition</b> <a href="variables_8h_source.html#l00625">variables.h:625</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a58c51750e5a9172516dd2af41fd5fd42"><div class="ttname"><a href="variables__old_8h.html#a58c51750e5a9172516dd2af41fd5fd42">UserCtx::neighbors</a></div><div class="ttdeci">RankNeighbors neighbors</div><div class="ttdoc">MPI ranks of neighboring subdomains.</div><div class="ttdef"><b>Definition</b> <a href="variables_8h_source.html#l00594">variables.h:594</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a69966d928601d61d4f526636f84396c5"><div class="ttname"><a href="variables__old_8h.html#a69966d928601d61d4f526636f84396c5">UserCtx::fda</a></div><div class="ttdeci">DM fda</div><div class="ttdoc">DMDA for primary 3-component vector fields (e.g., Velocity).</div><div class="ttdef"><b>Definition</b> <a href="variables_8h_source.html#l00588">variables.h:588</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a69c3a361d1aac3bdc14f971bda57e032"><div class="ttname"><a href="variables__old_8h.html#a69c3a361d1aac3bdc14f971bda57e032">UserCtx::Ucont</a></div><div class="ttdeci">Vec Ucont</div><div class="ttdef"><b>Definition</b> <a href="variables_8h_source.html#l00609">variables.h:609</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a718a09fbedf450248eaf7019a980e139"><div class="ttname"><a href="variables__old_8h.html#a718a09fbedf450248eaf7019a980e139">Cmpnts::x</a></div><div class="ttdeci">PetscScalar x</div><div class="ttdef"><b>Definition</b> <a href="variables_8h_source.html#l00101">variables.h:101</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a9693ebf5c9ea601d5ebaf6d24cc60721"><div class="ttname"><a href="variables__old_8h.html#a9693ebf5c9ea601d5ebaf6d24cc60721">UserCtx::lCsi</a></div><div class="ttdeci">Vec lCsi</div><div class="ttdef"><b>Definition</b> <a href="variables_8h_source.html#l00625">variables.h:625</a></div></div>
<div class="ttc" id="avariables__old_8h_html_a9f0c002a2c7cde3b6ac843ab9185f4d4"><div class="ttname"><a href="variables__old_8h.html#a9f0c002a2c7cde3b6ac843ab9185f4d4">Cmpnts::z</a></div><div class="ttdeci">PetscScalar z</div><div class="ttdef"><b>Definition</b> <a href="variables_8h_source.html#l00101">variables.h:101</a></div></div>
<div class="ttc" id="avariables__old_8h_html_accf2da0245f804c37780b4653a16f9f3"><div class="ttname"><a href="variables__old_8h.html#accf2da0245f804c37780b4653a16f9f3">UserCtx::GridOrientation</a></div><div class="ttdeci">PetscInt GridOrientation</div><div class="ttdoc">Integerer that determines Whether grid is right-handed (+1) or left-handed (-1) i....</div><div class="ttdef"><b>Definition</b> <a href="variables_8h_source.html#l00595">variables.h:595</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ad032e456f7f4b32b9ac0d94be05de204"><div class="ttname"><a href="variables__old_8h.html#ad032e456f7f4b32b9ac0d94be05de204">Cmpnts::y</a></div><div class="ttdeci">PetscScalar y</div><div class="ttdef"><b>Definition</b> <a href="variables_8h_source.html#l00101">variables.h:101</a></div></div>
<div class="ttc" id="avariables__old_8h_html_ad4296b10d8eb7b065165582f5cc85897"><div class="ttname"><a href="variables__old_8h.html#ad4296b10d8eb7b065165582f5cc85897">UserCtx::lEta</a></div><div class="ttdeci">Vec lEta</div><div class="ttdef"><b>Definition</b> <a href="variables_8h_source.html#l00625">variables.h:625</a></div></div>
<div class="ttc" id="avariables__old_8h_html_af031acb43b014d5ac788aa9003491e75"><div class="ttname"><a href="variables__old_8h.html#af031acb43b014d5ac788aa9003491e75">UserCtx::da</a></div><div class="ttdeci">DM da</div><div class="ttdoc">DMDA for scalar fields (e.g., Pressure, Nvert).</div><div class="ttdef"><b>Definition</b> <a href="variables_8h_source.html#l00588">variables.h:588</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="AnalyticalSolution_8h_a62dfa993750dc34d1729c575bb1dde66_cgraph.svg" width="587" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ad358f49191579d343dee83d4f58c1ceb" name="ad358f49191579d343dee83d4f58c1ceb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad358f49191579d343dee83d4f58c1ceb">&#9670;&#160;</a></span>SetLocalCartesianField_Scalar()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode SetLocalCartesianField_Scalar </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fieldName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscReal *&#160;</td>
          <td class="paramname"><em>scalarField</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a> *&#160;</td>
          <td class="paramname"><em>coor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>FieldInitialization</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscReal&#160;</td>
          <td class="paramname"><em>Constant</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the local Cartesian scalar field based on input coordinates. </p>
<p>This function computes the scalar field value by combining the sine of the input coordinate values. In this example, the scalar field is computed as the sum of the sine functions of the x, y, and z coordinates.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fieldName</td><td>Pointer to a string representing the field name (for logging purposes). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">scalarField</td><td>Pointer to the PetscReal where the computed scalar field value will be stored. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coor</td><td>Pointer to the <code><a class="el" href="variables__old_8h.html#structCmpnts" title="A 3D point or vector with PetscScalar components.">Cmpnts</a></code> structure containing the input coordinate values.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on successful execution, non-zero on failure. </dd></dl>

</div>
</div>
<a id="afe02409e02e745056dc01e825fbb855a" name="afe02409e02e745056dc01e825fbb855a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe02409e02e745056dc01e825fbb855a">&#9670;&#160;</a></span>SetLocalCartesianField_Vector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">PetscErrorCode SetLocalCartesianField_Vector </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fieldName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a> *&#160;</td>
          <td class="paramname"><em>vecField</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="variables__old_8h.html#structCmpnts">Cmpnts</a> *&#160;</td>
          <td class="paramname"><em>coor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscInt&#160;</td>
          <td class="paramname"><em>FieldInitialization</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PetscReal&#160;</td>
          <td class="paramname"><em>Constant</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sets the local Cartesian vector field based on input coordinates. </p>
<p>This function computes the vector components by applying the sine function to the input coordinate values along the x, y, and z directions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">fieldName</td><td>Pointer to a string representing the field name (for logging purposes). </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">vecField</td><td>Pointer to the <code><a class="el" href="variables__old_8h.html#structCmpnts" title="A 3D point or vector with PetscScalar components.">Cmpnts</a></code> structure where the computed vector field will be stored. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">coor</td><td>Pointer to the <code><a class="el" href="variables__old_8h.html#structCmpnts" title="A 3D point or vector with PetscScalar components.">Cmpnts</a></code> structure containing the input coordinate values.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>PetscErrorCode Returns 0 on successful execution, non-zero on failure. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d44c64559bbebec7f509842c48db8b23.html">include</a></li><li class="navelem"><a class="el" href="AnalyticalSolution_8h.html">AnalyticalSolution.h</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
