<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>How E-commerce Dataset look like and what can we do? | Khanh H. Le</title> <meta name="author" content="Khanh H. Le"/> <meta name="description" content="an example of analysis and modeling data in E-commerce"/> <meta name="keywords" content="Machine Learning, Deep Learning, Artificial intelligence, Data, Data Scientist, Ho Chi Minh City"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="none" id="highlight_theme_light"/> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üòâ</text></svg>"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://lekhanhh.github.io/blog/2022/E-commerce-blogpost-distill/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script src="/assets/js/distillpub/template.v2.js"></script> <script src="/assets/js/distillpub/transforms.v2.js"></script> <script src="/assets/js/distillpub/overrides.js"></script> <style type="text/css">.fake-img{background:#bbb;border:1px solid rgba(0,0,0,0.1);box-shadow:0 0 4px rgba(0,0,0,0.1);margin-bottom:12px}.fake-img p{font-family:monospace;color:white;text-align:left;margin:12px 0;text-align:center;font-size:16px}</style> </head> <d-front-matter> <script async type="text/json">{
      "title": "How E-commerce Dataset look like and what can we do?",
      "description": "an example of analysis and modeling data in E-commerce",
      "published": "August 31, 2022",
      "authors": [
        {
          "author": "Khanh H. Le",
          "authorURL": "https://lekhanhh.github.io/",
          "affiliations": [
            {
              "name": "FPT-Software, HCMC",
              "url": ""
            }
          ]
        }
        
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script> </d-front-matter> <body class="fixed-top-nav"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"><span class="font-weight-bold">Khanh¬†</span>H.¬†Le</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="nav-item "> <a class="nav-link" href="/teaching/">teaching</a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">experiences</a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <div class="dropdown-divider"></div> <a class="dropdown-item" href="/projects/">projects</a> </div> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="post distill"> <d-title> <h1>How E-commerce Dataset look like and what can we do?</h1> <p>an example of analysis and modeling data in E-commerce</p> </d-title> <d-byline></d-byline> <d-article> <d-contents> <nav class="l-text figcaption"> <h3>Contents</h3> <div><a href="#preface">Preface</a></div> <div><a href="#data-preparation">Data preparation</a></div> <div><a href="#data-cleaning">Data cleaning</a></div> <div><a href="#data-understanding-data-featuring-data-visualizing-and-data-modeling">Data Understanding, Data Featuring, Data Visualizing and Data Modeling</a></div> <div><a href="#conclusion">Conclusion</a></div> </nav> </d-contents> <p><strong>NOTE:</strong> This blog base on my work. See full code in my <a href="https://github.com/lekhanhh/udacity_1st_project" target="_blank" rel="noopener noreferrer">repository</a></p> <h2 id="preface">Preface</h2> <p>In this blog, we‚Äôre given a E-commerce dataset, let‚Äôs see what E-commerce dataset look like, what kind of problem we have to face, and how to solve it. For example, In order to define marketing goals, plan spending to lower acquisition costs, we want to know the revenue that customers can bring to our business in their lifetime.</p> <hr> <h2 id="data-preparation">Data preparation</h2> <p>Read dataframe using pandas, show a preview of data.</p> <d-code block="" language="python"> df = pd.read_csv(data_path, encoding= 'unicode_escape') df.sample(10) </d-code> <div class="row mt-3"> <div class="col-sm mt-6 mt-md-0"> <figure> <picture> <img src="/assets/img/udacity/quick_view.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Quick describe dataset</p> <d-code block="" language="python"> df.describe() </d-code> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/udacity/describe.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>With basic view of dataset, we can notice that:</p> <ul> <li>Quantity and UnitPrice has min value lower than Zero, this may caused by cancelled orders, discount or sth.</li> <li>Invoice and StockCode contain special character, should be a pattern that we have to be cleared.</li> <li>There‚Äôre anomalies in Quantity and UnitPrice. The min, max values in far away from the standard deviation (compare min, max vs std value). But this might happend in real life, when a customer/enterprise had bulk order.</li> <li>There‚Äôs some missing values from CustomerID</li> </ul> <p>More details on describing dataset</p> <div class="row mt-3"> <div class="col-sm mt-6 mt-md-0"> <figure> <picture> <img src="/assets/img/udacity/adv-describe.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>4070 unique StockCode but 4223 unique Description =&gt; It might have multiple version of Product name, we should aware working with Product name. 4372 CustomerID = 4372 Customers, compared to 541909 records. But we‚Äôre missing 24.9% (135080 records) of customerID. I got 2 options for missing customerID:</p> <p>Assume that each row which missing customerID as a new Customer -&gt; assign them as a new CustomerID. In real life, we can use some Data Engineer techiques to acquire missing data in DataWarehouse or DataLake.</p> <ul> <li>Consider to delete all missing data, because it affects to the buying history of customer if we can‚Äôt assign to the right customer, it becomes bad data. Remember: Garbage In, Garbage Out.</li> <li>We had 4372 customers and 135080 missing records, it will be weird if we assign 135080 new customers, this will make the data bias and unstable. So we should choose 2nd option with this dataset and this specific problem.</li> </ul> <hr> <h2 id="data-cleaning">Data cleaning</h2> <p>In cleaning phase, I remove all rows with customerID is Null, can be done easily</p> <d-code block="" language="python"> df.dropna(axis = 0, subset = ['CustomerID'], inplace = True) </d-code> <p>Then, revome duplicates if any.</p> <p>In previous section, I mentioned that there‚Äôre some pattern relate to special character in StockCode and InvoiceNo, I have hypothesis that InvoiceNo with ‚ÄúC‚Äù character is cancel order base on my observation (Quantity and UnitPrice are negative) Then I wrote function that detect strange characters in both StockCode and InvoiceNo, here‚Äôs result:</p> <div class="row mt-3"> <div class="col-sm mt-6 mt-md-0"> <figure> <picture> <img src="/assets/img/udacity/strange-character.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>I proved my hypothesis using code, all of ‚ÄúC‚Äù InvoiceNO are negative using code (see more at my notebook - ‚ÄúC‚Äù pattern). Beside, there‚Äôre some strange string in StockCode stand alone without number:</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/udacity/strange-string.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>So these transactions should represent for some extra Postages/Carriage/Charges from bank/extra pad as present/CRUK commission. I decide to drop all rows as it don‚Äôt relate to order &amp; customer behavior, these should belong to business side.</p> <hr> <h2 id="data-understanding-data-featuring-data-visualizing-and-data-modeling">Data Understanding, Data Featuring, Data Visualizing and Data Modeling</h2> <p>In order to measure how each customer contribute to the business, we have to minus all cancelled order.</p> <p>My hypothesis: The InvoiceNo of canceled orders is added ‚ÄòC‚Äô character from orginal InvoiceNo Ex: Order invoiceNo 222222, if the customer cancel, the cancel invoiceNo should be C222222 But when checking with Python, my hypothesis is not fullfill. That mean the cancel order will generate Invoice number with ‚ÄòC‚Äô character. One possible method is groupby CustomerID and StockCode, which can be aggregated to identify the right quantity and total price of transaction with the business.</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/udacity/sorted.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>We got 2 screnarios:</p> <ul> <li>Customer cancelled all items of an order</li> <li>Customer cancelled part of an order</li> </ul> <p>If we group Customer and StockCode, then sum the Quantity &amp; UnitPrice, it should solve that cancelled Products. Thus, I want to plot order groupby country.</p> <div class="row mt-3"> <div class="col-sm mt-6 mt-md-0"> <figure> <picture> <img src="/assets/img/udacity/country.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>In order to plan spending to lower acquisition costs, we want to know the revenue that customers can bring to our business in their lifetime (aka CLV) To answer this question, with the data we got. I have 2 options to solve the problem.</p> <ul> <li>Customer Segment to define group of customer, deeper analyst to know who they are, so we can pick the right marketing Strategy for them based on Purpose, how to acquire more people like them. With this dataframe, we can use KMean or SVC for customer segmentation, I would use KMean in this post</li> <li>For a lifetime value, I recommend a RFM Model to evaluate Recency, Frequency, Monetary Value of each customer. With a new Marketing Goals demand, we can choose the right customer group for.</li> </ul> <p>I create new DataFrame that count the number of orders made by each customerID. Then plot the density</p> <div class="row mt-3"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/udacity/total-invoice.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <img src="/assets/img/udacity/total-invoice-density.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Do some featuring, to calculate Recency, Frequency, Monetary I also calculate MostRecent and EngagedAge of each customer base on Earliest and Lastest Invoice. Let‚Äôs plot the price range to see the distribution of Customer spending</p> <div class="row mt-3"> <div class="col-sm mt-6 mt-md-0"> <figure> <picture> <img src="/assets/img/udacity/totalpaid-distribution.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>As we can see, 93% of real puchased item is from 100-10000 4.2% go from range 0-100 2.2% customer spent over 20000 The porfolio is quite good.</p> <div class="row mt-3"> <div class="col-sm mt-6 mt-md-0"> <figure> <picture> <img src="/assets/img/udacity/density.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Look at the density plotting figures:</p> <ul> <li>Data should have one year transaction, and a lot of customers have not bought any items for a long time.</li> <li>A high number of customer have not bought frequently.</li> <li>There‚Äôre some strange orders with high value and number of items so that density is left-skewed</li> </ul> <p>RFM Calculation, Transform, Scale and put scaled data into KMean.</p> <d-code block="" language="python"> from sklearn.preprocessing import StandardScaler scaler = StandardScaler() scaler.fit(df_customers) df_customers = scaler.transform(df_customers) </d-code> <p>With KMean, I use Elbow Method to optimize number of cluster (k).</p> <div class="row mt-3"> <div class="col-sm mt-6 mt-md-0"> <figure> <picture> <img src="/assets/img/udacity/elbow.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Elbow Method plot dispersion and k into a line graph, and the elbow of the linegraph is where the balance of 2 variables meet. In this graph, I pick 4 is the number of cluster. Run KMean</p> <p>Then, map the clusterred label to the previous dataset.</p> <div class="row mt-3"> <div class="col-sm mt3 mt-md-0"> <figure> <picture> <img src="/assets/img/udacity/cluster.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Groupby Cluster, we can see differences between groups</p> <div class="row mt-3"> <div class="col-sm mt3 mt-md-0"> <figure> <picture> <img src="/assets/img/udacity/cluster-groupby.png" class="img-fluid rounded z-depth-1" width="auto" height="auto" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Group 0 : Customers recently buy at high frequency and the amount buying is amazing (average 10000) <br> Group 1 : Customers shopped for a long time, rarely shop with a decent amount, we shoud try to acquire these customer by trying to figure out why they churned <br> Group 2 : Customers from last month, regularly and highly purchased. <br></p> <hr> <h2 id="conclusion">Conclusion</h2> <p>This blog just show how to deal with E-commerce dataset, find insights from our customer and show an algorithm that separate customers into segments. Then, we can build customer porfolios of a business to deeper understand our customer, therefore, build a suitable strategies for acquiring new customer with same porfolio, retrieve current customer and build relationship with customer based on each group. For example with group 0 : these customers should have a loyalty program to make them stay with company, invite them us new product or special promotion. Keep track of their value feedback to perfect the product or process.</p> <p>Further work: With this Dataset, we can build a model that detect factors affectting customer churning or even predict customer churn rate.</p> </d-article> <d-appendix> <d-footnote-list></d-footnote-list> <d-citation-list></d-citation-list> </d-appendix> </div> <footer class="fixed-bottom"> <div class="container mt-0"> ¬© Copyright 2022 Khanh H. Le. All Rights Reserved. </div> </footer> <d-bibliography src="/assets/bibliography/"></d-bibliography> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> </body> </html>