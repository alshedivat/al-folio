/*!
 * MahjongClientLib - compressed JS
 * @licence MahjongClientLib - v0.0.0 (2020-04-03)
 *  qq:93749937 | Licence: helojo
 */
function loadTable(a){return RES.getRes(a)}var table;!function(a){var b=function(){function a(){}return a.prototype.GetType=function(){return"table.TableCard"},a}();a.TableCard=b}(table||(table={}));var table;!function(a){var b=function(){function a(){}return a.prototype.GetType=function(){return"table.TableGift"},a}();a.TableGift=b}(table||(table={}));var table;!function(a){var b=function(){function a(){}return a.prototype.GetType=function(){return"table.TableMahjongMulti"},a}();a.TableMahjongMulti=b}(table||(table={}));var table;!function(a){var b=function(){function a(){}return a.prototype.GetType=function(){return"table.TablePlayTypeList"},a}();a.TablePlayTypeList=b}(table||(table={}));var table;!function(a){var b=function(){function a(){}return a.prototype.GetType=function(){return"table.TableServerReturnCode"},a}();a.TableServerReturnCode=b}(table||(table={}));var table;!function(a){var b=function(){function a(){}return a.prototype.GetType=function(){return"table.TableVoice"},a}();a.TableVoice=b}(table||(table={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},MJLoadingUI=function(a){function b(){a.call(this),this.init()}return __extends(b,a),b.prototype.init=function(){this.percentTxt=new egret.TextField,this.percentTxt.size=30,this.percentTxt.text="正在加载游戏资源 1%",this.percentTxt.x=(uniLib.Global.screenWidth-this.percentTxt.width)/2,this.percentTxt.y=300,this.addChild(this.percentTxt)},b.prototype.setProgress=function(a){this.percentTxt.text="正在加载游戏资源"+a+"%",this.percentTxt.x=(uniLib.Global.screenWidth-this.percentTxt.width)/2},b}(egret.Sprite),game;!function(a){var b=function(){function b(){}return b.getInstance=function(){return this.instance||(this.instance=new b),this.instance},b.prototype.loadTable=function(){return RES.getRes("TableCard_json")},b.prototype.selectByThisId=function(a){for(var b=0,c=this.loadTable();b<c.length;b++){var d=c[b];if(d.thisId==a)return d}},b.prototype.selectByCardId=function(a){for(var b=0,c=this.loadTable();b<c.length;b++){var d=c[b];if(d.cardId==a)return d}},b.prototype.thisIdToType=function(a){for(var b=0,c=this.loadTable();b<c.length;b++){var d=c[b];if(d.thisId==a)return d.type}},b.prototype.thisIdToIcon=function(a){for(var b=0,c=this.loadTable();b<c.length;b++){var d=c[b];if(d.thisId==a)return d.icon}},b.prototype.thisIdToCardId=function(a){for(var b=0,c=this.loadTable();b<c.length;b++){var d=c[b];if(d.thisId==a)return d.cardId}},b.prototype.resSoundGift=function(a){var b="GiftSound"+a+"_mp3";return RES.hasRes(b)?b:""},b.prototype.resSound=function(b,c){var d=this.thisIdToIcon(b);0==d&&(d=this.thisIdToCardId(b));var e="voice_"+a.RoomInfo.getInstance().languageMode+"_"+c+"_"+d+"_mp3",f=Math.floor(10*Math.random())%a.RoomInfo.getInstance().soundRandomNum,g="voice_"+a.RoomInfo.getInstance().languageMode+"_"+c+"_"+d+"_0_mp3",h="voice_"+a.RoomInfo.getInstance().languageMode+"_"+c+"_"+d+"_"+f+"_mp3";return RES.hasRes(h)?h:RES.hasRes(g)?g:RES.hasRes(e)?e:""},b.prototype.resNormal=function(a){var b,c=this.thisIdToIcon(a);return b=0!=c?c.toString():a.toString(),"Card_1_"+b.charAt(0)+"_"+b.charAt(1)},b.prototype.flowerRes=function(a){var b=this.thisIdToCardId(a).toString();return"flower_"+b.charAt(0)+"_"+b.charAt(1)},b}();a.TableCardConfig=b;var c=function(){function b(){}return b.getInstance=function(){return this.instance||(this.instance=new b),this.instance},b.prototype.loadTable=function(){return RES.getRes("TableMahjongMulti_json")},b.prototype.selectNameById=function(b){for(var c=0,d=this.loadTable();c<d.length;c++){var e=d[c];if(e.gameId==a.RoomInfo.getInstance().gameId&&e.id==b)return e.name}return""},b.prototype.selectCartoonById=function(b){for(var c=0,d=this.loadTable();c<d.length;c++){var e=d[c];if(e.gameId==a.RoomInfo.getInstance().gameId&&e.id==b)return e.cartoon}return""},b.prototype.selectItemById=function(a){for(var b=0,c=this.loadTable();b<c.length;b++){var d=c[b];if(d.id==a&&d.gameId==uniLib.Global.gameId)return d}return null},b}();a.TableMultiConfig=c;var d=function(){function a(){}return a.getInstance=function(){return this.instance||(this.instance=new a),this.instance},a.prototype.loadTable=function(){return RES.getRes("TableGift_json")},a}();a.TableGiftConfig=d;var e=function(){function a(){}return a.getInstance=function(){return this.instance||(this.instance=new a),this.instance},a.prototype.loadTable=function(){return RES.getRes("TablePlayTypeList_json")},a.prototype.getPlayTypeDes=function(a){for(var b=0,c=this.loadTable();b<c.length;b++){var d=c[b];if(d.id==a)return d.desc}return""},a}();a.TablePlayTypeList=e}(game||(game={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(b){function c(){b.call(this),this.initUI()}return __extends(c,b),c.prototype.initUI=function(){},c.prototype.destory=function(){a.ResUtil.removeFromParent(this),a.ResUtil.removeAllChildren(this),table.TableMahjongMulti.$instance=null},c}(egret.DisplayObjectContainer);a.BaseVc=b}(game||(game={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(b){function c(a){b.call(this),this.initBg(a)}return __extends(c,b),c.prototype.initBg=function(b){this._initY=-13,1==b?(this._bg=a.ResUtil.createBitmapByName("msgPanel"),this._bg.scale9Grid=new egret.Rectangle(450,110,60,80)):(this._bg=a.ResUtil.createBitmapByName("msgBoxBg"),this._bg.scale9Grid=new egret.Rectangle(180,60,90,60)),this._bg.touchEnabled=!0,this._bg.width=577,this._bg.height=482-this._initY,this._bg.y=this._initY,this.addChild(this._bg),this._closeBtn=new a.GameButton(["userInfo_close1","userInfo_close2"]),this._closeBtn.x=this._bg.width-61,this._closeBtn.y=-20,this.addChild(this._closeBtn),this._closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandle,this),this.initPanel()},c.prototype.initPanel=function(){},c.prototype.hideClose=function(){this._closeBtn.visible=!1},Object.defineProperty(c.prototype,"title",{set:function(b){this._title||(this._title=a.ResUtil.createBitmapByName(b),this._title.x=Math.round((157-this._title.width)/2),this._title.y=14,this.addChild(this._title))},enumerable:!0,configurable:!0}),c.prototype.setSize=function(a,b){this._bg.width=a,this._bg.height=b-this._initY,this._closeBtn.x=this._bg.width-61},c.prototype.closeHandle=function(b){this.dispatchEventWith(a.UIEventConsts.CLOSE)},c.prototype.destory=function(){b.prototype.destory.call(this),this._closeBtn&&(this._closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.closeHandle,this),this._closeBtn=null),this._bg=null,this._title=null},c}(a.BaseVc);a.BasePanel=b}(game||(game={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(b){function c(a,c,d){void 0===c&&(c=null),void 0===d&&(d=!0),b.call(this),this.srcArr=a,this._label=c,this._autoDestory=d,this.initUI(),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this)}return __extends(c,b),c.prototype.iconTexture=function(b){this.srcArr=b,this._icon.texture=a.ResUtil.createTexture(b[0])},c.prototype.onRemove=function(a){this._autoDestory&&this.destory()},c.prototype.initUI=function(){var b;b=this.srcArr[0],this.touchEnabled=!0,this.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),this._icon?this._icon.texture=a.ResUtil.createTexture(b):(this._icon=a.ResUtil.createBitmapByName(b),this.addChild(this._icon)),this._label&&(this._labelTxt=a.ResUtil.createTextFeild(16777215,egret.HorizontalAlign.CENTER,this._label,25,0,8,this._icon.width),this.addChild(this._labelTxt))},c.prototype.onTouchBegin=function(b){this._icon.texture=a.ResUtil.createTexture(this.srcArr[1]),egret.MainContext.instance.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this)},c.prototype.onTouchEnd=function(b){egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this._icon.texture=a.ResUtil.createTexture(this.srcArr[0])},Object.defineProperty(c.prototype,"iconWdith",{set:function(a){this._icon.width=a},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"iconHeight",{set:function(a){this._icon.height=a},enumerable:!0,configurable:!0}),c.prototype.addClickArea=function(a){this._area||(this._area=new egret.Sprite,this._area.touchEnabled=!0,this.addChild(this._area)),this._area.graphics.clear(),this._area.graphics.beginFill(16711680,0),this._area.graphics.drawRect(-a,-a,this._icon.width+2*a,this._icon.height+2*a),this._area.graphics.endFill()},c.prototype.destory=function(){this.touchEnabled=!1,egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.onTouchEnd,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.onRemove,this),this.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.onTouchBegin,this),a.ResUtil.removeFromParent(this),a.ResUtil.removeAllChildren(this),this._area=null,this._icon=null,this._label=null,this._labelTxt=null},c}(egret.Sprite);a.GameButton=b}(game||(game={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},ui;!function(a){var b=function(b){function c(a){b.call(this),this._source=null,a&&(this.source=a)}return __extends(c,b),Object.defineProperty(c.prototype,"source",{get:function(){return this._source},set:function(a){a!=this._source&&(this._source=a,this.parseSource())},enumerable:!0,configurable:!0}),c.prototype.parseSource=function(){var b=this._source;b&&"string"==typeof b?a.ResUtil.getAsset(this._source,this.contentChanged,this):this.$setBitmapData(b)},c.prototype.contentChanged=function(a,b){b===this._source&&egret.is(a,"egret.Texture")&&(this.$setBitmapData(a),a?this.dispatchEventWith(egret.Event.COMPLETE):DEBUG&&egret.$warn(2301,b))},c}(egret.Bitmap);a.Image=b}(ui||(ui={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(b){function c(){b.call(this),this.initUI()}return __extends(c,b),c.prototype.initUI=function(){this._bg=a.ResUtil.createBitmapByName("tipsBg"),this._bg.width=1.2*this._bg.width,this._bg.height=1.2*this._bg.height,this.addChild(this._bg),this._text=a.ResUtil.createTextFeild(16777215,egret.HorizontalAlign.CENTER,"",30,88,10,786),this._text.multiline=!0,this.addChild(this._text)},c.prototype.setText=function(b){b&&(this._text.text=b,this._bg.height=2*this._text.textHeight,this.x=Math.round((a.DataCache.defaultWidth-this.width)/2),this.y=a.DataCache.defaultHeight,egret.Tween.get(this).to({y:Math.round((a.DataCache.defaultHeight-this.height)/2)-60},500,egret.Ease.circOut).call(this.showDelay,this))},c.prototype.setSingleText=function(b){b&&(this._text.text=b,this._bg.height=2*this._text.textHeight,this.anchorOffsetX=this.width/2,this.anchorOffsetY=this.height/2,this.x=Math.round(a.DataCache.defaultWidth/2),this.y=Math.round(a.DataCache.defaultHeight/2))},c.prototype.showDelay=function(){egret.Tween.get(this).wait(2e3).to({y:-this.height},500,egret.Ease.circOut).call(this.destory,this)},c.prototype.destory=function(){egret.Tween.removeTweens(this),a.ResUtil.removeAllChildren(this),a.ResUtil.removeFromParent(this),this._bg=null,this._text=null},c}(egret.Sprite);a.MildAlertVC=b}(game||(game={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(b){function c(a){b.call(this),this.touchEnabled=!0,this._needClose=a,this.initUI()}return __extends(c,b),c.prototype.initUI=function(){var b=a.ResUtil.createBitmapByName("msgBoxBg");if(b.scale9Grid=new egret.Rectangle(180,60,90,60),b.width=635,b.height=391,this.addChild(b),this.title=a.ResUtil.createTextFeild(4079177,egret.HorizontalAlign.CENTER,"",32,140,18,191),this.info=a.ResUtil.createTextFeild(4079177,egret.HorizontalAlign.CENTER,"",32,110,39,393),this.info.height=200,this.info.verticalAlign=egret.VerticalAlign.MIDDLE,this.info.lineSpacing=2,this.addChild(this.info),this.addChild(this.title),this._needClose){var c=new a.GameButton(["userInfo_close1","userInfo_close2"]);c.x=b.width-61,c.y=-10,c.addClickArea(20),c.touchEnabled=!0,c.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.addChild(c)}},c.prototype.onClose=function(b){a.PopupManager.removePopUp(this),this.destory()},c.prototype.setData=function(b,c,d,e,f,g){if(void 0===d&&(d=null),void 0===e&&(e=null),void 0===f&&(f=null),void 0===g&&(g=0),this._backFn=e,this._backObj=f,this.title.text=b,this.info.text=c,1==d.length){this.yesBtn=new a.GameButton(["button11","button12"]),this.yesBtn.x=Math.round((this.width-this.yesBtn.width)/2),this.yesBtn.y=290,this.addChild(this.yesBtn);var h=a.ResUtil.createBitmapByName("word_sure",65,8);this.yesBtn.addChild(h)}else if(2==d.length){this.yesBtn=new a.GameButton(["button11","button12"]),this.yesBtn.x=336,this.yesBtn.y=290,this.addChild(this.yesBtn);var h=a.ResUtil.createBitmapByName("word_sure",65,8);this.yesBtn.addChild(h),this.noBtn=new a.GameButton(["button21","button22"]),this.noBtn.x=36,this.noBtn.y=290,this.addChild(this.noBtn);var i=a.ResUtil.createBitmapByName("word_cancel",65,8);this.noBtn.addChild(i)}this._backFn&&this._backFn[0]&&this.yesBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._backFn[0],this._backObj),this._backFn&&this._backFn[1]&&this.noBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this._backFn[1],this._backObj),this.yesBtn&&this.yesBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this.noBtn&&this.noBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this)},c.prototype.destory=function(){this.yesBtn&&(this._backFn&&this._backFn[0]&&this.yesBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._backFn[0],this._backObj),this.yesBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),uniLib.DisplayUtils.removeAllChildren(this.yesBtn),uniLib.DisplayUtils.removeFromParent(this.yesBtn),this.yesBtn=null),this.noBtn&&(this.noBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClose,this),this._backFn&&this._backFn[1]&&this.noBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this._backFn[1],this._backObj),uniLib.DisplayUtils.removeAllChildren(this.noBtn),uniLib.DisplayUtils.removeFromParent(this.noBtn),this.noBtn=null),this.title=null,this.info=null,this._backFn=null,this._backObj=null,a.ResUtil.removeFromParent(this),a.ResUtil.removeAllChildren(this)},c}(egret.Sprite);a.MsgBox=b}(game||(game={}));var ui;!function(a){var b=function(){function a(){}return a.getAsset=function(a,b,c){function d(d){b.call(c,d,a)}if(RES.hasRes(a)){var e=RES.getRes(a);e?d(e):RES.getResAsync(a,d,this)}else RES.getResByUrl(a,d,this,RES.ResourceItem.TYPE_IMAGE)},a}();a.ResUtil=b}(ui||(ui={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(a){function b(b,c,d,e){a.call(this),this._textSize=20,this._textColor=9803157,this._strokeColor=5769877,this._textSelectColor=16777215,this.touchEnabled=!0,this.normalImage=new ui.Image(b),this.normalImage.fillMode=egret.BitmapFillMode.SCALE,this.addChild(this.normalImage),c&&(this.downImage=new ui.Image(c),this.downImage.fillMode=egret.BitmapFillMode.SCALE),this._text=d,""!=this._text&&(this._label=new egret.TextField,this._label.fontFamily="微软雅黑",this._label.text=d,this._label.size=20,this._label.width=this.width,this._label.textAlign=egret.HorizontalAlign.CENTER,this.addChild(this._label)),this.name=e}return __extends(b,a),b.prototype.updateSize=function(a,b){void 0===a&&(a=-1),void 0===b&&(b=-1),-1!=a&&(this.width=a,this.normalImage.width=a,this.downImage&&(this.downImage.width=a)),-1!=b&&(this.height=b,this.normalImage.height=b,this.downImage&&(this.downImage.height=b)),this._label&&(this._label.width=this.width,this._label.y=(this.height-this._label.height)/2)},Object.defineProperty(b.prototype,"scale9Grid",{set:function(a){this.normalImage.scale9Grid=a,this.downImage&&(this.downImage.scale9Grid=a)},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"select",{set:function(a){a?(this.downImage&&this.addChildAt(this.downImage,1),this._label&&this.setTextStatus(this._text,this._textSelectColor,this._strokeColor,this._textSize)):(this.downImage&&this.downImage.parent&&this.downImage.parent.removeChild(this.downImage),this._label&&this.setTextStatus(this._text,this._textColor,null,this._textSize))},enumerable:!0,configurable:!0}),b.prototype.setTextColor=function(a,b,c,d){this._textColor=a,this._strokeColor=c,this._textSelectColor=b,this._textSize=d},b.prototype.setTextStatus=function(a,b,c,d){void 0!=c||null!=c?this._label.textFlow=[{text:a,style:{textColor:b,size:d,strokeColor:c,stroke:1}}]:(this._label.text=a,this._label.textFlow=[{text:a,style:{textColor:b,size:d,strokeColor:c,stroke:0}}])},b}(egret.Sprite);a.ToggleButton=b}(game||(game={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(b){function c(){b.call(this),this.isShow=!1,this.actStartPosArr=[new egret.Point((uniLib.Global.screenWidth-1136)/2+866,uniLib.Global.screenHeight-245),new egret.Point(uniLib.Global.screenWidth-170,a.ResUtil.changeYAxis(200)),new egret.Point((uniLib.Global.screenWidth-1136)/2+829,70),new egret.Point(130,280)],this.actStepXArr=[-70,0,-70,0],this.actStepYArr=[0,70,0,70],this.actScale=.5,this.actionSeatBitArr=[[],[],[],[]],this.colorFlilter=new egret.ColorMatrixFilter([.3,.6,0,0,0,.3,.6,0,0,0,.3,.6,0,0,0,0,0,0,1,0]),this.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.destory,this)}return __extends(c,b),Object.defineProperty(c.prototype,"_actionMcStrArr",{get:function(){return this.__actionMcStrArr},set:function(a){this.__actionMcStrArr=a},enumerable:!0,configurable:!0}),Object.defineProperty(c,"instance",{get:function(){return this._instance||(this._instance=new c),this._instance},enumerable:!0,configurable:!0}),c.prototype.initUI=function(){},c.prototype.showAction=function(b,c){if(1==a.RoomInfo.getInstance().video&&c&&!(c.length<1)){this.removeActBySeatId(b),-1==c.indexOf(100)&&c.push(100);for(var d=0;d<c.length;d++){var e=new egret.Bitmap,f=this.addAction(c[d]);e.texture=RES.getRes(f),e.name=c[d]+"",this.actionSeatBitArr[b].push(e),this.addChild(e),e.x=this.actStartPosArr[b].x+d*this.actStepXArr[b],e.y=this.actStartPosArr[b].y+d*this.actStepYArr[b],e.scaleX=e.scaleY=this.actScale}}},c.prototype.removeAllAct=function(){if(this.actionSeatBitArr)for(var a=0;a<this.actionSeatBitArr.length;a++)this.removeActBySeatId(this.actionSeatBitArr[a])},c.prototype.removeActBySeatId=function(a){if(a)for(var b=0;b<a.length;b++){var c=a[b];c&&(c.filters=null,uniLib.DisplayUtils.removeFromParent(c)),c=null}a=[]},c.prototype.showUserOp=function(a,b){if(a>=0){b=0===b?100:b;var c=this.actionSeatBitArr[a];if(c&&c.length>0)for(var d=0;d<c.length;d++){var e=c[d];e.name==b+""?e.scaleX=e.scaleY=this.actScale+.1:e.filters=[this.colorFlilter]}}},c.prototype.addAction=function(a){switch(a){case Cmd.MahjongOpCardType.MahjongOpCardType_Win:return"operate_win1";case Cmd.MahjongOpCardType.MahjongOpCardType_BarOther:case Cmd.MahjongOpCardType.MahjongOpCardType_Bar:case Cmd.MahjongOpCardType.MahjongOpCardType_BarSelf:case Cmd.MahjongOpCardType.MahjongOpCardType_BarTouch:return"operate_kong1";case Cmd.MahjongOpCardType.MahjongOpCardType_Touch:return"operate_pong1";case Cmd.MahjongOpCardType.MahjongOpCardType_Eat:return"operate_eat1";case Cmd.MahjongOpCardType.MahjongOpCardType_Listen:return"operate_listen1";case 100:return"operate_cancel1"}},c.prototype.destory=function(){this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.destory,this),this.removeAllAct(),this.actionSeatBitArr=null,c._instance=null,b.prototype.destory.call(this)},c}(a.BaseVc);a.VideoOpVc=b}(game||(game={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(b){function c(){b.call(this)}return __extends(c,b),c.getInstance=function(){return null==this.instance&&(this.instance=new c),this.instance},c.prototype.initializeController=function(){b.prototype.initializeController.call(this),this.registerCommand(a.MahjongFourFacadeConst.STARTUP,a.StartupMJCommand)},c.prototype.startUp=function(b){this.sendNotification(a.MahjongFourFacadeConst.STARTUP,b)},c}(puremvc.Facade);a.MahJongFourFacede=b}(game||(game={}));var game;!function(a){var b=function(){function a(){}return a.STARTUP="STARTUP",a.SEND_DATA="sendData",a.DESTORY="DESTORY",a.EXIT_GAME="exitGame",a.GM_DELETE="gm_delete",a.GM_HEAP_CARD="gm_heap_card",a.GM_CHANGE_CARD="gm_change_card",a.USER_ENTER_ROOM="user_enter_room",a.PLAYER_ENTER_ROOM="player_enter_room",a.PLAYER_LEFT="player_left",a.PLAYER_LEFT_SEAT="player_left_seat",a.PLAYER_CONNECT="player_connect",a.PLAYER_DISCONNECT="player_disconnect",a.USERINFO_DATA="USERINFO_DATA",a.ReturnIpAndGPS="ReturnIpAndGPS",a.UPDATA_USER_POINT="updata_user_point",a.UPDATA_USER_DATA="updata_user_data",a.RECEIVE_FACE="receive_face",a.SEND_GIFTS_NOTICE="send_gifts_notice",a.NOTIFY_CHAT_RECORD="notify_chat_record",a.VOICE_NOTICE="voice_notice",a.NOTIFY_COMMON_CHAT="notify_common_chat",a.RELOGIN="relogin",a.GAME_START="game_start",a.GAME_SET_BANKER="game_set_banker",a.GAME_START_HORSE="game_start_horse",a.SEND_CARDS="send_cards",a.SELF_HANDCARD_CHANGE="self_handCard_change",a.SELF_OUTCARD_REFRESH="self_outcard_refresh",a.REFRESH_USER_CARDS="refresh_user_cards",a.DRAW="draw",a.ZIDRAW="zidraw",a.DIS_CARD_SUCCESS="dis_card_success",a.EXDRAW="exdraw",a.PONG="pong",a.EX_DRAW_NOTICE="ex_draw_notice",a.DRAW_NOTICE="draw_notice",a.PONG_NOTICE="pong_notice",a.CHOW_NOTICE="chow_notice",a.DISCARD_NOTICE="discard_notice",a.KONG_NOTICE="kong_notice",a.NESTLE_NOTICE="nestle_notice",a.LIFT_NOTICE="lift_notice",a.COMPARE_CARD_NOTICE="compare_card_notice",a.LASTCARD_CHANGE="lastcard_change",a.CHANGE_REMAINDER_COUNT="change_remainder_count",a.SHOW_ACTION="show_action",a.REMOVE_ACTION="remove_action",a.NOTICE_CARD_ENABLE="notice_card_enable",a.SUPPLY_FLOWER_NOTICE="supply_flower_notice",a.TURNGOLD_NOTICE="turngold_notice",a.START_WIN_NOTICE="start_win_notice",a.SELF_DISCARD_NOTICE="self_discard_notice",a.NOTIFY_EAST_LOCATION="notify_east_location",a.NOTIFY_SAME_IP="notify_same_ip",a.NOTIFY_SELECT_GOLDOUT="notify_select_goldout",a.NOTIFY_CANCEL_GOLDOUT="notify_cancel_goldout",a.OUT_CARD_REFRESH="out_card_refresh",a.RESULT_NOTICE="result_notice",a.WIN_MAHJONG_NOTICE="win_mahjong_notice",a.READY_NOTICE="ready_notice",a.CANCEL_READY_NOTICE="cancel_ready_notice",a.READY_SHOW="ready_show",a.RESET_TABLE="reset_table",a.RESET_RESULT_PANEL="reset_result_panel",a.TOTAL_RECORD_DATA="TOTAL_RECORD_DATA",a.DISS_REQUEST_NOTICE="DISS_REQUEST_NOTICE",a.DISS_RESULT_NOTICE="DISS_RESULT_NOTICE",a.DISS_NOTICE="DISS_NOTICE",a.NOTIFY_ONLINE_STATE="notify_online_state",a.NOTIFY_POINT_CHANGE="notify_poing_change",a.STOP_SREVICE_NOTICE="stop_service_notice",a.TOUHE_NOTICE="touhe_notice",a.TOUHE_BROADCAST="tou_broadcast",a.NOTIFY_HOST="notify_host",a.CHANGE_USERNUM_BACK="change_usernum_back",a.CHANGE_USERNUM_NOTICE="change_usernum_notice",a.SHOW_CHANGE_BTN="show_change_btn",a.SHOW_READY_BTN="show_ready_btn",a.CASH_CHICKEN="cash_chicken",a.CHANGE_CARD_BACK="change_card_back",a.USER_CHANGE_CARD_BACK="user_change_card_back",a.CHANGE_HAND_CARD="change_hand_card",a.CHONGFENG_NOTICE="chongfeng_notice",a.EAST_CHANGE="east_change",a.GAME_DINGQEU="game_dingque",a.GAME_DINGQEU_NOTICE="game_dingque_notice",a.GAME_DINGQEU_RECONNET="game_dingque_reconnet",a.GAME_PIAO="game_piao",a.GAME_PIAO_BACK="game_piao_back",a.GAME_SHOW_CARD_BACK="game_show_card_back",a.GAME_YUANQEU="game_yuanque",a.GAME_YUANQUE_NOTICE="game_yuanque_notice",a.GAME_YUANQUE_STAND="game_yuanque_stand",a.GM_CONTROL="gm_control",a.HU_NOTICE="hu_notice",a.LISTEN_NOTICE="listen_notice",a.NOTICE_SHOW_CARD_BRD="notice_show_card_brd",a.SEND_CARDS_OK="send_cards_ok",a.SHOW_HU_NOTICE="show_hu_notice",a.BIRD_BRD="brid_brd",a.KONG_DICE="kong_dice",a.KONG_OUT_CARD="kong_out_card",a.KONG_SEND_CARD="kong_send_card",a.NOTIFY_PING_CHANGE="notify_ping_change",a.OUT_CARD_FAILED="out_card_failed",a.PIAO_NOTICE="piao_notice",a.SEA_ROAM_BRD="sea_roam_brd",a.SEA_ROAM_TURN="sea_roam_turn",a.START_NEW_ROUND="start_new_round",a.START_NEW_ROUND_TIME="start_new_round_time",a.START_NEW_STAND="start_new_stand",a.START_ROUND_NOTICE="start_round_notice",a.START_lISTEN_NOTICE="start_listen_notice",a.lISTEN_CARD_NOTICE="listen_card_notice",a.WIN_CARD_NOTICE="win_card_notice",a.VIDEO_REFRESH_HANDCARD="video_refresh_handcard",a.REFRESH_LISTEN_SCENE="refresh_listen_scene",a.TIMEOUT_WAIT="timeout_wait",a.UPDATA_USER_CHIP="updata_user_chip",a.DZHN_ACTION="DZHN_ACTION",a.SWIM_GOLD="swim_gold",a.GET_GPS="GET_GPS",a.PLAY_BUTTON="play_button",a.PLAY_BUTTON_BRD="PLAY_BUTTON_BRD",a.TWO_MAHJIONG_BACK="two_mahjiong_back",a.TWO_MAHJIONG_DOUBLE="two_mahjiong_double",a.CHECK_CONDITION="check_condition",a.SICHUAN_BANKRUPTCY="sichuan_ruptcy",a.SICHUAN_BANKRUPTCY_BACK="sichuan_ruptcy_back",a.NANCHANG_XIAGOLDCARD_BRD="nanchang_xiagoldcard_brd",a.VOICE_SELECT_OPERATE="voice_select_operate",a.SERVER_MESSAGE_NOTICE="server_message_notice",a.SICHUAN_BUYCARD="sichuan_buycard",a.START_SELECTCARD="start_selectcard",a.SELECT_CARD="select_card",a.ZHANGPU_QITAIZI="ZHANGPU_QITAIZI",a.VIDEO_REQUEST="VIDEO_REQUEST",a.VIDEO_RESULT="VIDEO_RESULT",a.VIDEO_CLOST="VIDEO_CLOST",a.WANZHOU_CHANGECARD="WANZHOU_CHANGECARD",a.WANZHOU_BUYCARD="WANZHOU_BUYCARD",a.WANZHOU_WINDATA="WANZHOU_WINDATA",a.KOU_NOTICE="buckles_notice",a.KOU_WAITLIST="KOU_WAITLIST",a.OTHER_KOU_UPDATE="OTHER_KOU_UPDATE",a.WIND_CARD_NOTICE="WIND_CARD_NOTICE",a.ADD_BASEPOINT_NOTICE="ADD_BASEPOINT_NOTICE",a.SUPERPOSITION_CARD_NOTICE="SUPERPOSITION_CARD_NOTICE",a.SHOW_TURNGOLD_BTN="SHOW_TURNGOLD_BTN",a.CHOISE_TURNGOLD_NOTICE="CHOISE_TURNGOLD_NOTICE",a.SHOW_PASSEGG_NOTICE="SHOW_PASSEGG_NOTICE",a.SET_LAZHUANG_NOTICE="SET_LAZHUANG_NOTICE",a.GAME_LAZHUANG_NOTICE="GAME_LAZHUANG_NOTICE",a.CARD_TYPE_WARN_NOTICE="CARD_TYPE_WARN_NOTICE",a.UPDATE_HUXI="UPDATE_HUXI",a.NOTICE_WIN_GO="NOTICE_WIN_GO",a.ALL_LISTEN_OBJECT="ALL_LISTEN_OBJECT",a.ROUND_SCORE_NOTICE="ROUND_SCORE_NOTICE",a.RETURN_WAIT_WIN="RETURN_WAIT_WIN",a}();a.MahjongFourFacadeConst=b}(game||(game={}));var game;!function(a){var b=function(){function a(){}return a.SUCCESS=0,a.CANCLEOPEARET=1,a.PRIORITY=32,a}();a.NetConsts=b}(game||(game={}));var game;!function(a){var b=function(){function a(){}return a.ZU_JIAN="ZU_JIAN",a.AAA="aaa",a}();a.PlatConsts=b}(game||(game={}));var game;!function(a){var b=function(){function a(){}return a.ACTION="action",a.BG_MUSIC="bg_mp3",a.BIRD="csmj_bird_mp3",a.CLICK="ButtonSound_mp3",a.COMMON="common",a.COUNT_FAN="CountFanSound_mp3",a.DEAL="DealSound_mp3",a.DICE="DiceSound_mp3",a.DISCARD="DiscardSound_mp3",a.DRAW="DrawSound_mp3",a.DRAW_MY_TURN="myTurn_mp3",a.DRAW_OTHER_TURN="otherTurn_mp3",a.HU_MUSIC="hu_music_mp3",a.JIANPAO="9",a.LIGHT="light_mp3",a.LIUJU="liuju_mp3",a.LOSE="lose_mp3",a.SEND_CARD="sendcard_mp3",a.START="Start_mp3",a.TOUCH_SOUND="ButtonSound_mp3",a.WIN="win_mp3",a.ZIMO="1",a}();a.SoundConsts=b}(game||(game={}));var game;!function(a){var b=function(){function a(){}return a.EXIT_GAME="exit_game",a.SHOW_BANKER="SHOW_BANKER",a.ACTION_DISCARD="action_discard",a.ACTION_CANCEL="action_cancel",a.ACTION_WIN="action_win",a.ACTION_READYHAND="action_readyhand",a.ACTION_CHOW="action_chow",a.ACTION_BEGIN_CHOW="action_begin_chow",a.ACTION_STOP_CHOW="action_stop_chow",a.ACTION_STOP_GOLD="action_stop_gold",a.ACTION_PONG="action_pong",a.ACTION_KONG="action_kong",a.ACTION_BEGIN_KONG="action_begin_kong",a.ACTION_TRUSTEESHIP="action_trusteeship",a.ACTION_RECORD="action_record",a.START_READYHAND="start_readyhand",a.ARROW_READYHAND="arrow_readyhand",a.STOP_ARROW_READYHAND="stop_arrow_readyhand",a.STOP_READYHAND="stop_readyhand",a.READY="ready",a.GET_SCORE_DATA="GET_SCORE_DATA",a.SHOW_USER_INFO="SHOW_USER_INFO",a.GIFT_SEND="GIFT_SEND",a.CLOSE="CLOSE",a.DESTORY="DESTORY",a.SHOW_DISMISS="show_dismiss",a.SHOW_SETTING="SHOW_SETTING",a.SHOW_HELP="SHOW_HELP",a.SHOW_STOP_SERVICE="SHOW_STOP_SERVICE",a.SHOW_GM_Tool="SHOW_GM_CHAT",a.REQUEST_CHANGE_USERNUM="request_change_usernum",a.AGREE_CHANGE_USERNUM="agree_change_usernum",a.SHOW_SHORT_CHAT="SHOW_SHORT_CHAT",a.ACTION_OPERATE="action_operate",a.DISMISS_GAME="DISMISS_GAME",a.DISMISS_BACK="DISMISS_BACK",a.SHARE_GAME="share_game",a.CHANGE_TABLECLOTH="CHANGE_TABLECLOTH",a.RECORD_TIME_OUT="RECORD_TIME_OUT",a.RECORD_CANCEL="RECORD_CANCEL",a.SEND_RECORD="SEND_RECORD",a.SHOW_GPS="SHOW_GPS",a.SEND_COMMON_CHAT="send_common_chat",a.SEND_COMMON_TALK="send_common_talk",a.SEND_CHAT_RECORD="send_chat_record",a.GM_SELECT_HANDCARD="gm_select_handcard",a.GM_SELECT_HEAPCARD="gm_select_heapcard",a.GM_SELECT_CARDS="gm_select_cards",a.REMOVE_READYHAND="remove_readyhand",a.ACTION_HOST="action_host",a.USER_DODISCARD="user_dodiscard",a.USER_DODISCARD_FAIL="user_dodiscard_fail",a.VIDEO_BACK="video_back",a.VIDEO_STOP="video_stop",a.VIDEO_ADVANCE="video_advance",a.VIDEO_CLOSE="video_close",a.SICHUAN_CHANGECARD="sichuan_changecard",a.DING_QUE="ding_que",a.YUAN_QUE="yuan_que",a.ACTION_LIANG="action_liang",a.ACTION_NOAN_LIANG="action_noan_liang",a.ACTION_SELECT_AN="action_select_an",a.USER_KNOCK_TURN="user_knock_turn",a.ACTION_BEGIN_PONG="action_begin_pong",a.ACTION_BU="action_bu",a.CARD_ADD_MASK="card_add_mask",a.SEND_PIAO_REQUEST="send_piao_request",a.START_READY="start_ready",a.EXCHANGE_DESK="exchange_desk",a.SHOW_OUTCARD="show_outcard",a.ACTION_LISTEN="listen",a.ACTION_BAODIAO="action_baodiao",a.ACTION_BAOJIA="action_baojia",a.ACTION_ZHANLIBAODIAO="action_zhanlibaodiao",a.ACTION_ZHANLIBAOJIA="action_zhanlibaojia",a.ACTION_ZHANLIBAOTING="action_zhanlibaoting",a.SHARE_HAOCAI_MJ="share_haocai_mj",a.D25_MAHJONGUP_END="d25_mahjongup_end",a.GOLD_EFFECT_END="gold_effect_end",a.GD_CANCEL_BAO="gd_cancel_bao",a.SICHUAN_BUYCARD="sichuan_buycard",a.ACTION_YAOBAO="action_yaobao",a.SET_WINDCARD="set_windcard",a.ADD_BASE_POINT="add_base_point",a.START_EFFECT_OVER="start_effect_over",a}();a.UIEventConsts=b}(game||(game={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.execute=function(b){var d=this.facade.retrieveProxy(a.ServerMJProxy.NAME);switch(a.ResUtil.trace("execute:",b.getType()),b.getType()){case c.GAME_DATA:if(1==a.RoomInfo.getInstance().video)return;d.sendData(b.getBody());break;case c.CONNECT_GAME_SERVER:d.initServer();break;case c.CLOSE:d.closeSocket()}},c.GAME_DATA="game_data",c.CONNECT_GAME_SERVER="connect_game_server",c.CLOSE="close",c}(puremvc.SimpleCommand);a.DataRequestCommand=b}(game||(game={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.execute=function(a){a.getBody();this.removeMediator(),this.removeController(),this.removeProxy()},c.prototype.removeController=function(){this.facade.removeCommand(a.MahjongFourFacadeConst.SEND_DATA),this.facade.removeCommand(a.MahjongFourFacadeConst.DESTORY)},c.prototype.removeMediator=function(){if(a.GameViewConfig.mainMediator){var b=uniLib.getDefinitionByName(a.GameViewConfig.mainMediatorName);a.MahJongFourFacede.getInstance().removeMediator(b.NAME),a.GameViewConfig.mainMediator=null,a.GameViewConfig.mainMediatorName=null}a.RoomInfo.getInstance().isStart&&(a.RoomInfo.getInstance().isStart=!1),table.TableMahjongMulti.$instance=null,a.RoomInfo.getInstance().handCardNum=13,a.RoomInfo.getInstance().soundRandomNum=3},c.prototype.removeProxy=function(){this.facade.removeProxy(a.ServerMJProxy.NAME),this.facade=null,puremvc.Facade.instance=null,a.MahJongFourFacede.instance=null},c}(puremvc.MacroCommand);a.RemoveCommand=b}(game||(game={}));var Cmd;!function(a){function b(a,b,c){game.MahJongFourFacede.getInstance().sendNotification(a,b,c)}function c(a){null!=uniLib.Global.lastPingUpTimestamp&&(uniLib.Global.lastPing=Date.now()-uniLib.Global.lastPingUpTimestamp,uniLib.Global.lastPingUpTimestamp=null)}function d(a){function b(){uniLib.ZQGameSdk.openWeb(d,uniLib.WEBMODEL.EXPLORER)}if(a.type||(a.type=0),1==a.type&&uniLib.Utils.restart(a.desc?a.desc:"版本更新,需要重启!",a.btn1?a.btn1:"确定"),a.url&&uniLib.Utils.isIOS()){var c=new MJLobby.LobbyMsgBox(!0),d=a.url;c.setData("温馨提示",a.desc,["确定","取消"],[b]),uniLib.PopUpMgr.addPopUp(c,null,!0)}}function e(c){if(uniLib.UIMgr.instance.hideLoading(),game.RoomInfo.getInstance().vistor=c.visitor,1!=game.RoomInfo.getInstance().video||(game.RoomInfo.getInstance().curNumber=MJLobby.MJLobbyData.getInstance().videoCurGameNbr,game.RoomInfo.getInstance().totalNumber=MJLobby.MJLobbyData.getInstance().videoGameNbr,game.RoomInfo.getInstance().playerNumber=MJLobby.MJLobbyData.getInstance().videoUserNbr,game.DataCache.platParam.roomId=MJLobby.MJLobbyData.getInstance().videoRoomId,!game.RoomInfo.getInstance().isStart)){if(game.CardInfo.getInstance().initHandCard(),c.resultCode||(c.resultCode=0),c.resultCode==game.NetConsts.SUCCESS){var d=c.roomState;game.RoomInfo.getInstance().setData(d),game.RoomInfo.getInstance().houseOwnerUID=c.ownerId,game.RoomInfo.getInstance().matchId=c.roomState.matchId,game.DataCache.gameInfo&&game.DataCache.gameInfo.zoneInfo&&game.DataCache.gameInfo.zoneInfo.gameid&&game.DataCache.gameInfo.zoneInfo.gameid>0&&(game.RoomInfo.getInstance().gameId=game.DataCache.gameInfo.zoneInfo.gameid);for(var e=!1,f=0;f<d.userInfoSet.length;f++)if(d.userInfoSet[f].uid==uniLib.NetMgr.UID&&(uniLib.UserInfo.init(d.userInfoSet[f]),game.MyUserInfo.getInstance().setData(d.userInfoSet[f]),d.userInfoSet[f].onlineState==a.OnlineState.OnlineState_Hosting?game.RoomInfo.getInstance().isHostMode=1:game.RoomInfo.getInstance().isHostMode=0,1==d.userInfoSet[f].isNew?game.RoomInfo.getInstance().isNewIn=!0:game.RoomInfo.getInstance().isNewIn=!1,e=!0,d.userInfoSet[f].lat&&d.userInfoSet[f].lng)){var g=new a.ClientGpsLobbyCmd_S;g.lat=d.userInfoSet[f].lat,g.lng=d.userInfoSet[f].lng,MJLobby.MJLobbyData.getInstance().setGpsPosition(g)}if(0==e){var h=game.RoomInfo.getInstance().getUserIdBySid(1);0!=h&&(uniLib.UserInfo.uid=h)}game.DataCache.platParam||(game.DataCache.platParam={}),1==game.RoomInfo.getInstance().video&&(uniLib.UserInfo.uid=game.RoomInfo.getInstance().videoUid),game.RoomInfo.getInstance().firstReady=!0,game.CardInfo.getInstance().reloginUserHandCard(),game.RoomInfo.getInstance().isStart=!1,game.RoomInfo.getInstance().RoomSocreType=0,game.RoomInfo.getInstance().roundScore=[],c.roomState.gambletype&&(game.RoomInfo.getInstance().RoomSocreType=c.roomState.gambletype,game.RoomInfo.getInstance().baseSore=c.roomState.betchips),c.greatWall&&(game.RoomInfo.getInstance().greatWall=c.greatWall),game.DataCache.platParam.roomId=d.roomId;egret.getDefinitionByName("MJLobby")&&d.roomId>=1e6&&(1017==MJLobby.MJLobbyData.getInstance().lobbyId||1003==MJLobby.MJLobbyData.getInstance().lobbyId)&&uniLib.SoundMgr.instance.playSound("match2Room_mp3"),b(game.MahjongFourFacadeConst.RESET_TABLE),b(game.MahjongFourFacadeConst.USER_ENTER_ROOM,d),b(game.MahjongFourFacadeConst.READY_SHOW),"1"==egret.localStorage.getItem("show_SSC")&&uniLib.Global.dispatchEvent(uniLib.ZqEvent.EVENT_G2L,"show_SSC")}else b(game.MahjongFourFacadeConst.EXIT_GAME);null!=uniLib.Global.lastPingUpTimestamp&&(uniLib.Global.lastPing=Date.now()-uniLib.Global.lastPingUpTimestamp,uniLib.Global.lastPingUpTimestamp=null)}}function f(a){a.los&&b(game.MahjongFourFacadeConst.REFRESH_LISTEN_SCENE,a)}function g(a){a.msglist?(uniLib.Global.jsonCompress=a,uniLib.Global.jsonCompressDefault=a):uniLib.Global.jsonCompress=uniLib.Global.jsonCompressDefault}function h(a){if(!a.ownerid||a.ownerid==game.RoomInfo.getInstance().videoUid){a.isFirst||(a.isFirst=!0);var c=new game.UserVo(a.userInfo);game.RoomInfo.getInstance().addUser(c),a.isFirst?b(game.MahjongFourFacadeConst.PLAYER_ENTER_ROOM,c):b(game.MahjongFourFacadeConst.PLAYER_CONNECT,c)}}function i(a){if(null!=uniLib.Global.lastPingUpTimestamp&&(uniLib.Global.lastPing=Date.now()-uniLib.Global.lastPingUpTimestamp,uniLib.Global.lastPingUpTimestamp=null),a.resultCode||(a.resultCode=0),a.desc||(a.desc="成功"),a.uid==uniLib.UserInfo.uid)return game.VideoOpVc.instance.isShow=!1,void b(game.MahjongFourFacadeConst.EXIT_GAME);if(0!=a.state)b(game.MahjongFourFacadeConst.PLAYER_DISCONNECT,a);else if(0==a.state){var c=game.RoomInfo.getInstance().getSeatNoByUserId(a.uid);b(game.MahjongFourFacadeConst.PLAYER_LEFT_SEAT,c),game.RoomInfo.getInstance().removeUser(a.uid),b(game.MahjongFourFacadeConst.PLAYER_LEFT,a.uid)}}function j(a){game.RoomInfo.getInstance().isHu=!1,game.RoomInfo.getInstance().isStart=!0,game.RoomInfo.getInstance().isKnock=!1,game.RoomInfo.getInstance().isTween=!1,game.RoomInfo.getInstance().lieNum=1,game.RoomInfo.getInstance().dirtection=1,game.RoomInfo.getInstance().turnGoldType=1,game.RoomInfo.getInstance().host_mode=0,game.RoomInfo.getInstance().liangUser=[],game.RoomInfo.getInstance().goldenCard=[],game.RoomInfo.getInstance().chongfengUID=0,game.RoomInfo.getInstance().curNumber=a.curGameNbr,game.RoomInfo.getInstance().setRemainCardNum(0),game.RoomInfo.getInstance().setRemainderCardCount(0),game.CardInfo.getInstance().initHandCard(),game.GameData.getInstance().goldOutCardSet=[],game.RoomInfo.getInstance().outCardSuccArr=[],game.CardInfo.getInstance().bankerThisId=0,game.RoomInfo.getInstance().initRoundScore(),a.bankerNum?game.RoomInfo.getInstance().bankerNum=a.bankerNum:game.RoomInfo.getInstance().bankerNum=0,a.betPoint?game.RoomInfo.getInstance().betPoint=a.betPoint:game.RoomInfo.getInstance().betPoint=0,a.gate&&(game.RoomInfo.getInstance().gate=a.gate),a.circle&&(game.RoomInfo.getInstance().circle=a.circle),void 0!==a.is_double&&(game.RoomInfo.getInstance().isdouble=a.is_double),a.curJiao&&(game.RoomInfo.getInstance().curJiao=a.curJiao),a.curNbr&&(game.RoomInfo.getInstance().curRound=a.curNbr),b(game.MahjongFourFacadeConst.GAME_START,a)}function k(a){a.sec||0==a.sec?game.RoomInfo.getInstance().outCount=a.sec:game.RoomInfo.getInstance().outCount=game.RoomInfo.getInstance().defaultOutCount,b(game.MahjongFourFacadeConst.GAME_PIAO,a)}function l(a){game.RoomInfo.getInstance().lastShangGa=a.multiPiao}function m(a){a.uid==uniLib.UserInfo.uid&&b(game.MahjongFourFacadeConst.GAME_PIAO_BACK,a.multiPiao),b(game.MahjongFourFacadeConst.PIAO_NOTICE,a)}function n(a){game.RoomInfo.getInstance().setBankerInfo(a.bankerId),game.RoomInfo.getInstance().outerId=a.bankerId,game.RoomInfo.getInstance().chongfengUID=0,game.RoomInfo.getInstance().firstReady=!0,game.RoomInfo.getInstance().multi=a.multi,a.horseUid&&b(game.MahjongFourFacadeConst.GAME_START_HORSE,a.horseUid),a.eastUid&&(game.RoomInfo.getInstance().eastUid=a.eastUid,b(game.MahjongFourFacadeConst.NOTIFY_EAST_LOCATION)),(a.sec||0==a.sec)&&(a.sec||0==a.sec?game.RoomInfo.getInstance().outCount=a.sec:game.RoomInfo.getInstance().outCount=game.RoomInfo.getInstance().defaultOutCount,game.RoomInfo.getInstance().diceTime=a.sec),a.startLuo&&(game.RoomInfo.getInstance().startLuo=a.startLuo),a.getCardDirection&&(game.RoomInfo.getInstance().getCardDirection=a.getCardDirection),b(game.MahjongFourFacadeConst.GAME_SET_BANKER,a.dice)}function o(a){if(this.last_SendCardMahjong=null,this.last_OutCardMahjong=null,game.RoomInfo.getInstance().showCardThisIdMap||(game.RoomInfo.getInstance().showCardThisIdMap={}),game.RoomInfo.getInstance().showCardBaseIdMap||(game.RoomInfo.getInstance().showCardBaseIdMap={}),game.RoomInfo.getInstance().shuffleUid=a.shuffleUid,a.ownerid&&a.ownerid!=game.RoomInfo.getInstance().videoUid)game.CardInfo.getInstance().setOtherCard([a.userCard]);else{if(a.userCard&&(game.CardInfo.getInstance().myCards=a.userCard,a.userCard.handCardSet&&a.userCard.handCardSet instanceof Array&&game.CardInfo.getInstance().searchFlower(a.userCard.handCardSet)&&(game.GameData.getInstance().isMyTime=!1)),game.RoomInfo.getInstance().chongfengUID=0,game.RoomInfo.getInstance().zhuojiID=0,game.RoomInfo.getInstance().dqCardType=0,game.RoomInfo.getInstance().isMask=!1,game.RoomInfo.getInstance().isListen=!1,game.RoomInfo.getInstance().isYuanQue=!1,game.RoomInfo.getInstance().selfWin=!1,game.RoomInfo.getInstance().changeType=[],game.RoomInfo.getInstance()._flbarUser=[],game.CardInfo.getInstance().isStartSend=!0,a.bankerThisId&&(game.CardInfo.getInstance().bankerThisId=a.bankerThisId),a.otherCard&&game.CardInfo.getInstance().setOtherCard(a.otherCard),game.CardInfo.getInstance().userHandCount=[13,13,13,13],4036==game.RoomInfo.getInstance().gameId||4037==game.RoomInfo.getInstance().gameId||4077==game.RoomInfo.getInstance().gameId||4104==game.RoomInfo.getInstance().gameId||4088==game.RoomInfo.getInstance().gameId||4031==game.RoomInfo.getInstance().gameId||4105==game.RoomInfo.getInstance().gameId||4122==game.RoomInfo.getInstance().gameId||4123==game.RoomInfo.getInstance().gameId||16==game.RoomInfo.getInstance().handCardNum)game.CardInfo.getInstance().userHandCount=[16,16,16,16];else if(13!=game.RoomInfo.getInstance().handCardNum){var c=game.RoomInfo.getInstance().handCardNum+1;game.CardInfo.getInstance().userHandCount=[c,c,c,c]}game.RoomInfo.getInstance().bGetNum=game.RoomInfo.getInstance().userList.length*game.CardInfo.getInstance().userHandCount[0],game.CardInfo.getInstance().updateUserHandCount(game.RoomInfo.getInstance().bankerId,1,0),a.sec||0==a.sec?game.RoomInfo.getInstance().outCount=a.sec:game.RoomInfo.getInstance().outCount=game.RoomInfo.getInstance().defaultOutCount,game.RoomInfo.getInstance()._flbarUser=a.flbarUser,game.RoomInfo.getInstance().isTween=!0,game.RoomInfo.getInstance().setRemainCardNum(a.heapCardNum),a.heapCardNum?game.RoomInfo.getInstance().setRemainderCardCount(a.heapCardNum):game.RoomInfo.getInstance().setRemainderCardCount(0),b(game.MahjongFourFacadeConst.SEND_CARDS,a.ownerid),game.RoomInfo.getInstance().isStart=!0}}function p(a){b(game.MahjongFourFacadeConst.SHOW_ACTION,a)}function q(a){b(game.MahjongFourFacadeConst.START_NEW_ROUND,a),a.uid==uniLib.UserInfo.uid&&b(game.MahjongFourFacadeConst.REMOVE_ACTION),a.cardSet&&game.RoomInfo.getInstance().addShowCardList(a.cardSet)}function r(a){a.ownerid&&a.ownerid!=game.RoomInfo.getInstance().videoUid||(game.RoomInfo.getInstance().changeType=a.disType,game.RoomInfo.getInstance().outCount=a.opcount,game.RoomInfo.getInstance().changeHandCard=!0,game.CardInfo.getInstance().exCardSet=[],a.bankerId&&(game.RoomInfo.getInstance().bankerId=a.bankerId,game.RoomInfo.getInstance().setBankerInfo(a.bankerId)),a.bcs&&(game.RoomInfo.getInstance().sc_bcs=a.bcs),a.isSame&&(game.RoomInfo.getInstance().sc_isSame=a.isSame),b(game.MahjongFourFacadeConst.NOTICE_CARD_ENABLE,!0),b(game.MahjongFourFacadeConst.CHANGE_HAND_CARD,1))}function s(a){if(a.userId==uniLib.UserInfo.uid)game.RoomInfo.getInstance().exCardSuccArr=[],a.cardId&&(game.RoomInfo.getInstance().exCardSuccArr=a.cardId),game.RoomInfo.getInstance().changeType=[],b(game.MahjongFourFacadeConst.CHANGE_CARD_BACK,a),a.userId===uniLib.UserInfo.uid?(b(game.MahjongFourFacadeConst.NOTICE_CARD_ENABLE,!1),game.RoomInfo.getInstance().changeHandCard=!1):b(game.MahjongFourFacadeConst.NOTICE_CARD_ENABLE,!0);else{if(a.cardId){for(var c=0;c<a.cardId.length;c++){var d=a.cardId[c];game.CardInfo.getInstance().deleteOtherHand(d,a.userId)}game.CardInfo.getInstance().updateUserHandCount(a.userId,a.cardId.length,1)}b(game.MahjongFourFacadeConst.USER_CHANGE_CARD_BACK,a)}}function t(a){var c={};c.opType=[23],b(game.MahjongFourFacadeConst.SHOW_ACTION,c),b(game.MahjongFourFacadeConst.NOTICE_CARD_ENABLE,!1)}function u(a){a.sec||0==a.sec?game.RoomInfo.getInstance().outCount=a.sec:game.RoomInfo.getInstance().outCount=game.RoomInfo.getInstance().defaultOutCount,b(game.MahjongFourFacadeConst.GAME_YUANQEU)}function v(a){b(game.MahjongFourFacadeConst.GAME_YUANQUE_NOTICE,a),a.uid==uniLib.UserInfo.uid&&(b(game.MahjongFourFacadeConst.REMOVE_ACTION),game.RoomInfo.getInstance().isYuanQue=!0)}function w(a){a.ownerid&&a.ownerid!=uniLib.UserInfo.uid||(game.RoomInfo.getInstance().dqCardType=a.cardType,a.sec||0==a.sec?game.RoomInfo.getInstance().outCount=a.sec:game.RoomInfo.getInstance().outCount=game.RoomInfo.getInstance().defaultOutCount,a.bankerId&&(game.RoomInfo.getInstance().bankerId=a.bankerId,game.RoomInfo.getInstance().setBankerInfo(a.bankerId)),game.RoomInfo.getInstance().changeType=[],b(game.MahjongFourFacadeConst.GAME_DINGQEU))}function x(a){a.uid==uniLib.UserInfo.uid&&(game.RoomInfo.getInstance().dqCardType=a.cardType,game.RoomInfo.getInstance().isMask=!0),game.RoomInfo.getInstance().changeType=[],b(game.MahjongFourFacadeConst.GAME_DINGQEU_NOTICE,a)}function y(a){a.hn&&(a.heapCardNum=a.hn),game.RoomInfo.getInstance().flcard=[],a.rfc&&(a.randomFlowerCard=a.rfc,game.RoomInfo.getInstance().addFlowerCard(a.randomFlowerCard)),a.cardSet?(game.RoomInfo.getInstance().goldenCard=a.cardSet,a.goldType&&(1==a.goldType?game.RoomInfo.getInstance().addShowCardList(a.cardSet):3==a.goldType&&game.RoomInfo.getInstance().addShowCardList(a.displayCardSet))):game.RoomInfo.getInstance().goldenCard=[],a.displayCardSet&&(game.RoomInfo.getInstance().displayCard=a.displayCardSet),a.cardNum?(game.RoomInfo.getInstance().goldCardNum=a.cardNum,game.RoomInfo.getInstance().eGetNum=game.RoomInfo.getInstance().eGetNum+a.cardNum):game.RoomInfo.getInstance().goldCardNum=0,b(game.MahjongFourFacadeConst.TURNGOLD_NOTICE),game.RoomInfo.getInstance().setRemainCardNum(a.heapCardNum),a.heapCardNum?game.RoomInfo.getInstance().setRemainderCardCount(a.heapCardNum):game.RoomInfo.getInstance().setRemainderCardCount(0),b(game.MahjongFourFacadeConst.SELF_HANDCARD_CHANGE),b(game.MahjongFourFacadeConst.NOTICE_CARD_ENABLE,!1)}function z(c){a.trace("补花：FlowerMahjongCmd_Brd "+JSON.stringify(c)),c.hn&&(c.heapCardNum=c.hn);var d=!1,e=c.flowerSet,f=game.CardInfo.getInstance().getFlowerCardBySeat(0);if(c.uid==uniLib.UserInfo.uid)if(c.myCardSet){for(var g=0;g<e.length;g++)0==(d=ArrayUtil.isInArray(e[g],f))&&(game.CardInfo.getInstance().addFlowerCardByUid(e[g],c.uid),game.CardInfo.getInstance().removeMyCard(e[g]));for(var h=c.myCardSet,i=0;i<h.length;i++)game.RoomInfo.getInstance().bGetNum++,game.CardInfo.getInstance().addMyCard(h[i],!0)}else for(var g=0;g<e.length;g++)0==(d=ArrayUtil.isInArray(e[g],f))&&game.CardInfo.getInstance().addFlowerCardByUid(e[g],c.uid);else{for(var g=0;g<e.length;g++){var j=game.RoomInfo.getInstance().getSeatNoByUserId(c.uid),k=game.CardInfo.getInstance().getFlowerCardBySeat(j);d=ArrayUtil.isInArray(e[g],k),0==d&&(game.CardInfo.getInstance().addFlowerCardByUid(e[g],c.uid),game.RoomInfo.getInstance().GM_Mode&&c.uid!=uniLib.UserInfo.uid&&game.CardInfo.getInstance().deleteOtherHand(e[g],c.uid)),c.startRound&&game.RoomInfo.getInstance().bGetNum++}if(game.RoomInfo.getInstance().GM_Mode&&c.uid!=uniLib.UserInfo.uid&&c.myCardSet)for(var h=c.myCardSet,i=0;i<h.length;i++)game.CardInfo.getInstance().addOtherCard(h[i],c.uid)}b(game.MahjongFourFacadeConst.SUPPLY_FLOWER_NOTICE,c),game.RoomInfo.getInstance().setRemainCardNum(c.heapCardNum),c.heapCardNum?game.RoomInfo.getInstance().setRemainderCardCount(c.heapCardNum):game.RoomInfo.getInstance().setRemainderCardCount(0)}function A(a){game.RoomInfo.getInstance().changeHandCard=!1,10==a.getCardType&&a.uid==uniLib.NetMgr.UID&&a.uid==game.RoomInfo.getInstance().videoUid||(game.CardInfo.getInstance().ziDrawData=a),b(game.MahjongFourFacadeConst.ZIDRAW,a)}function B(a){b(game.MahjongFourFacadeConst.DIS_CARD_SUCCESS,a)}function C(c){if(a.trace("自己摸牌：SendCardMahjongCmd_S "+JSON.stringify(c)),game.RoomInfo.getInstance().changeHandCard=!1,c.opType&&30===c.opType[0])return 1==game.RoomInfo.getInstance().video&&game.RoomInfo.getInstance().videoUid!=c.ownerid?game.CardInfo.getInstance().addOtherCard(c.thisId,c.ownerid):1==game.RoomInfo.getInstance().video&&game.RoomInfo.getInstance().videoUid==c.ownerid&&c.thisId&&game.CardInfo.getInstance().addMyCard(c.thisId),game.CardInfo.getInstance().drawData=c,c.windSet&&1==c.windSet.length&&(game.CardInfo.getInstance().superPositionCardId=c.windSet[0]),c.replaceWindSet&&1==c.replaceWindSet.length&&(game.CardInfo.getInstance().needChangeCardId=c.replaceWindSet[0]),c.showCardSet&&1==c.showCardSet.length&&(game.CardInfo.getInstance().showCardId=c.showCardSet[0]),game.CardInfo.getInstance().exCardSet.push(c.thisId),void b(game.MahjongFourFacadeConst.EXDRAW,c);if(c.ls&&c.ls.length>0&&(c.listenSet=c.ls),c.los&&c.los.length>0&&(c.listenObjSet=c.los),c.listenObjSet&&c.listenObjSet.length>0)for(var d=0;d<c.listenObjSet.length;d++)if(c.listenObjSet[d].lc&&c.listenObjSet[d].lc.length>0&&(c.listenObjSet[d].listenCardSet=c.listenObjSet[d].lc),c.listenObjSet[d].listenCardSet&&c.listenObjSet[d].listenCardSet.length&&c.listenObjSet[d].listenCardSet.length>0)for(var e=0;e<c.listenObjSet[d].listenCardSet.length;e++)c.listenObjSet[d].listenCardSet[e].num&&(c.listenObjSet[d].listenCardSet[e].remainNum=c.listenObjSet[d].listenCardSet[e].num);if(c.listenObjSet&&0!=c.listenObjSet.length||(c.listenObjSet=[],game.RoomInfo.getInstance().last_SendCardMahjong&&(c.resetListen?game.RoomInfo.getInstance().last_SendCardMahjong.listenObjSet={}:c.listenObjSet=game.RoomInfo.getInstance().last_SendCardMahjong.listenObjSet)),c.triCard&&(game.CardInfo.getInstance().triCard=[]),game.RoomInfo.getInstance().last_SendCardMahjong=c,game.GameData.getInstance().lastCard=c.thisId,game.RoomInfo.getInstance().OutCard=null,c.goldOutCardSet&&(game.GameData.getInstance().goldOutCardSet=c.goldOutCardSet),game.CardInfo.getInstance().drawData&&(game.CardInfo.getInstance().drawData.thisId>500||ArrayUtil.isInArray(game.CardInfo.getInstance().drawData.thisId,game.RoomInfo.getInstance().flcard))&&(game.CardInfo.getInstance().removeMyCard(game.CardInfo.getInstance().drawData.thisId),a.gameDispatch(game.MahjongFourFacadeConst.SELF_HANDCARD_CHANGE)),game.CardInfo.getInstance().drawData=c,c.windSet&&1==c.windSet.length&&(game.CardInfo.getInstance().superPositionCardId=c.windSet[0]),c.replaceWindSet&&1==c.replaceWindSet.length&&(game.CardInfo.getInstance().needChangeCardId=c.replaceWindSet[0]),c.showCardSet&&1==c.showCardSet.length&&(game.CardInfo.getInstance().showCardId=c.showCardSet[0]),c.opType&&(game.RoomInfo.getInstance().isKnock=ArrayUtil.isInArray(a.MahjongOpCardType.MahjongOpCardType_Knock,c.opType)),1==game.RoomInfo.getInstance().video){if(c.thisId){if(game.VideoOpVc.instance.parent){var f=game.RoomInfo.getInstance().getSeatNoByUserId(c.ownerid);c.opType&&c.opType.length>0&&game.VideoOpVc.instance.showAction(f,c.opType)}var g=game.CardInfo.getInstance().addOtherCard(c.thisId,c.ownerid);game.RoomInfo.getInstance().videoUid!=c.ownerid&&(g?b(game.MahjongFourFacadeConst.EXDRAW,c):b(game.MahjongFourFacadeConst.DRAW_NOTICE,c))}}else c.thisId&&game.CardInfo.getInstance().addMyCard(c.thisId),b(game.MahjongFourFacadeConst.DRAW,c),0==game.RoomInfo.getInstance().host_mode&&b(game.MahjongFourFacadeConst.NOTICE_CARD_ENABLE,!0),game.RoomInfo.getInstance().setRemainCardNum(c.heapCardNum),c.heapCardNum?game.RoomInfo.getInstance().setRemainderCardCount(c.heapCardNum):game.RoomInfo.getInstance().setRemainderCardCount(0),c.thisId<500?game.GameData.getInstance().isMyTime=!0:c.thisId>500&&(5028==game.RoomInfo.getInstance().gameId||5093==game.RoomInfo.getInstance().gameId)&&(game.GameData.getInstance().isMyTime=!0),game.GameData.getInstance().isCanOperate=!0;if(c.heapCardNum||game.CardInfo.getInstance().isStartSend?(game.CardInfo.getInstance().isStartSend&&(game.CardInfo.getInstance().isStartSend=!1),game.RoomInfo.getInstance().addShowCard(c.thisId)):0==game.RoomInfo.getInstance().video?game.RoomInfo.getInstance().addShowCard(c.thisId,!0):c.ownerid&&c.ownerid==uniLib.UserInfo.uid&&game.RoomInfo.getInstance().addShowCard(c.thisId,!0),game.RoomInfo.getInstance().host_mode&&c.thisId<500&&!c.opType){var h=new a.OutCardMahjongCmd_C;h.thisId=c.thisId,egret.setTimeout(function(){b(game.MahjongFourFacadeConst.SEND_DATA,h,game.DataRequestCommand.GAME_DATA)},a,100),uniLib.NetMgr.setMsgTimeout(8,"OutCardMahjongCmd_C")}if((!c.opType||!c.opType[0]||0==c.opType.length)&&c.thisId<500&&game.RoomInfo.getInstance().isListen&&4039!==game.RoomInfo.getInstance().gameId){var i=new a.OutCardMahjongCmd_C;i.thisId=c.thisId,egret.setTimeout(function(){b(game.MahjongFourFacadeConst.SEND_DATA,i,game.DataRequestCommand.GAME_DATA)},a,1e3),uniLib.NetMgr.setMsgTimeout(8,"OutCardMahjongCmd_C")}}function D(c){if(game.VideoOpVc.instance.removeAllAct(),c.sid&&(c.uid=game.RoomInfo.getInstance().getUserIdBySid(c.sid)),c.stand&&b(game.MahjongFourFacadeConst.START_NEW_STAND,c.uid),c.isSichuan)return b(game.MahjongFourFacadeConst.EX_DRAW_NOTICE,c),void b(game.MahjongFourFacadeConst.NOTICE_CARD_ENABLE,!1);c.getCardType?game.RoomInfo.getInstance().drawType=c.getCardType:game.RoomInfo.getInstance().drawType=0,game.RoomInfo.getInstance().changeHandCard=!1,game.RoomInfo.getInstance().bGetNum++,a.trace("摸牌通知：SendCardMahjongCmd_Brd "+JSON.stringify(c)),3!=c.getCardType&&game.CardInfo.getInstance().updateUserHandCount(c.uid,1,0),game.RoomInfo.getInstance().GM_Mode&&c.uid!=uniLib.UserInfo.uid&&0==game.RoomInfo.getInstance().video&&game.CardInfo.getInstance().addOtherCard(c.thisId,c.uid),c.uid!=uniLib.UserInfo.uid?b(game.MahjongFourFacadeConst.NOTICE_CARD_ENABLE,!1):b(game.MahjongFourFacadeConst.NOTICE_CARD_ENABLE,!0),game.RoomInfo.getInstance().outerId=c.uid,c.sec||0==c.sec?game.RoomInfo.getInstance().outCount=c.sec:game.RoomInfo.getInstance().outCount=game.RoomInfo.getInstance().defaultOutCount,1==game.RoomInfo.getInstance().video&&game.VideoOpVc.instance.parent&&game.VideoOpVc.instance.removeAllAct(),b(game.MahjongFourFacadeConst.DRAW_NOTICE,c),c.heapCardNum?(game.RoomInfo.getInstance().setRemainderCardCount(c.heapCardNum),game.RoomInfo.getInstance().setRemainCardNum(c.heapCardNum)):game.RoomInfo.getInstance().setRemainderCardCount(0),1==c.stand&&b(game.MahjongFourFacadeConst.GAME_YUANQUE_STAND),c.uid!=uniLib.UserInfo.uid&&game.CardInfo.getInstance().isStartSend,1==game.RoomInfo.getInstance().video&&c.heapCardNum&&(game.RoomInfo.getInstance().setRemainCardNum(c.heapCardNum),game.RoomInfo.getInstance().setRemainderCardCount(c.heapCardNum))}function E(c){if(null!=uniLib.Global.lastPingUpTimestamp&&(uniLib.Global.lastPing=Date.now()-uniLib.Global.lastPingUpTimestamp,uniLib.Global.lastPingUpTimestamp=null),a.trace("出牌返回：OutCardMahjongCmd_S "+JSON.stringify(c)),c.resultCode||(c.resultCode=0),c.desc||(c.desc="成功"),c.ws&&c.ws.length>0&&(c.winCardSet=c.ws),2==c.resultCode)game.CardInfo.getInstance().discard(uniLib.UserInfo.uid,c.thisId,!1),a.gameDispatch(game.MahjongFourFacadeConst.SELF_OUTCARD_REFRESH),a.gameDispatch(game.MahjongFourFacadeConst.SELF_HANDCARD_CHANGE);else{if(0!=c.resultCode)return b(game.MahjongFourFacadeConst.OUT_CARD_REFRESH,c.thisId),void b(game.MahjongFourFacadeConst.NOTICE_CARD_ENABLE,!0);if(game.RoomInfo.getInstance().addShowCard(c.thisId),c.winCardSet&&0!=c.winCardSet.length||(c.winCardSet=[],game.RoomInfo.getInstance().last_OutCardMahjong&&(c.resetListen?game.RoomInfo.getInstance().last_OutCardMahjong.winCardSet=[]:c.winCardSet=game.RoomInfo.getInstance().last_OutCardMahjong.winCardSet)),c.isSwimGold&&b(game.MahjongFourFacadeConst.SWIM_GOLD,c.isSwimGold),game.RoomInfo.getInstance().last_OutCardMahjong=c,1==game.RoomInfo.getInstance().video)return;if(ArrayUtil.isInArray(c.thisId,game.RoomInfo.getInstance().outCardSuccArr))return;game.CardInfo.getInstance().discard(uniLib.UserInfo.uid,c.thisId),0==game.CardInfo.getInstance().liangSeat[0]&&(game.CardInfo.getInstance().triCard=[]),game.CardInfo.getInstance().winCardSet=[],c.winCardSet instanceof Array&&c.winCardSet.length>0?(game.CardInfo.getInstance().winCardSet=c.winCardSet,b(game.MahjongFourFacadeConst.SELF_DISCARD_NOTICE,c.winCardSet)):b(game.MahjongFourFacadeConst.SELF_DISCARD_NOTICE,[])}}function F(c){c.sid&&(c.uid=game.RoomInfo.getInstance().getUserIdBySid(c.sid)),null!=uniLib.Global.lastPingUpTimestamp&&c.uid==uniLib.UserInfo.uid&&(uniLib.Global.lastPing=Date.now()-uniLib.Global.lastPingUpTimestamp,uniLib.Global.lastPingUpTimestamp=null),game.CardInfo.getInstance().isStartSend=!1,game.CardInfo.getInstance().drawData=null,game.RoomInfo.getInstance().isKnock=!1,game.CardInfo.getInstance().barOutCardData=null,game.CardInfo.getInstance().superPositionCardId=null,game.CardInfo.getInstance().needChangeCardId=null,game.CardInfo.getInstance().showCardId=null,game.CardInfo.getInstance().addCard(c.thisId,game.CardInfo.getInstance().allOutCardGroup),a.trace("出牌通知：OutCardMahjongCmd_Brd "+JSON.stringify(c)),c.isFollow||(c.isFollow=0);var d=!0;c.opType||(c.opType=[],d=!1),c.opType&&c.opType instanceof Array&&c.opType.length>0&&(game.GameData.getInstance().isCanOperate=!0),c.cardType||(c.cardType=0),game.RoomInfo.getInstance().addShowCard(c.thisId),c.uid==uniLib.UserInfo.uid&&(game.RoomInfo.getInstance().outCardSuccArr.push(c.thisId),game.GameData.getInstance().isMyTime=!1,game.GameData.getInstance().goldOutCardSet=[],game.CardInfo.getInstance().discard(uniLib.UserInfo.uid,c.thisId)),game.RoomInfo.getInstance().OutCard=c,game.RoomInfo.getInstance().outerId=c.uid,game.RoomInfo.getInstance().isSpecialCard=c.cardType,c.sec||0==c.sec?(game.RoomInfo.getInstance().outCount=c.sec,1==d&&(game.RoomInfo.getInstance().opCount=c.sec)):(game.RoomInfo.getInstance().outCount=game.RoomInfo.getInstance().defaultOutCount,1==d&&(game.RoomInfo.getInstance().opCount=game.RoomInfo.getInstance().defaultOpCount));var e;if(c.uid!=uniLib.UserInfo.uid){game.RoomInfo.getInstance().GM_Mode&&game.CardInfo.getInstance().deleteOtherHand(c.thisId,c.uid);var f=game.RoomInfo.getInstance().getSeatNoByUserId(c.uid);e=ArrayUtil.isInArray(c.thisId,game.CardInfo.getInstance().getOutCardBySeat(f)),e||(game.CardInfo.getInstance().updateUserHandCount(c.uid,1,1),game.CardInfo.getInstance().discard(c.uid,c.thisId))}if(c.winCardSet instanceof Array&&c.winCardSet.length>0&&(game.CardInfo.getInstance().winCardSet=c.winCardSet,game.CardInfo.getInstance().freshListenData=!0,b(game.MahjongFourFacadeConst.SELF_DISCARD_NOTICE,c.winCardSet)),0==c.cardType||1!=c.cardType&&3!=c.cardType||0==c.uid||(game.RoomInfo.getInstance().chongfengUID=c.uid,b(game.MahjongFourFacadeConst.CHONGFENG_NOTICE,c.uid)),1==game.RoomInfo.getInstance().video&&game.VideoOpVc.instance.parent&&game.VideoOpVc.instance.removeAllAct(),game.RoomInfo.getInstance().isZqGame()?b(game.MahjongFourFacadeConst.DISCARD_NOTICE):b(game.MahjongFourFacadeConst.DISCARD_NOTICE,c),c.uid!=uniLib.UserInfo.uid||game.RoomInfo.getInstance().isHostMode>=1||1==game.RoomInfo.getInstance().isHu){var g=game.RoomInfo.getInstance().getUserVoByUid(c.uid),h=table.TableCard.resSound(c.thisId,g.getGender());""!=h&&4077!==game.RoomInfo.getInstance().gameId&&uniLib.SoundMgr.instance.playSound(h),uniLib.SoundMgr.instance.playSound(game.SoundConsts.DISCARD)}}function G(a){if(1==game.RoomInfo.getInstance().video&&a.uid&&game.VideoOpVc.instance&&game.VideoOpVc.instance.parent){var b=game.RoomInfo.getInstance().getSeatNoByUserId(a.uid);game.VideoOpVc.instance.showUserOp(b,a.op)}}function H(b){a.trace("回放操作列表OnRecordOpListMahjongCmd_S"+JSON.stringify(b)),1==game.RoomInfo.getInstance().video&&b.list&&b.list.length>0&&game.VideoOpVc.instance&&game.VideoOpVc.instance.parent&&(game.VideoOpVc.instance.removeAllAct(),b.list.forEach(function(a){if(a.uid&&a.opType){var b=game.RoomInfo.getInstance().getSeatNoByUserId(a.uid);game.VideoOpVc.instance.showAction(b,a.opType)}}))}function I(a){2!=a.resultCode&&b(game.MahjongFourFacadeConst.REMOVE_ACTION)}function J(a){b(game.MahjongFourFacadeConst.NESTLE_NOTICE,a)}function K(a){b(game.MahjongFourFacadeConst.LIFT_NOTICE,a)}function L(a){b(game.MahjongFourFacadeConst.COMPARE_CARD_NOTICE,a)}function M(c){if(game.VideoOpVc.instance.removeAllAct(),game.RoomInfo.getInstance().OutCard=null,!c.ownerid||c.ownerid==uniLib.UserInfo.uid){a.trace("杠牌通知：BarCardMahjongCmd_Brd"+JSON.stringify(c)),c.obj.barType==a.MahjongOpCardType.MahjongOpCardType_BarSelf&&2==game.RoomInfo.getInstance().idDarkBar?game.RoomInfo.getInstance().subRemainCardNum():(201!=c.obj.barType&&game.RoomInfo.getInstance().addShowCard(c.obj.thisId),game.RoomInfo.getInstance().addShowCardList(c.obj.cardSet));var d=new game.OperatVo;if(d.setKongData(c.obj),game.CardInfo.getInstance().kongCard(d),0==game.RoomInfo.getInstance().video&&game.RoomInfo.getInstance().GM_Mode&&c.obj.uid!=uniLib.UserInfo.uid)for(var e=c.obj.cardSet,f=0;f<e.length;f++){var g=game.RoomInfo.getInstance().getSeatNoByUserId(c.obj.uid);game.CardInfo.getInstance().deleteOtherHand(e[f],c.obj.uid)}c.card_type&&0!=c.card_type&&0!=game.RoomInfo.getInstance().chongfengUID&&(game.RoomInfo.getInstance().isSpecialCard=c.card_type,b(game.MahjongFourFacadeConst.CHONGFENG_NOTICE,game.RoomInfo.getInstance().chongfengUID)),c.obj.uid==uniLib.UserInfo.uid?(game.GameData.getInstance().isCanOperate=!0,201==c.obj.barType?c.obj.uid==c.obj.fromUid?game.CardInfo.getInstance().updateUserHandCount(c.obj.uid,c.obj.cardSet.length,1):game.CardInfo.getInstance().updateUserHandCount(c.obj.uid,c.obj.cardSet.length-1,1):202==c.obj.barType?game.CardInfo.getInstance().updateUserHandCount(c.obj.uid,c.obj.cardSet.length>4?1:c.obj.cardSet.length,1):game.CardInfo.getInstance().updateUserHandCount(c.obj.uid,c.obj.cardSet.length,1)):c.obj.barType==a.MahjongOpCardType.MahjongOpCardType_BarTouch?game.CardInfo.getInstance().updateUserHandCount(c.obj.uid,1,1):c.obj.barType==a.MahjongOpCardType.MahjongOpCardType_BarSelf?game.CardInfo.getInstance().updateUserHandCount(c.obj.uid,4,1):c.obj.barType==a.MahjongOpCardType.MahjongOpCardType_BarOther?game.CardInfo.getInstance().updateUserHandCount(c.obj.uid,3,1):c.obj.barType==a.MahjongOpCardType.MahjongOpCardType_YuanJinBar?game.CardInfo.getInstance().updateUserHandCount(c.obj.uid,4,1):c.obj.barType==a.MahjongOpCardType.MahjongOpCardType_ZaJinBar?game.CardInfo.getInstance().updateUserHandCount(c.obj.uid,4,1):201==c.obj.barType?c.obj.uid==c.obj.fromUid?game.CardInfo.getInstance().updateUserHandCount(c.obj.uid,c.obj.cardSet.length,1):game.CardInfo.getInstance().updateUserHandCount(c.obj.uid,c.obj.cardSet.length-1,1):202==c.obj.barType&&game.CardInfo.getInstance().updateUserHandCount(c.obj.uid,c.obj.cardSet.length>4?1:c.obj.cardSet.length,1),game.RoomInfo.getInstance().eGetNum++;var h=game.RoomInfo.getInstance().getSeatNoByUserId(c.obj.fromUid),i=game.CardInfo.getInstance().allOutCardSet[h];game.CardInfo.getInstance().removeCard(c.obj.thisId,i);if(b(game.MahjongFourFacadeConst.KONG_NOTICE,d),a.gameDispatch(game.MahjongFourFacadeConst.SELF_HANDCARD_CHANGE),c.obj.uid==uniLib.UserInfo.uid&&4055===game.RoomInfo.getInstance().gameId&&b(game.MahjongFourFacadeConst.NOTICE_CARD_ENABLE,!1),1==game.RoomInfo.getInstance().video&&game.RoomInfo.getInstance().videoUid!=c.obj.uid){for(var g=game.RoomInfo.getInstance().getSeatNoByUserId(c.obj.uid),e=c.obj.cardSet,f=0;f<e.length;f++)return void game.CardInfo.getInstance().deleteOtherHand(e[f],c.obj.uid);b(game.MahjongFourFacadeConst.VIDEO_REFRESH_HANDCARD,g)}if(c.canWin||c.canTouch){var j={};j.opType=[],1==c.canWin&&j.opType.push(1),1==c.canTouch&&j.opType.push(6),b(game.MahjongFourFacadeConst.SHOW_ACTION,j)}}if(1==game.RoomInfo.getInstance().video&&game.RoomInfo.getInstance().videoUid!=c.obj.uid){for(var g=game.RoomInfo.getInstance().getSeatNoByUserId(c.obj.uid),e=c.obj.cardSet,f=0;f<e.length;f++)game.CardInfo.getInstance().deleteOtherHand(e[f],c.obj.uid);b(game.MahjongFourFacadeConst.VIDEO_REFRESH_HANDCARD,g)}}function N(a){a.resultCode||(a.resultCode=0),a.resultCode==game.NetConsts.PRIORITY&&b(game.MahjongFourFacadeConst.REMOVE_ACTION)}function O(a){b(game.MahjongFourFacadeConst.KONG_DICE,a.dice)}function P(c){if(game.VideoOpVc.instance.removeAllAct(),c.hn&&(c.heapCardNum=c.hn),game.CardInfo.getInstance().barOutCardData=null,c.sec||0==c.sec?game.RoomInfo.getInstance().outCount=c.sec:game.RoomInfo.getInstance().outCount=game.RoomInfo.getInstance().defaultOutCount,game.RoomInfo.getInstance().outerId=c.uid,c.cardSet)for(var d=0;d<c.cardSet.length;d++){var e=new a.SendCardMahjongCmd_Brd;e.uid=c.uid,e.thisId=c.cardSet[d],b(game.MahjongFourFacadeConst.DRAW_NOTICE,e)}else{c.cardSet=[];var f=new a.SendCardMahjongCmd_Brd;f.uid=c.uid,b(game.MahjongFourFacadeConst.DRAW_NOTICE,f);var g=new a.SendCardMahjongCmd_Brd;g.uid=c.uid,b(game.MahjongFourFacadeConst.DRAW_NOTICE,g)}game.RoomInfo.getInstance().setRemainCardNum(c.heapCardNum),c.heapCardNum?game.RoomInfo.getInstance().setRemainderCardCount(c.heapCardNum):game.RoomInfo.getInstance().setRemainderCardCount(0)}function Q(a){b(game.MahjongFourFacadeConst.REMOVE_ACTION),b(game.MahjongFourFacadeConst.KONG_SEND_CARD,a),a.opType&&b(game.MahjongFourFacadeConst.SHOW_ACTION,a)}function R(a){game.CardInfo.getInstance().barOutCardData=a,game.RoomInfo.getInstance().OutCard&&(game.RoomInfo.getInstance().OutCard.eatSet=a.eatSet),game.CardInfo.getInstance().discard(a.uid,a.oneThisId),game.CardInfo.getInstance().discard(a.uid,a.twoThisId),b(game.MahjongFourFacadeConst.KONG_OUT_CARD,a);var c=game.RoomInfo.getInstance().getUserVoByUid(a.uid),d=(game.RoomInfo.getInstance().getSeatNoByUserId(a.uid),[]);d.push(table.TableCard.resSound(a.oneThisId,c.getGender())),d.push(table.TableCard.resSound(a.twoThisId,c.getGender()));for(var e=function(a){d[a]&&""!=d[a]&&egret.setTimeout(function(){uniLib.SoundMgr.instance.playSound(d[a]),uniLib.SoundMgr.instance.playSound(game.SoundConsts.DISCARD)},f,200)},f=this,g=0;g<d.length;g++)e(g)}function S(a){a.resultCode||(a.resultCode=0),a.resultCode==game.NetConsts.PRIORITY&&b(game.MahjongFourFacadeConst.REMOVE_ACTION)}function T(c){game.VideoOpVc.instance.removeAllAct(),game.RoomInfo.getInstance().addShowCard(c.obj.thisId),game.RoomInfo.getInstance().addShowCardList(c.obj.cardSet);var d=new game.OperatVo;if(d.setKongData(c.obj),game.CardInfo.getInstance().kongCard(d),game.RoomInfo.getInstance().GM_Mode&&c.obj.uid!=uniLib.UserInfo.uid)for(var e=c.obj.cardSet,f=0;f<e.length;f++){game.RoomInfo.getInstance().getSeatNoByUserId(c.obj.uid);game.CardInfo.getInstance().deleteOtherHand(e[f],c.obj.uid)}if(c.obj.uid==uniLib.UserInfo.uid?game.CardInfo.getInstance().updateUserHandCount(c.obj.uid,4,1):c.obj.barType==a.MahjongOpCardType.MahjongOpCardType_SupplyOther?game.CardInfo.getInstance().updateUserHandCount(c.obj.uid,3,1):c.obj.barType==a.MahjongOpCardType.MahjongOpCardType_SupplySelf?game.CardInfo.getInstance().updateUserHandCount(c.obj.uid,4,1):c.obj.barType==a.MahjongOpCardType.MahjongOpCardType_SupplyTouch&&game.CardInfo.getInstance().updateUserHandCount(c.obj.uid,1,1),b(game.MahjongFourFacadeConst.KONG_NOTICE,d),c.obj.uid==uniLib.UserInfo.uid&&a.gameDispatch(game.MahjongFourFacadeConst.SELF_HANDCARD_CHANGE),c.canWin){var g={};g.opType=[1],b(game.MahjongFourFacadeConst.SHOW_ACTION,g)}}function U(c){game.VideoOpVc.instance.removeAllAct(),game.RoomInfo.getInstance().OutCard=null,a.trace("碰牌通知：TouchCardMahjongCmd_Brd"+JSON.stringify(c));var d=new game.OperatVo;if(game.RoomInfo.getInstance().addShowCard(c.obj.thisId),game.RoomInfo.getInstance().addShowCardList(c.obj.cardSet),d.setPongData(c.obj),d.type=a.MahjongOpCardType.MahjongOpCardType_Touch,game.CardInfo.getInstance().pongCard(d),c.card_type&&0!=game.RoomInfo.getInstance().chongfengUID&&(game.RoomInfo.getInstance().isSpecialCard=c.card_type,b(game.MahjongFourFacadeConst.CHONGFENG_NOTICE,game.RoomInfo.getInstance().chongfengUID)),0==game.RoomInfo.getInstance().video&&game.RoomInfo.getInstance().GM_Mode&&c.obj.uid!=uniLib.UserInfo.uid)for(var e=c.obj.cardSet,f=0;f<e.length;f++){var g=game.RoomInfo.getInstance().getSeatNoByUserId(c.obj.uid);game.CardInfo.getInstance().deleteOtherHand(e[f],c.obj.uid)}c.obj.uid==uniLib.UserInfo.uid||1==game.RoomInfo.getInstance().video?(game.GameData.getInstance().isCanOperate=!0,game.CardInfo.getInstance().updateUserHandCount(c.obj.uid,3,1)):game.CardInfo.getInstance().updateUserHandCount(c.obj.uid,2,1);var h=game.RoomInfo.getInstance().getSeatNoByUserId(c.obj.fromUid),i=game.CardInfo.getInstance().allOutCardSet[h];game.CardInfo.getInstance().removeCard(c.obj.thisId,i);if(b(game.MahjongFourFacadeConst.PONG_NOTICE,d),a.gameDispatch(game.MahjongFourFacadeConst.SELF_HANDCARD_CHANGE),1==game.RoomInfo.getInstance().video&&game.RoomInfo.getInstance().videoUid!=c.obj.uid){for(var g=game.RoomInfo.getInstance().getSeatNoByUserId(c.obj.uid),e=c.obj.cardSet,f=0;f<e.length;f++)game.CardInfo.getInstance().deleteOtherHand(e[f],c.obj.uid);b(game.MahjongFourFacadeConst.VIDEO_REFRESH_HANDCARD,g)}}function V(a){a.resultCode||(a.resultCode=0),a.resultCode==game.NetConsts.PRIORITY&&b(game.MahjongFourFacadeConst.REMOVE_ACTION)}function W(c){game.VideoOpVc.instance.removeAllAct(),game.RoomInfo.getInstance().OutCard=null,a.trace("吃牌通知：EatCardMahjongCmd_Brd"+JSON.stringify(c)),game.RoomInfo.getInstance().addShowCard(c.obj.one),game.RoomInfo.getInstance().addShowCard(c.obj.two),game.RoomInfo.getInstance().addShowCard(c.obj.thisId);var d=new game.OperatVo;if(d.setEatData(c.obj),game.CardInfo.getInstance().pongCard(d),0==game.RoomInfo.getInstance().video&&game.RoomInfo.getInstance().GM_Mode&&c.obj.uid!=uniLib.UserInfo.uid){var e=game.RoomInfo.getInstance().getSeatNoByUserId(c.obj.uid);game.CardInfo.getInstance().deleteOtherHand(c.obj.one,c.obj.uid),game.CardInfo.getInstance().deleteOtherHand(c.obj.two,c.obj.uid)}c.obj.uid==uniLib.UserInfo.uid||1==game.RoomInfo.getInstance().video?(game.GameData.getInstance().isCanOperate=!0,game.CardInfo.getInstance().updateUserHandCount(c.obj.uid,3,1)):game.CardInfo.getInstance().updateUserHandCount(c.obj.uid,2,1);var f=game.RoomInfo.getInstance().getSeatNoByUserId(c.obj.fromUid),g=game.CardInfo.getInstance().allOutCardSet[f];game.CardInfo.getInstance().removeCard(c.obj.thisId,g);if(b(game.MahjongFourFacadeConst.CHOW_NOTICE,d),a.gameDispatch(game.MahjongFourFacadeConst.SELF_HANDCARD_CHANGE),1==game.RoomInfo.getInstance().video&&game.RoomInfo.getInstance().videoUid!=c.obj.uid){for(var e=game.RoomInfo.getInstance().getSeatNoByUserId(c.obj.uid),h=[c.obj.one,c.obj.two],i=0;i<h.length;i++)game.CardInfo.getInstance().deleteOtherHand(h[i],c.obj.uid);b(game.MahjongFourFacadeConst.VIDEO_REFRESH_HANDCARD,e)}}function X(a){a.resultCode||(a.resultCode=0),a.resultCode==game.NetConsts.PRIORITY&&b(game.MahjongFourFacadeConst.REMOVE_ACTION)}function Y(a){a.resultCode||(a.resultCode=0),a.resultCode==game.NetConsts.PRIORITY?b(game.MahjongFourFacadeConst.REMOVE_ACTION):a.resultCode==game.NetConsts.CANCLEOPEARET&&b(game.MahjongFourFacadeConst.REMOVE_ACTION)}function Z(a){b(game.MahjongFourFacadeConst.LISTEN_NOTICE)}function $(a){var c=a.uid;b(game.MahjongFourFacadeConst.START_lISTEN_NOTICE,c),b(game.MahjongFourFacadeConst.lISTEN_CARD_NOTICE,a)}function _(a){game.VideoOpVc.instance.removeAllAct(),b(game.MahjongFourFacadeConst.REMOVE_ACTION),b(game.MahjongFourFacadeConst.WIN_CARD_NOTICE,a)}function aa(a){a.hn&&(a.heapCardNum=a.hn),b(game.MahjongFourFacadeConst.BIRD_BRD,a.birdSet),game.RoomInfo.getInstance().setRemainCardNum(a.heapCardNum),a.heapCardNum?game.RoomInfo.getInstance().setRemainderCardCount(a.heapCardNum):game.RoomInfo.getInstance().setRemainderCardCount(0)}function ba(a){game.VideoOpVc.instance.removeAllAct(),b(game.MahjongFourFacadeConst.REMOVE_ACTION,a),b(game.MahjongFourFacadeConst.WIN_MAHJONG_NOTICE,a)}function ca(a){if(game.VideoOpVc.instance.removeAllAct(),game.RoomInfo.getInstance().winRes=a,game.RoomInfo.getInstance().isHu=!0,game.RoomInfo.getInstance().huID=a.thisId,game.RoomInfo.getInstance().isMask=!1,game.GameData.getInstance().isCanOperate=!1,a.rewardSet){for(var c=0;c<a.rewardSet.length;c++){var d=a.rewardSet[c];if(!d.nickname){var e=game.RoomInfo.getInstance().getUserVoByUid(d.uid);d.nickname=e.nickName}d.multiDetailSet&&0!=d.multiDetailSet.length||(d.multiDetailSet=[]),d.animation||(d.animation=0),d.winType||(d.winType=0);for(var f=game.RoomInfo.getInstance().roundScore,g=0;g<f.length;g++){var h=f[g];h.uid==d.uid&&h.score.push(d.totalReward)}}game.RoomInfo.getInstance().chipsSets=a.rewardSet}if(void 0!==a.isWin&&0===a.isWin){if(a.shootId){var i=game.RoomInfo.getInstance().getSeatNoByUserId(a.shootId),j=game.CardInfo.getInstance().allOutCardSet[i];game.CardInfo.getInstance().removeCard(a.thisId,j)}return b(game.MahjongFourFacadeConst.HU_NOTICE,a),void(game.RoomInfo.getInstance().isMask=!0)}if(game.RoomInfo.getInstance().isStart=!1,0!==game.RoomInfo.getInstance().gameID)return void b(game.MahjongFourFacadeConst.SHOW_HU_NOTICE,a);a.horseSet?game.RoomInfo.getInstance().buyHorse=!0:game.RoomInfo.getInstance().buyHorse=!1,b(game.MahjongFourFacadeConst.RESULT_NOTICE,a)}function da(a){a.cid&&(a.chicken_card_id=a.cid),a.rs&&(a.rewardSet=a.rs),a.cs&&(a.chickenSet=a.cs),game.RoomInfo.getInstance().zhuojiID=a.chicken_card_id,a.rewardSet&&(game.RoomInfo.getInstance().chipsSets=a.rewardSet),game.RoomInfo.getInstance().setCashChicken(a.chickenSet),b(game.MahjongFourFacadeConst.RESULT_NOTICE,a),0!=a.chicken_card_id&&(game.RoomInfo.getInstance().upChicnkenID=a.chickenSet[0][5],game.RoomInfo.getInstance().downChicnkenID=a.chickenSet[0][6],b(game.MahjongFourFacadeConst.CASH_CHICKEN,a))}function ea(a){b(game.MahjongFourFacadeConst.SEA_ROAM_TURN,a)}function fa(a){b(game.MahjongFourFacadeConst.SEA_ROAM_BRD,a),game.RoomInfo.getInstance().setRemainCardNum(0),game.RoomInfo.getInstance().setRemainderCardCount(0);var c=game.RoomInfo.getInstance().getUserVoByUid(a.uid),d=(game.RoomInfo.getInstance().getSeatNoByUserId(a.uid),table.TableCard.resSound(a.thisId,c.getGender()));""!=d&&uniLib.SoundMgr.instance.playSound(d),uniLib.SoundMgr.instance.playSound(game.SoundConsts.DISCARD)}function ga(a){1!=game.RoomInfo.getInstance().video&&(game.CardInfo.getInstance().isStartSend=!0,game.RoomInfo.getInstance().isKnock=!1,a.userCard&&1==a.userCard.showFlag&&(game.RoomInfo.getInstance().host_mode=1,game.CardInfo.getInstance().liangSeat[0]=a.userCard.showFlag),a.roomId&&(game.DataCache.platParam||(game.DataCache.platParam={}),game.DataCache.platParam.roomId=a.roomId),a.curGameNbr&&(game.RoomInfo.getInstance().curNumber=a.curGameNbr),a.curJiao&&(game.RoomInfo.getInstance().curJiao=a.curJiao),a.curNbr&&(game.RoomInfo.getInstance().curRound=a.curNbr),a.eastUid&&(game.RoomInfo.getInstance().eastUid=a.eastUid),a.rfc&&game.RoomInfo.getInstance().addFlowerCard(a.rfc),a.bankerId&&(game.RoomInfo.getInstance().bankerId=a.bankerId,game.RoomInfo.getInstance().setBankerInfo(a.bankerId)),a.userCard&&a.userCard.handCardSet&&a.userCard.handCardSet.length>0&&(game.RoomInfo.getInstance().isStart=!0,game.CardInfo.getInstance().myCards=a.userCard),a.userCard&&a.userCard.userZiCard&&a.userCard.userZiCard.length>0&&(game.RoomInfo.getInstance().isStart=!0,game.CardInfo.getInstance().myCards=a.userCard),a.otherCard&&game.CardInfo.getInstance().setOtherCard(a.otherCard),a.lackInfos&&(game.RoomInfo.getInstance().lackInfos=a.lackInfos,b(game.MahjongFourFacadeConst.GAME_DINGQEU_RECONNET)),a.allOutCard&&(game.CardInfo.getInstance().allOutCardGroup=a.allOutCard),a.startLuo&&(game.RoomInfo.getInstance().startLuo=a.startLuo),a.getCardDirection&&(game.RoomInfo.getInstance().getCardDirection=a.getCardDirection),a.bGetNum&&(game.RoomInfo.getInstance().bGetNum=a.bGetNum),a.eGetNum&&(game.RoomInfo.getInstance().eGetNum=a.eGetNum),0!==game.RoomInfo.getInstance().gameID?!a.goldCardSet||2!=a.goldCardSet.length&&4!=a.goldCardSet.length||(game.RoomInfo.getInstance().isSpecialCard=a.goldCardSet[0],game.RoomInfo.getInstance().chongfengUID=a.goldCardSet[1],0!=game.RoomInfo.getInstance().isSpecialCard&&0!=game.RoomInfo.getInstance().chongfengUID&&b(game.MahjongFourFacadeConst.CHONGFENG_NOTICE,game.RoomInfo.getInstance().chongfengUID),game.RoomInfo.getInstance().isSpecialCard=a.goldCardSet[2],game.RoomInfo.getInstance().chongfengUID=a.goldCardSet[3],0!=game.RoomInfo.getInstance().isSpecialCard&&0!=game.RoomInfo.getInstance().chongfengUID&&b(game.MahjongFourFacadeConst.CHONGFENG_NOTICE,game.RoomInfo.getInstance().chongfengUID)):a.goldCardSet?(game.RoomInfo.getInstance().goldenCard=a.goldCardSet,a.goldType&&(1==a.goldType?game.RoomInfo.getInstance().addShowCardList(a.goldCardSet):3==a.goldType&&game.RoomInfo.getInstance().addShowCardList(a.displayCardSet))):game.RoomInfo.getInstance().goldenCard=[],a.betPoint?game.RoomInfo.getInstance().betPoint=a.betPoint:game.RoomInfo.getInstance().betPoint=0,a.circle&&(game.RoomInfo.getInstance().circle=a.circle),a.gate&&(game.RoomInfo.getInstance().gate=a.gate),a.userCard&&a.userCard.triCardSet&&(game.CardInfo.getInstance().triCard=a.userCard.triCardSet),a.userCard&&a.userCard.dangerCardSet&&(game.CardInfo.getInstance().dangerSet=a.userCard.dangerCardSet),a.bankerNum?game.RoomInfo.getInstance().bankerNum=a.bankerNum:game.RoomInfo.getInstance().bankerNum=0,a.displayCardSet&&(game.RoomInfo.getInstance().displayCard=a.displayCardSet),game.RoomInfo.getInstance().isStart||b(game.MahjongFourFacadeConst.READY_SHOW),a.winCardSet instanceof Array&&a.winCardSet.length>0&&(game.CardInfo.getInstance().winCardSet=a.winCardSet,game.RoomInfo.getInstance().last_OutCardMahjong||(game.RoomInfo.getInstance().last_OutCardMahjong={}),game.RoomInfo.getInstance().last_OutCardMahjong.winCardSet=a.winCardSet,b(game.MahjongFourFacadeConst.SELF_DISCARD_NOTICE,a.winCardSet)),a.num&&(game.RoomInfo.getInstance().lieNum=a.num),a.turnType&&(game.RoomInfo.getInstance().turnGoldType=a.turnType),a.direction&&(game.RoomInfo.getInstance().dirtection=a.direction),a.laZhuangMes&&(game.RoomInfo.getInstance().laZhuangMes=a.laZhuangMes),b(game.MahjongFourFacadeConst.RELOGIN,a),game.RoomInfo.getInstance().setRemainCardNum(a.heapCardNum),a.heapCardNum?game.RoomInfo.getInstance().setRemainderCardCount(a.heapCardNum):game.RoomInfo.getInstance().setRemainderCardCount(0))}function ha(c){if(c.resultCode||(c.resultCode=0),a.trace("点击开始：ReadyStartMahjongCmd_S"+JSON.stringify(c)),game.RoomInfo.getInstance().isStart||1==c.resultCode)return void b(game.MahjongFourFacadeConst.RESET_RESULT_PANEL);b(game.MahjongFourFacadeConst.RESET_TABLE)}function ia(a){b(game.MahjongFourFacadeConst.TOUHE_NOTICE,a)}function ja(c){a.trace("准备通知：ReadyStartMahjongCmd_Brd"+JSON.stringify(c)),c.uid==uniLib.UserInfo.uid&&b(game.MahjongFourFacadeConst.RESET_TABLE),game.RoomInfo.getInstance().readyUsers=c.readyUserSet;var d=game.RoomInfo.getInstance().getUserVoByUid(c.uid);d&&(d.multiPiao=c.multiPiao,d.bReady=1),b(game.MahjongFourFacadeConst.READY_NOTICE,c.uid),c.touheType&&1==c.touheType&&b(game.MahjongFourFacadeConst.TOUHE_BROADCAST,c)}function ka(c){a.trace("取消准备通知：ReadyStartMahjongCmd_Brd"+JSON.stringify(c));var d=game.RoomInfo.getInstance().getUserVoByUid(c.uid);d&&(d.multiPiao=0,d.bReady=0),b(game.MahjongFourFacadeConst.CANCEL_READY_NOTICE,c.uid)}function la(a){b(game.MahjongFourFacadeConst.NOTIFY_ONLINE_STATE,a)}function ma(a){game.CardInfo.getInstance().heapCard=a.cardSet,a.cardSet&&a.cardSet.length>0?b(game.MahjongFourFacadeConst.GM_HEAP_CARD,a.cardButton):b(game.MahjongFourFacadeConst.GM_DELETE)}function na(a){game.CardInfo.getInstance().updateHeapCard(a.oldCardId,a.newCardId),0==a.needDelete?game.CardInfo.getInstance().changeCard(a.oldCardId,a.newCardId):game.CardInfo.getInstance().removeMyCard(a.oldCardId),b(game.MahjongFourFacadeConst.GM_CHANGE_CARD),game.CardInfo.getInstance().winCardSet=[],a.winCardSet instanceof Array&&a.winCardSet.length>0&&(game.CardInfo.getInstance().winCardSet=a.winCardSet,b(game.MahjongFourFacadeConst.SELF_DISCARD_NOTICE,a.winCardSet)),a.heapCardNum?(game.RoomInfo.getInstance().setRemainCardNum(a.heapCardNum),game.RoomInfo.getInstance().setRemainderCardCount(a.heapCardNum)):game.RoomInfo.getInstance().setRemainderCardCount(0)}function oa(a){game.RoomInfo.getInstance().disturbSwitch||b(game.MahjongFourFacadeConst.SEND_GIFTS_NOTICE,a)}function pa(a){a.resultCode||(a.resultCode=0)}function qa(a){b(game.MahjongFourFacadeConst.UPDATA_USER_CHIP,a)}function ra(a){game.RoomInfo.getInstance().pointSet=a.pointSet,b(game.MahjongFourFacadeConst.UPDATA_USER_POINT)}function sa(c){b(game.MahjongFourFacadeConst.USERINFO_DATA,c.userInfo),a.dispatch&&a.dispatch("PersonalInfo",c.userInfo)}function ta(a){b(game.MahjongFourFacadeConst.ReturnIpAndGPS,a)}function ua(a){a.sec||0==a.sec?game.RoomInfo.getInstance().outCount=a.sec:game.RoomInfo.getInstance().outCount=game.RoomInfo.getInstance().defaultOutCount,b(game.MahjongFourFacadeConst.START_ROUND_NOTICE,a),b(game.MahjongFourFacadeConst.START_NEW_ROUND_TIME,a)}function va(a){if(a.recordInfo&&a.recordInfo instanceof Array)for(var c=0;c<a.recordInfo.length;c++){if(!a.recordInfo[c].nickname||!a.recordInfo[c].headurl){var d=game.RoomInfo.getInstance().getUserVoByUid(a.recordInfo[c].uid);a.recordInfo[c].nickname=d.nickName,a.recordInfo[c].headurl=d.headUrl}a.recordInfo[c].isOwner||(a.recordInfo[c].isOwner=!1),a.recordInfo[c].isWinner||(a.recordInfo[c].isWinner=0)}a.reason?game.GameData.getInstance().resultReason=a.reason:game.GameData.getInstance().resultReason=null,game.RoomInfo.getInstance().matchId=a.matchId,game.GameData.getInstance().recordInfo=a.recordInfo,1==a.state?b(game.MahjongFourFacadeConst.TOTAL_RECORD_DATA,a.recordInfo):2==a.state||3==a.state&&(game.GameData.getInstance().recordInfo=null,game.GameData.getInstance().jiaoRecordInfo=a.recordInfo)}function wa(a){a.resultCode||(a.resultCode=0),a.resultCode==game.NetConsts.SUCCESS&&a.userNum>1&&game.GameInfo.manage.showMildWarnShow(game.DataCache.langObj.alertTxt.dismissOk)}function xa(a){b(game.MahjongFourFacadeConst.DISS_REQUEST_NOTICE,a)}function ya(a){b(game.MahjongFourFacadeConst.DISS_RESULT_NOTICE,a)}function za(a){b(game.MahjongFourFacadeConst.DISS_NOTICE,a)}function Aa(a){game.RoomInfo.getInstance().disturbSwitch||b(game.MahjongFourFacadeConst.VOICE_NOTICE,a)}function Ba(a){game.RoomInfo.getInstance().disturbSwitch||b(game.MahjongFourFacadeConst.NOTIFY_COMMON_CHAT,a)}function Ca(a){b(game.MahjongFourFacadeConst.NOTIFY_CHAT_RECORD,a)}function Da(a){b(game.MahjongFourFacadeConst.NOTIFY_SAME_IP,a)}function Ea(a){if(game.GameInfo&&game.GameInfo.manage){if(4109!=game.RoomInfo.getInstance().gameId&&4110!=game.RoomInfo.getInstance().gameId||(a.desc=a.desc.replace(/钻石/g,"元宝")),a.pos){if(2==a.pos)return void b(game.MahjongFourFacadeConst.SERVER_MESSAGE_NOTICE,a);if(1==a.pos)return void game.GameInfo.manage.showConfirmPanel(a.desc,["确定"],null,"",null)}game.GameInfo.manage.showMildWarnShow(a.desc)}}function Fa(a){b(game.MahjongFourFacadeConst.NOTIFY_POINT_CHANGE,a)}function Ga(a){b(game.MahjongFourFacadeConst.GAME_SHOW_CARD_BACK,a)}function Ha(a){var c=game.RoomInfo.getInstance().getSeatNoByUserId(a.uid);1!=game.CardInfo.getInstance().liangSeat[c]&&(game.CardInfo.getInstance().liangSeat[c]=1,a.uid!=uniLib.UserInfo.uid&&(4037==game.RoomInfo.getInstance().gameId?game.CardInfo.getInstance().triCardSet[c]=a.handCardSet:(game.CardInfo.getInstance().triCardSet[c]=a.handCardSet,game.CardInfo.getInstance().dangerSet=game.CardInfo.getInstance().dangerSet.concat(a.listenSet))),a.uid==uniLib.UserInfo.uid&&(4037==game.RoomInfo.getInstance().gameId&&(game.CardInfo.getInstance().triCard=a.handCardSet),b(game.MahjongFourFacadeConst.NOTICE_CARD_ENABLE,!1)),0!=c&&(game.CardInfo.getInstance().allHandCardSet[c]=a.handCardSet),b(game.MahjongFourFacadeConst.NOTICE_SHOW_CARD_BRD,a))}function Ia(a){}function Ja(a){a.uid==uniLib.UserInfo.uid&&(game.RoomInfo.getInstance().isHostMode=a.hostType),b(game.MahjongFourFacadeConst.NOTIFY_HOST,a)}function Ka(c){var d=new a.ServerEchoMahjongCmd_SC;c&&(d.id=c.id,d.desc=c.desc),b(game.MahjongFourFacadeConst.SEND_DATA,d,game.DataRequestCommand.GAME_DATA)}function La(a){a.uid==uniLib.UserInfo.uid?b(game.MahjongFourFacadeConst.CHANGE_USERNUM_BACK,a):b(game.MahjongFourFacadeConst.CHANGE_USERNUM_NOTICE,a)}function Ma(a){b(game.MahjongFourFacadeConst.SHOW_CHANGE_BTN)}function Na(a){b(game.MahjongFourFacadeConst.SHOW_READY_BTN)}function Oa(a){var c=[],d=game.RoomInfo.getInstance().getSeatNoByUserId(a.uid);if(c=game.CardInfo.getInstance().getHandCardBySeat(d),ArrayUtil.isInArray(a.thisId,c))return c.splice(c.indexOf(a.thisId),1),void b(game.MahjongFourFacadeConst.VIDEO_REFRESH_HANDCARD,d);var e=game.CardInfo.getInstance().getOutCardBySeat(d),f=ArrayUtil.isInArray(a.thisId,e);if(f)return c.push(a.thisId),e.splice(e.indexOf(a.thisId),1),void b(game.MahjongFourFacadeConst.VIDEO_REFRESH_HANDCARD,d);var g=0;if(!f){for(var h=0;h<4;h++)for(var i=game.CardInfo.getInstance().getOpCardBySeat(h),j=0;j<i.length;j++){var k=i[j];if(k.thisId==a.thisId){g=k.uid;break}}var l=game.RoomInfo.getInstance().getSeatNoByUserId(g),m=game.CardInfo.getInstance().getOpCardBySeat(l);c=game.CardInfo.getInstance().getHandCardBySeat(l);for(var h=0;h<m.length;h++)if(m[h].thisId==a.thisId){var n=m[h];c.concat(n.cardSet),m.splice(h,1);break}0!=g&&b(game.MahjongFourFacadeConst.VIDEO_REFRESH_HANDCARD,l)}}function Pa(a){1017==MJLobby.MJLobbyData.getInstance().lobbyId&&b(game.MahjongFourFacadeConst.CHANGE_REMAINDER_COUNT,a),b(game.MahjongFourFacadeConst.TIMEOUT_WAIT,a)}function Qa(a){b(game.MahjongFourFacadeConst.DZHN_ACTION,a)}function Ra(a){game.RoomInfo.getInstance().changeUserGPS(a),b(game.MahjongFourFacadeConst.GET_GPS,a)}function Sa(a){1!=game.RoomInfo.getInstance().video&&b(game.MahjongFourFacadeConst.PLAY_BUTTON,a)}function Ta(a){b(game.MahjongFourFacadeConst.PLAY_BUTTON_BRD,a)}function Ua(a){b(game.MahjongFourFacadeConst.TWO_MAHJIONG_BACK,a)}function Va(a){b(game.MahjongFourFacadeConst.TWO_MAHJIONG_DOUBLE,a)}function Wa(a){b(game.MahjongFourFacadeConst.CHECK_CONDITION,a)}function Xa(a){b(game.MahjongFourFacadeConst.SICHUAN_BANKRUPTCY,a)}function Ya(a){b(game.MahjongFourFacadeConst.SICHUAN_BANKRUPTCY_BACK,a)}function Za(a){b(game.MahjongFourFacadeConst.NANCHANG_XIAGOLDCARD_BRD,a)}function $a(a){1!=game.RoomInfo.getInstance().video&&b(game.MahjongFourFacadeConst.SICHUAN_BUYCARD,a)}function _a(a){b(game.MahjongFourFacadeConst.START_SELECTCARD,a)}function ab(a){b(game.MahjongFourFacadeConst.SELECT_CARD,a)}function bb(a){b(game.MahjongFourFacadeConst.ZHANGPU_QITAIZI)}function cb(a){b(game.MahjongFourFacadeConst.VIDEO_REQUEST,a)}function db(a){b(game.MahjongFourFacadeConst.VIDEO_RESULT,a)}function eb(a){b(game.MahjongFourFacadeConst.VIDEO_CLOST,a)}function fb(a){a.ownerid&&a.ownerid!=game.RoomInfo.getInstance().videoUid||b(game.MahjongFourFacadeConst.WANZHOU_CHANGECARD,a)}function gb(a){b(game.MahjongFourFacadeConst.WANZHOU_BUYCARD,a)}function hb(a){b(game.MahjongFourFacadeConst.WANZHOU_WINDATA,a)}function ib(a){b(game.MahjongFourFacadeConst.KOU_NOTICE,a)}function jb(a){b(game.MahjongFourFacadeConst.KOU_WAITLIST,a)}function kb(a){console.error(JSON.stringify(a)),game.CardInfo.getInstance().updataKouCardInfo(a.KouCards),b(game.MahjongFourFacadeConst.OTHER_KOU_UPDATE,a)}function lb(a){if(a.userCard){var c=game.RoomInfo.getInstance().getSeatNoByUserId(a.userCard.uid);if(a.userCard&&a.userCard.handCardSet&&(game.CardInfo.getInstance().userHandCount[c]=a.userCard.handCardSet.length),a.userCard.uid==uniLib.NetMgr.UID)game.CardInfo.getInstance().myCards=a.userCard;else{var d=[];d.push(a.userCard),game.CardInfo.getInstance().setOtherCard(d)}}b(game.MahjongFourFacadeConst.REFRESH_USER_CARDS,a)}function mb(c){if(c.cardId&&c.uid){var d=game.RoomInfo.getInstance().getSeatNoByUserId(c.uid);game.CardInfo.getInstance().setWindOpCardsBySeat(c.uid,c.cardId,c.windCardSet,c.inCardId),0==game.RoomInfo.getInstance().video&&game.RoomInfo.getInstance().GM_Mode&&c.uid!=uniLib.UserInfo.uid&&game.CardInfo.getInstance().deleteOtherHand(c.cardId,c.uid),c.uid!=uniLib.UserInfo.uid&&1!=game.RoomInfo.getInstance().video||(game.GameData.getInstance().isCanOperate=!0),c.inCardId||game.CardInfo.getInstance().updateUserHandCount(c.uid,1,1),b(game.MahjongFourFacadeConst.SUPERPOSITION_CARD_NOTICE,c),a.gameDispatch(game.MahjongFourFacadeConst.SELF_HANDCARD_CHANGE),1==game.RoomInfo.getInstance().video&&game.RoomInfo.getInstance().videoUid!=c.uid&&(game.CardInfo.getInstance().deleteOtherHand(c.cardId,c.uid),b(game.MahjongFourFacadeConst.VIDEO_REFRESH_HANDCARD,d))}if(c.opType){var e={};e.opType=c.opType,b(game.MahjongFourFacadeConst.SHOW_ACTION,e)}}function nb(c){if(game.RoomInfo.getInstance().isSettingWindCard=!1,game.CardInfo.getInstance().recommendWindList=[],c.uid&&(c.uid==uniLib.NetMgr.UID?1==c.state&&(game.RoomInfo.getInstance().isSettingWindCard=!0,c.list&&(game.CardInfo.getInstance().recommendWindList=c.list)):game.RoomInfo.getInstance().isSettingWindCard=!1,c.cardList&&c.cardList.cardSet)){var d=new game.OperatVo;d.setWindData(c.uid,c.cardList.cardSet[0]);for(var e=game.RoomInfo.getInstance().getSeatNoByUserId(c.uid),f=0;f<c.cardList.cardSet.length;f++){var g=c.cardList.cardSet[f];game.RoomInfo.getInstance().addShowCard(g)}if(game.CardInfo.getInstance().WindCard(d,c.cardList.cardSet),0==game.RoomInfo.getInstance().video&&game.RoomInfo.getInstance().GM_Mode&&c.uid!=uniLib.UserInfo.uid)for(var h=0;h<c.cardList.cardSet.length;h++)game.CardInfo.getInstance().deleteOtherHand(c.cardList.cardSet[h],c.uid);if(c.uid!=uniLib.UserInfo.uid&&1!=game.RoomInfo.getInstance().video||(game.GameData.getInstance().isCanOperate=!0),game.CardInfo.getInstance().updateUserHandCount(c.uid,c.cardList.cardSet.length,1),b(game.MahjongFourFacadeConst.WIND_CARD_NOTICE,c),a.gameDispatch(game.MahjongFourFacadeConst.SELF_HANDCARD_CHANGE),1==game.RoomInfo.getInstance().video&&game.RoomInfo.getInstance().videoUid!=c.uid){for(var i=0;i<c.cardList.cardSet.length;i++)game.CardInfo.getInstance().deleteOtherHand(c.cardList.cardSet[i],c.uid);b(game.MahjongFourFacadeConst.VIDEO_REFRESH_HANDCARD,e)}}else b(game.MahjongFourFacadeConst.WIND_CARD_NOTICE,c)}function ob(a){b(game.MahjongFourFacadeConst.ADD_BASEPOINT_NOTICE,a)}function pb(a){b(game.MahjongFourFacadeConst.SHOW_TURNGOLD_BTN,a)}function qb(a){a.num&&(game.RoomInfo.getInstance().lieNum=a.num),a.turnType&&(game.RoomInfo.getInstance().turnGoldType=a.turnType),a.direction&&(game.RoomInfo.getInstance().dirtection=a.direction),b(game.MahjongFourFacadeConst.CHOISE_TURNGOLD_NOTICE)}function rb(a){b(game.MahjongFourFacadeConst.SHOW_PASSEGG_NOTICE,a)}function sb(a){b(game.MahjongFourFacadeConst.SET_LAZHUANG_NOTICE,a)}function tb(a){b(game.MahjongFourFacadeConst.GAME_LAZHUANG_NOTICE,a)}function ub(a){b(game.MahjongFourFacadeConst.UPDATE_HUXI,a)}function vb(a){for(var c=a.rs,d=0;d<c.length;d++){var e=c[d];e.score instanceof Array||(e.score=[])}game.RoomInfo.getInstance().roundScore=a.rs,b(game.MahjongFourFacadeConst.ROUND_SCORE_NOTICE,a)}function wb(a){b(game.MahjongFourFacadeConst.CARD_TYPE_WARN_NOTICE,a)}function xb(a){b(game.MahjongFourFacadeConst.NOTICE_WIN_GO,a)}function yb(a){b(game.MahjongFourFacadeConst.ALL_LISTEN_OBJECT,a)}function zb(a){b(game.MahjongFourFacadeConst.RETURN_WAIT_WIN,a)}a.gameDispatch=b,a.OnClientEchoMahjongCmd_SC=c,a.OnMessageBoxLobbyCmd_S=d,a.OnEnterMahjongCmd_S=e,a.OnListenObjMahjongCmd_S=f,a.OnJsonCompressNullUserPmd_CS=g,a.OnEnterMahjongCmd_Brd=h,a.OnLeaveMahjongCmd_Brd=i,a.OnStartMahjongCmd_Brd=j,a.OnStartPiaoMahjongCmd_Brd=k,a.OnReqPiaoMahjongCmd_S=l,a.OnReqPiaoMahjongCmd_Brd=m,a.OnSetBankerMahjongCmd_Brd=n,a.OnSelfCardMahjongCmd_S=o,a.OnStartNewRoundOpCmd_S=p,a.OnStartNewRoundOpCmd_Brd=q,a.OnexChangeCardMahjongCmd_S=r,a.OnexChangeCardMahjongCmd_Brd=s,a.OnOriginalLackOpCmd_S=t,a.OnOriginalLackOpTimeCmd_Brd=u,a.OnOriginalLackOpCmd_Brd=v,a.OnEnsureLackOpCmd_S=w,a.OnEnsureLackOpCmd_Brd=x,a.OnTurnGoldMahjongCmd_Brd=y,a.OnFlowerMahjongCmd_Brd=z,a.OnSendZiCardCmd_S=A,a.OnOutCardSuccessCmd_Brd=B,a.OnSendCardMahjongCmd_S=C,a.OnSendCardMahjongCmd_Brd=D,a.OnOutCardMahjongCmd_S=E,a.OnOutCardMahjongCmd_Brd=F,a.OnRecordOpMahjongCmd_C=G,a.OnRecordOpListMahjongCmd_S=H,a.OnCancelOpMahjongCmd_S=I,a.OnNestleCardMahjongCmd_Brd=J,a.OnLiftCardMahjongCmd_Brd=K,a.OnCompareCardCmd_Brd=L,a.OnBarCardMahjongCmd_Brd=M,a.OnBarCardMahjongCmd_S=N,a.OnBarDiceMahjongCmd_Brd=O,a.OnBarDealCardMahjongCmd_Brd=P,a.OnBarDealCardMahjongCmd_S=Q,a.OnBarOutCardMahjongCmd_Brd=R,a.OnSupplyCardMahjongCmd_S=S,a.OnSupplyCardMahjongCmd_Brd=T,a.OnTouchCardMahjongCmd_Brd=U,a.OnTouchCardMahjongCmd_S=V,a.OnEatCardMahjongCmd_Brd=W,a.OnEatCardMahjongCmd_S=X,a.OnWinMahjongCmd_S=Y,a.OnSkyListenCmd_S=Z,a.OnListenCardMahjongCmd_Brd=$,a.OnWinCardMahjongCmd_Brd=_,a.OnBirdMahjongCmd_Brd=aa,a.OnWinMahjongCmd_Brd=ba,a.OnWinRetMahjongCmd_Brd=ca,a.OnCashChickenCmd_Brd=da,a.OnSeaRoamTurnMahjongCmd_Brd=ea,a.OnSeaFloorCardMahjongCmd_Brd=fa,a.OnReConnectMahjongCmd_S=ga,a.OnReadyStartMahjongCmd_S=ha,a.OnSelectTouHeMahjongCmd_S=ia,a.OnReadyStartMahjongCmd_Brd=ja,a.OnCancelReadyMahjongCmd_Brd=ka,a.OnOnlineStateMahjongCmd_Brd=la,a.OnHeapCardGmMahjongCmd_S=ma,a.OnChangeCardGmMahjongCmd_S=na,a.OnSendGiftMahjongCmd_Brd=oa,a.OnSendGiftMahjongCmd_S=pa,a.OnRefreshChipsMahjongCmd_Brd=qa,a.OnRefreshPointsMahjongCmd_Brd=ra,a.OnGetPersonalPanel_S=sa,a.OnReturnIpAndGPSCmd_S=ta,a.OnStartNewRoundOpTimeCmd_Brd=ua,a.OnFinalScoreMahjongCmd_Brd=va,a.OnRequestDissolveRoom_S=wa,a.OnRequestDissolveRoom_Brd=xa,a.OnSuccessDissolveRoom_Brd=ya,a.OnReplyDissolveRoom_Brd=za,a.OnVoiceChat_Brd=Aa,a.OnCommonChat_Brd=Ba,a.OnVoiceChatRecord_S=Ca,a.OnSetSameIpWarn_S=Da,a.OnSysMessageMahjongCmd_S=Ea,a.OnChangePointMahjongCmd_Brd=Fa,a.OnShowCardMahjongCmd_S=Ga,a.OnShowCardMahjongCmd_Brd=Ha,a.OnHostMahjongCmd_S=Ia,a.OnHostMahjongCmd_Brd=Ja,a.OnServerEchoMahjongCmd_SC=Ka,a.OnRequestChangeUserNbrRoom_Brd=La,a.OnShowChangeUserNbrRoom_S=Ma,a.OnShowPrepareBtnRoom_S=Na,a.OnRecallOneCardMahjongCmd_S=Oa,a.OnTimeOutWaitMahjongCmd_Brd=Pa,a.OnDZHNShowMsgCartoon_S=Qa,a.OnGetGPSLocationCmd_Brd=Ra,a.OnPlayButtonMahjongCmd_S=Sa,a.OnPlayButtonMahjongCmd_Brd=Ta,a.OnDoubleMahjongCmd_S=Ua,a.OnDoubleMahjongCmd_Brd=Va,a.OnCheckMoneyMahjongCmd_S=Wa,a.OnChargeGoldCoinMahjongCmd_Brd=Xa,a.OnGameLoserUidMahjongCmd_Brd=Ya,a.OnXiaGoldCardPointMahjongCmd_Brd=Za,a.OnBuyCardMahjongCmd_Brd=$a,a.OnStartSelectCardMahjong_Brd=_a,a.OnSelectCardMahjong_Brd=ab,a.OnEndPiaoMahjongCmd_Brd=bb,a.OnVideoChatRequestCmd_CS=cb,a.OnVideoChatReturnCmd_CS=db,a.OnVideoChatShutdownCmd_CS=eb,a.OnChangeCardDataMahjong_S=fb,a.OnBuyCardMahjong_Brd=gb,a.OnWinSeatCardDataMahjong_Brd=hb,a.OnKouCardMahjongCmd_CS=ib,a.OnWaitKouSeatMahjongCmd_S=jb,a.OnOtherKouCardMahjongCmd_Brd=kb,a.OnRefreshUserCards_S=lb,a.OnSuperPosition_CS=mb,a.OnSendWindMahjongCmd_CS=nb,a.OnAddBasePoint_Brd=ob,a.OnStartChoiseTurnGoldType_Brd=pb,a.OnChoiseTurnGoldType_Brd=qb,a.OnShowBarCardPassTheEgg_CS=rb,a.OnSetLaZhuangMahjongCmd_Brd=sb,a.OnLaZhuangMahjongCmd_Brd=tb,a.OnUpdateHuXiCmd_Brd=ub,a.OnShowRoundScore_S=vb,a.OnCardTypeWarnMahjong_Brd=wb,a.OnWinGoMahjongCmd_Brd=xb,a.OnAllListenObjMahjongCmd_S=yb,a.OnWaitWinZiCardCmd_CS=zb}(Cmd||(Cmd={}));var Pmd;!function(a){function b(a){game.RoomInfo.getInstance().leftTime=a.lefttime,game.RoomInfo.getInstance().notice=a.desc,Cmd.gameDispatch(game.MahjongFourFacadeConst.STOP_SREVICE_NOTICE,a)}a.OnServerShutDownLoginUserPmd_S=b}(Pmd||(Pmd={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.execute=function(a){a.getBody();this.initController(),this.initProxy(),this.initMediator()},c.prototype.initController=function(){this.facade.registerCommand(a.MahjongFourFacadeConst.SEND_DATA,a.DataRequestCommand),this.facade.registerCommand(a.MahjongFourFacadeConst.DESTORY,a.RemoveCommand)},c.prototype.initMediator=function(){var b=uniLib.getDefinitionByName(a.GameViewConfig.mainMediatorName);a.GameViewConfig.mainMediator=new b,a.MahJongFourFacede.getInstance().registerMediator(a.GameViewConfig.mainMediator)},c.prototype.initProxy=function(){this.facade.registerProxy(new a.ServerMJProxy)},c}(puremvc.MacroCommand);a.StartupMJCommand=b}(game||(game={}));var game;!function(a){var b=function(){function b(){this.allOutCardGroup=[],this.MySelfCardPool=[],this.heapCard=[],this.drawData=null,this.ziDrawData=null,this.eatObj=new Cmd.EatCardObj,this.winCardSet=[],this.freshListenData=!1,this.userHandCount=[],this.dangerSet=[],this.triCard=[],this.barOutCardData=null,this.liangSeat=[0,0,0,0],this.exCardSet=[],this.isStartSend=!1,this.recommendWindList=[],this.initHandCard()}return b.getInstance=function(){return this.instance||(this.instance=new b),this.instance},b.prototype.reloginUserHandCard=function(){for(var b=a.RoomInfo.getInstance().userList,c=0;c<b.length;c++){var d=b[c],e=a.RoomInfo.getInstance().getSeatNoByUserId(d.uid);d.handCardNum?this.userHandCount[e]=d.handCardNum:this.userHandCount[e]=0}},b.prototype.initHandCard=function(){this.triCard=[],this.dangerSet=[],this.liangSeat=[],this.userWinSet=[[],[],[],[]],this.userWindCardBaseIdMap={},this.userWindCardMap={},this.triCardSet=[[],[],[],[]],this.allOpCardSet=[[],[],[],[]],this.allHandCardSet=[[],[],[],[]],this.kouCardInfo=[],this.allOutCardSet=[[],[],[],[]],this.allFlowerCardSet=[[],[],[],[]],this.userHandCount=[],this.allOutCardGroup=[]},Object.defineProperty(b.prototype,"myCards",{set:function(b){if(this.allHandCardSet[0]=[],b.handCardSet&&(this.allHandCardSet[0]=b.handCardSet,a.RoomInfo.getInstance().addShowCardList(b.handCardSet)),this.allOpCardSet[0]=[],this.userWindCardBaseIdMap[0]={},this.userWindCardMap[0]={},b.eatSet)for(var c=0;c<b.eatSet.length;c++){var d=new a.OperatVo;d.setEatData(b.eatSet[c]),this.allOpCardSet[0].push(d),a.RoomInfo.getInstance().addShowCard(b.eatSet[c].one),a.RoomInfo.getInstance().addShowCard(b.eatSet[c].two),a.RoomInfo.getInstance().addShowCard(b.eatSet[c].thisId)}if(b.barSet)for(var c=0;c<b.barSet.length;c++){var d=new a.OperatVo;d.setKongData(b.barSet[c]),202==d.type&&(d.cardSet=this.updataWindCardCount(0,d.cardSet)),this.allOpCardSet[0].push(d),201==b.barSet[c].barType&&202==b.barSet[c].barType||a.RoomInfo.getInstance().addShowCard(b.barSet[c].thisId),a.RoomInfo.getInstance().addShowCardList(b.barSet[c].cardSet)}if(b.touchSet)for(var c=0;c<b.touchSet.length;c++){var d=new a.OperatVo;d.setPongData(b.touchSet[c]),this.allOpCardSet[0].push(d),a.RoomInfo.getInstance().addShowCard(b.touchSet[c].thisId),a.RoomInfo.getInstance().addShowCardList(b.touchSet[c].cardSet)}if(b.windCardSet)for(var c=0;c<b.windCardSet.length;c++){var d=new a.OperatVo;d.setWindData(b.uid,b.windCardSet[c].cardSet[0]),this.userWindCardMap[0]||(this.userWindCardMap[0]={}),this.userWindCardMap[0][d.index]||(this.userWindCardMap[0][d.index]=[]),this.userWindCardMap[0][d.index]=b.windCardSet[c].cardSet,d.cardSet=this.updataWindCardCount(0,b.windCardSet[c].cardSet),this.allOpCardSet[0].push(d),a.RoomInfo.getInstance().addShowCardList(b.windCardSet[c].cardSet)}b.userZiCard&&b.userZiCard instanceof Array&&this.setUserZiCard(b.uid,0,b.userZiCard),this.allOutCardSet[0]=[],b.outCardSet&&(this.allOutCardSet[0]=b.outCardSet,a.RoomInfo.getInstance().addShowCardList(b.outCardSet)),this.allFlowerCardSet[0]=[],b.flowerCardSet&&(this.allFlowerCardSet[0]=b.flowerCardSet,a.RoomInfo.getInstance().addShowCardList(b.flowerCardSet))},enumerable:!0,configurable:!0}),b.prototype.setOtherCard=function(b){for(var c=0;c<b.length;c++){var d=[],e=[],f=[],g=[],h=b[c].uid,i=a.RoomInfo.getInstance().getSeatNoByUserId(h);this.allOpCardSet[i]=[],this.userWindCardBaseIdMap[i]={},this.userWindCardMap[i]={},b[c].handCardSet&&(this.allHandCardSet[i]=b[c].handCardSet),b[c].outCardSet&&(this.allOutCardSet[i]=b[c].outCardSet,a.RoomInfo.getInstance().addShowCardList(b[c].outCardSet)),b[c].flowerCardSet&&(this.allFlowerCardSet[i]=b[c].flowerCardSet,a.RoomInfo.getInstance().addShowCardList(b[c].flowerCardSet)),b[c].touchSet&&(f=b[c].touchSet),b[c].barSet&&(e=b[c].barSet),b[c].eatSet&&(d=b[c].eatSet),b[c].triCardSet&&(this.triCardSet[i]=b[c].triCardSet);for(var j=0;j<f.length;j++){var k=new a.OperatVo;k.setPongData(f[j]),this.allOpCardSet[i].push(k),a.RoomInfo.getInstance().addShowCard(f[j].thisId),a.RoomInfo.getInstance().addShowCardList(f[j].cardSet)}for(var l=0;l<e.length;l++){var m=new a.OperatVo;m.setKongData(e[l]),202==m.type&&(m.cardSet=this.updataWindCardCount(i,m.cardSet)),this.allOpCardSet[i].push(m),a.RoomInfo.getInstance().addShowCard(e[l].thisId),a.RoomInfo.getInstance().addShowCardList(e[l].cardSet)}for(var n=0;n<d.length;n++){var o=new a.OperatVo;o.setEatData(d[n]),this.allOpCardSet[i].push(o),a.RoomInfo.getInstance().addShowCard(d[n].one),a.RoomInfo.getInstance().addShowCard(d[n].two),a.RoomInfo.getInstance().addShowCard(d[n].thisId)}if(b[c].windCardSet){g=b[c].windCardSet;for(var p=0;p<g.length;p++){var q=new a.OperatVo;q.setWindData(h,g[p].cardSet[0]),this.userWindCardMap[i]||(this.userWindCardMap[i]={}),this.userWindCardMap[i][q.index]||(this.userWindCardMap[i][q.index]=[]),this.userWindCardMap[i][q.index]=g[p].cardSet,q.cardSet=this.updataWindCardCount(i,g[p].cardSet),this.allOpCardSet[i].push(q),a.RoomInfo.getInstance().addShowCardList(g[p].cardSet)}}b[c].userZiCard&&b[c].userZiCard instanceof Array&&this.setUserZiCard(h,i,b[c].userZiCard)}},b.prototype.setUserZiCard=function(b,c,d){for(var e=0;e<d.length;e++){var f=d[e],g=new a.OperatVo;g.uid=b,g.setZiData(f,c),this.allOpCardSet[c].push(g),a.RoomInfo.getInstance().addShowCardList(f.cardList)}},b.prototype.deleteOtherHand=function(b,c){var d=a.RoomInfo.getInstance().getSeatNoByUserId(c),e=this.getHandCardBySeat(d);if(e&&-1!=e.indexOf(Number(b)))for(var f=0;f<e.length;f++)if(e[f]==b)return void e.splice(f,1)},b.prototype.addOtherCard=function(b,c){var d=a.RoomInfo.getInstance().getSeatNoByUserId(c),e=this.getHandCardBySeat(d);return this.addCard(b,e)},b.prototype.getHandCardBySeat=function(a){return this.allHandCardSet[a]},b.prototype.updataKouCardInfo=function(a){if(a=null!=a&&a instanceof Array?a:[],0!=a.length)if(0==this.kouCardInfo.length)for(var b=0,c=a;b<c.length;b++){var d=c[b],e=new Cmd.KouCardInfo;e.infoType=d.infoType,e.kouCount=d.kouCount,e.uid=d.uid,this.kouCardInfo.push(e)}else for(var f=0;f<this.kouCardInfo.length;f++)for(var g=0;g<a.length;g++)if(this.kouCardInfo[f].uid==a[g].uid)this.kouCardInfo[f].kouCount=a[g].kouCount,this.kouCardInfo[f].infoType=a[g].infoType;else{var h=new Cmd.KouCardInfo;h.infoType=a[g].infoType,h.kouCount=a[g].kouCount,h.uid=a[g].uid,this.kouCardInfo.push(h)}},b.prototype.getKouCardNumBySeatId=function(b){for(var c=0,d=0;d<this.kouCardInfo.length;d++){var e=this.kouCardInfo[d],f=a.RoomInfo.getInstance().getSeatNoByUserId(e.uid);null!=f&&b==f&&(c=e.kouCount)}return c},b.prototype.getOpCardBySeat=function(a){return this.allOpCardSet[a]},b.prototype.setWindOpCardsBySeat=function(b,c,d,e){var f=a.RoomInfo.getInstance().getSeatNoByUserId(b);0==f&&(e?this.changeCard(e,c):this.removeMyCard(c));var g=this.allOpCardSet[f];if(g&&g.length>0)for(var h=0;h<g.length;h++){var i=g[h];if(-1!=d.cardSet.indexOf(i.index))return this.userWindCardMap[f]||(this.userWindCardMap[f]={}),this.userWindCardMap[f][i.index]||(this.userWindCardMap[f][i.index]=[]),this.userWindCardMap[f][i.index]=d.cardSet,i.cardSet=this.updataWindCardCount(f,d.cardSet),void(this.allOpCardSet[f][h]=i)}},b.prototype.updataWindCardCount=function(a,b){if(!b||b.length<1)return[];var c=[];this.userWindCardBaseIdMap[a]||(this.userWindCardBaseIdMap[a]={});for(var d=0;d<b.length;d++){var e=b[d],f=Math.floor(e/10);1==this.getSameCard(f,c)?this.userWindCardBaseIdMap[a][f]+=1:(c.push(e),this.userWindCardBaseIdMap[a][f]=1)}return b=c,c},b.prototype.getOutCardBySeat=function(a){return this.allOutCardSet[a]},b.prototype.getFlowerCardBySeat=function(a){return this.allFlowerCardSet[a]},b.prototype.addFlowerCardByUid=function(b,c){var d=a.RoomInfo.getInstance().getSeatNoByUserId(c),e=this.getFlowerCardBySeat(d);this.addCard(b,e)},b.prototype.addCard=function(a,b){if(!(b&&b instanceof Array))return!1;for(var c=!1,d=0;d<b.length;d++)if(b[d]==a)return c=!0;return 0==c&&b.push(a),c},b.prototype.removeCard=function(a,b){if(!(b&&b instanceof Array))return!1;for(var c=0;c<b.length;c++)if(b[c]==a)return b.splice(c,1),!0},b.prototype.addMyCard=function(b,c){void 0===c&&(c=!1);var d=this.getHandCardBySeat(0),e=this.addCard(b,d);return e||Cmd.gameDispatch(a.MahjongFourFacadeConst.SELF_HANDCARD_CHANGE,b),c&&Cmd.gameDispatch(a.MahjongFourFacadeConst.SELF_HANDCARD_CHANGE),e},b.prototype.removeMyCard=function(a){for(var b=this.getHandCardBySeat(0),c=0;c<b.length;c++)if(b[c]==a)return b.splice(c,1),!0;return!1},b.prototype.pongCard=function(a){if(a.uid==uniLib.UserInfo.uid)for(var b=0;b<a.cardSet.length;b++)this.removeMyCard(a.cardSet[b]);this.getOpCardBySeat(a.seatId).push(a)},b.prototype.kongCard=function(c){if(c.uid==uniLib.UserInfo.uid)for(var d=0;d<c.cardSet.length;d++)this.removeMyCard(c.thisId),this.removeMyCard(c.cardSet[d]);if(c.type==Cmd.MahjongOpCardType.MahjongOpCardType_BarTouch||c.type==Cmd.MahjongOpCardType.MahjongOpCardType_SupplyTouch)for(var e=0;e<a.RoomInfo.getInstance().userList.length;e++)if(a.RoomInfo.getInstance().userList[e].uid==c.uid)for(var f=b.getInstance().getOpCardBySeat(c.seatId),g=0;g<f.length;g++){var h=f[g];if(ArrayUtil.isInArray(h.thisId,c.cardSet)){f.splice(g,1);break}}if(202==c.type){for(var i=this.allOpCardSet[c.seatId],j=0;j<i.length;j++)if(202==i[j].type){i.splice(j,1);break}var k=this.updataWindCardCount(c.seatId,c.cardSet);k&&k.length>0&&(c.cardSet=k)}this.getOpCardBySeat(c.seatId).push(c)},b.prototype.WindCard=function(b,c){if(b.uid==uniLib.UserInfo.uid)for(var d=0;d<c.length;d++){var e=c[d];this.removeMyCard(e)}var f=a.RoomInfo.getInstance().getSeatNoByUserId(b.uid);this.userWindCardMap[f]||(this.userWindCardMap[f]={}),this.userWindCardMap[f][b.index]||(this.userWindCardMap[f][b.index]=[]),this.userWindCardMap[f][b.index]=c,b.cardSet=this.updataWindCardCount(f,c),this.getOpCardBySeat(b.seatId).push(b)},b.prototype.getSameCard=function(a,b){if(!b||b.length<1)return!1;for(var c=0;c<b.length;c++)if(Math.floor(b[c]/10)==a)return!0;return!1},b.prototype.discard=function(b,c,d){void 0===d&&(d=!0);var e=a.RoomInfo.getInstance().getSeatNoByUserId(b);if(d&&this.addCard(c,this.getOutCardBySeat(e)),b==uniLib.UserInfo.uid){this.removeMyCard(c)&&Cmd.gameDispatch(a.MahjongFourFacadeConst.SELF_HANDCARD_CHANGE);a.CardInfo.getInstance().getHandCardBySeat(0).length%3>1&&(a.CardInfo.getInstance().removeFlowerCard(),Cmd.gameDispatch(a.MahjongFourFacadeConst.SELF_HANDCARD_CHANGE))}},b.prototype.updateHeapCard=function(a,b){for(var c=this.heapCard,d=c.length,e=0;e<d;e++)c[e]==b&&c.splice(e,1);c.push(a)},b.prototype.changeCard=function(a,b){for(var c=this.getHandCardBySeat(0),d=0;d<c.length;d++)if(c[d]==a)return c.splice(d,1),void c.push(b)},b.prototype.updateUserHandCount=function(b,c,d){var e;e=4037==a.RoomInfo.getInstance().gameId||4077==a.RoomInfo.getInstance().gameId||4088==a.RoomInfo.getInstance().gameId||4031==a.RoomInfo.getInstance().gameId||4036==a.RoomInfo.getInstance().gameId||4104==a.RoomInfo.getInstance().gameId||4105==a.RoomInfo.getInstance().gameId||4122==a.RoomInfo.getInstance().gameId||4123==a.RoomInfo.getInstance().gameId||16==a.RoomInfo.getInstance().handCardNum?17:13!=a.RoomInfo.getInstance().handCardNum?a.RoomInfo.getInstance().handCardNum+1:14;var f=a.RoomInfo.getInstance().getSeatNoByUserId(b),g=this.userHandCount[f];0==d?g<e&&(this.userHandCount[f]=g+c):this.userHandCount[f]=g-c},b.prototype.removeFlowerCard=function(){for(var a=this.getHandCardBySeat(0),b=0;b<a.length;b++)if(a[b]>500)return a.splice(b,1),!0;return!1},b.prototype.addTriCard=function(a){for(var b=!1,c=0;c<this.triCard.length;c++)if(this.triCard[c]==a)return b=!0,void this.triCard.splice(c,1);b||this.triCard.push(a)},b.prototype.searchFlower=function(a){for(var b=0;b<a.length;b++)if(a[b]>500)return!0;return!1},b}();a.CardInfo=b}(game||(game={}));var game;!function(a){var b=function(){function a(){}return a.getHandleCards=function(a){for(var b=new Array,c=0;c<a.handCardSet.length;c++)a.handCardSet[c]&&b.push(a.handCardSet[c]);for(var c=0;c<a.flowerCardSet.length;c++)a.flowerCardSet[c]&&b.push(a.flowerCardSet[c]);return b},a}();a.CardUtils=b}(game||(game={}));var game;!function(a){var b=function(){function a(){}return a.defaultWidth=1280,a.defaultHeight=720,a.path="",a.destroyResOnExit=!1,a}();a.DataCache=b}(game||(game={}));var game;!function(a){var b=function(){function a(){}return a.prototype.destory=function(){a.main=null,a.stage=null,a.mainUILayer=null,a.uiLayer=null,a.topLayer=null,a.manage=null},a.isAllSceneApa=function(){return!(!this.main||!this.main.parent||0==this.main.parent.x)},a}();a.GameInfo=b}(game||(game={}));var game;!function(a){var b=function(){function a(){}return a.getInstance=function(){return this.instance||(this.instance=new a),this.instance},a.prototype.setData=function(a){this.userId=a.uid,this.gender=a.gender,this.remainder=a.points,this.nickName=a.nickname},a}();a.MyUserInfo=b}(game||(game={}));var game;!function(a){var b=function(){function a(){}return a.seatPosArr=[new egret.Point(30,455),new egret.Point(1156,264),new egret.Point(954,11),new egret.Point(30,264)],a.wallCardPosArr=[new egret.Point(243,94),new egret.Point(902,73),new egret.Point(855,443),new egret.Point(183,476)],a.listenPosArr=[new egret.Point(577,520),new egret.Point(826,292),new egret.Point(577,103),new egret.Point(405,292)],a.cardSpaceXArr=[36,0,-36,0],a.cardSpaceYArr=[0,24,0,-24],a.cardsRowNum=18,a.cardsTotalNum=144,a}();a.PositionData=b}(game||(game={}));var game;!function(a){var b=function(){function b(){this.video=0,this.videoUid=0,this.gameId=0,this.houseOwnerUID=0,this.RoomSocreType=0,this.baseSore=0,this.defaultOpCount=0,this.defaultOutCount=0,this.kickTime=0,this.payMode=0,this.playType=0,this.curNumber=1,this.totalNumber=1,this.roomDesc="",this.heapCardNum=0,this.remainderCardCount=0,this.isStart=!1,this.disturbSwitch=!1,this.isShowGMTool=!1,this.GM_Mode=!1,this.host_mode=0,this.playerNumber=4,this.goldenCard=[],this.userList=[],this.languageMode="pu",this.tableclothMode="green",this.tableMode=0,this._bankerId=-1,this.xingId=-1,this.bankerSeatId=-1,this.chipsSets=[],this.huID=0,this.roomIdType=0,this.canHostMode=1,this.isNewIn=!1,this.isHostMode=0,this.outCardSuccArr=[],this._gameName="",this.pointSet=[],this.bankerNum=0,this.betPoint=0,this.displayCard=[],this.flcard=[],this.isKnock=!1,this.buyHorse=!1,this.roomType=0,this.isYuanQue=!1,this.dqCardType=0,this.isSpecialCard=0,this.isListen=!1,this.clickListen=!1,this.isMask=!1,this.changeHandCard=!1,this.isSettingWindCard=!1,this.isdouble=0,this.changeType=[],this.exCardSuccArr=[],this.zhuojiID=0,this.upChicnkenID=0,this.userHandCard=[],this.isTip=!1,this.singleChicnken=1,this.chicnkenSet=[],this.downChicnkenID=0,this.diceTime=1,this.gameID=0,this.selfWin=!1,this.firstReady=!0,this.lastShangGa=0,this._HuiZhouFlowerNum=8,this._flbarUser=[],this.idDarkBar=1,this.isBao=!1,this.multiple=0,this.isTween=!1,this.curJiao=0,this.curRound=0,this.isJiaoFen=!1,this.bGetNum=0,this.eGetNum=0,this.goldCardNum=0,this.isHu=!1,this.handCardNum=13,this.drawType=0,this.lieNum=1,this.dirtection=1,this.turnGoldType=1,this.soundRandomNum=3,this.flowerType=0,this.drawMode=0,this.roundScore=[],this.showRoundScore=!1,this.liangUser=[]}return Object.defineProperty(b.prototype,"isCoinMode",{get:function(){return!!(this.playTypeList&&this.playTypeList instanceof Array&&this.playTypeList.indexOf(95)>0)},enumerable:!0,configurable:!0}),b.getInstance=function(){return this.instance||(this.instance=new b),this.instance},b.destory=function(){this.instance&&(this.instance=null)},b.prototype.setData=function(a){this.initData(),this.userList=[],this.roomId=a.roomId,this.opCount=a.opCount,this.defaultOpCount=a.opCount,this.outCount=a.outCount,this.defaultOutCount=a.outCount,this.kickTime=a.kickTime,this.readyUsers=a.prepareSet,this.initRoomProps(a.roomProps),this.musicSetInfo=a.setInfo,this.initUserList(a.userInfoSet),this.playTypeList=[],this.playTypeList=a.props,a.darkBar&&(this.idDarkBar=a.darkBar),this.getPlayTypeByList(),this.getHostMode(),this.setGoldenMj(),a.roomType?this.roomIdType=a.roomType:this.roomIdType=0,this.minMatchPoint=a.minMatchPoint,this.bottomPoint=a.bottomPoint,this.leavingPoint=a.leavingPoint,this.enteringPoint=a.enteringPoint},b.prototype.getRoomType=function(){return this.roomId<1e5?2:this.roomIdType},b.prototype.initData=function(){this.playType=0},Object.defineProperty(b.prototype,"bankerId",{get:function(){return this._bankerId},set:function(a){this._bankerId=a,4==this.playerNumber&&this.setXingId()},enumerable:!0,configurable:!0}),b.prototype.setXingId=function(){var a=this.getSeatNoByUserId(this.bankerId);if(null!=a){var b=this.getUserIdBySeatNo((a+2)%4);this.xingId=b||-1}},b.prototype.setBankerInfo=function(a){this.bankerId=a,this.bankerSeatId=this.getSeatNoByUserId(a),this.last_SendCardMahjong=null,this.last_OutCardMahjong=null,this.showCardThisIdMap={},this.showCardBaseIdMap={}},b.prototype.addShowCardList=function(a){if(!a)return!1;for(var b=0;b<a.length;b++)this.addShowCard(a[b]);return!0},b.prototype.addShowCard=function(b,c){if(this.showCardThisIdMap[b])return!1;this.showCardThisIdMap[b]=1;var d=Math.floor(b/10);return this.showCardBaseIdMap[d]?this.showCardBaseIdMap[d]+=1:this.showCardBaseIdMap[d]=1,c?this.subRemainCardNum():Cmd.gameDispatch(a.MahjongFourFacadeConst.LASTCARD_CHANGE),!0},b.prototype.getShowCardRemainNum=function(a){var b=a,c=4;return b>100&&(b=Math.floor(b/10)),48==b&&(c=this._HuiZhouFlowerNum),this.showCardBaseIdMap&&this.showCardBaseIdMap[b]?c-this.showCardBaseIdMap[b]:c},b.prototype.subRemainCardNum=function(){this.setRemainCardNum(this.getRemainCardNum()-1)},b.prototype.setRemainCardNum=function(b){!b&&0!=b||this.heapCardNum==b||(this.heapCardNum=b,Cmd.gameDispatch(a.MahjongFourFacadeConst.LASTCARD_CHANGE))},b.prototype.getRemainCardNum=function(){return this.heapCardNum<=0?0:this.heapCardNum},b.prototype.setRemainderCardCount=function(b){this.remainderCardCount!=b&&(this.remainderCardCount=b,Cmd.gameDispatch(a.MahjongFourFacadeConst.CHANGE_REMAINDER_COUNT))},b.prototype.getRemainderCardCount=function(){return this.remainderCardCount<=0?0:this.remainderCardCount},b.prototype.initRoomProps=function(a){if(a&&!(a.length<=0))for(var b=0;b<a.length;b++)a[b].value||(a[b].value=0),102==a[b].id&&(this.roomType=a[b].value),a[b].id==Cmd.RoomPro.RoomPro_1&&(this.totalNumber=a[b].value),a[b].id==Cmd.RoomPro.RoomPro_2&&(this.playType=a[b].value),a[b].id==Cmd.RoomPro.RoomPro_3&&(this.playerNumber=a[b].value),a[b].id==Cmd.RoomPro.RoomPro_4&&(this.payMode=a[b].value),a[b].id==Cmd.RoomPro.RoomPro_5&&(this.goldMulti=a[b].value),a[b].id==Cmd.RoomPro.RoomPro_6&&(this.canHostMode=a[b].value),100==a[b].id&&(this.playType=a[b].value),101==a[b].id&&(this.playType=a[b].value),103==a[b].id&&(this.multiple=a[b].value),105==a[b].id&&(2==a[b].value?this.isJiaoFen=!0:this.isJiaoFen=!1)},b.prototype.initUserList=function(b){for(var c=0;c<b.length;c++){var d=b[c],e=new a.UserVo(d);this.userList.push(e)}},b.prototype.addUser=function(a){for(var b=0;b<this.userList.length;b++)if(this.userList[b].uid==a.uid)return void(this.userList[b]=a);this.userList.push(a)},b.prototype.getUserVoByUid=function(b){var c=new Cmd.UserBaseInfo;c.uid=111111,c.gender="女",c.nickname="111111";for(var d=new a.UserVo(c),e=0;e<this.userList.length;e++)if(this.userList[e].uid==b)return this.userList[e];for(var e=0;e<this.userList.length;e++)if(1==this.userList[e].seatId)return this.userList[e];return console.error(">>>>>>不明身份人士混入房间:"+b),d},b.prototype.removeUser=function(a){for(var b=0;b<this.userList.length;b++)if(this.userList[b].uid==a){this.userList.splice(b,1);break}},b.prototype.getSeatNo=function(c){var d=uniLib.UserInfo.uid;return 1==a.RoomInfo.getInstance().video&&(d=a.RoomInfo.getInstance().videoUid),(c+4-b.getInstance().getUserVoByUid(d).seatId)%4},b.prototype.getSeatNoByUserId=function(a){var b=this.getUserVoByUid(a);if(b){var c=b.seatId;return this.getSeatNo(c)}return 0},b.prototype.getUserIdBySid=function(a){for(var b=0;b<this.userList.length;b++)if(this.userList[b].sid==a)return this.userList[b].uid;return 0},b.prototype.getUserIdBySeatNo=function(a){for(var b=0;b<this.userList.length;b++)if(this.getSeatNo(this.userList[b].seatId)==a)return this.userList[b].uid;return 0},b.prototype.dirTransToSeat=function(b){return(a.RoomInfo.getInstance().getSeatNoByUserId(a.RoomInfo.getInstance().eastUid)+(b-1))%4},b.prototype.getPayMode=function(){if(1==uniLib.Global.is_sandbox)return"";var a="半自摸";return 1==this.payMode?a="房主支付":2==this.payMode&&(a="均摊支付"),a},b.prototype.getPlayType=function(){if(1==uniLib.Global.is_sandbox)return"";switch(ArrayUtil.isInArray(129,this.playTypeList)?(this._gameName="半自摸",this.playType=1):ArrayUtil.isInArray(128,this.playTypeList)&&(this._gameName="全自摸",this.playType=2),a.RoomInfo.getInstance().gameID){case 4008:this._gameName="遵义麻将";break;case 4001:this._gameName="三丁拐";break;case 4007:this._gameName="毕节麻将";break;case 196:this._gameName="贵阳麻将";break;case 4063:this._gameName="二丁拐"}return this._gameName},b.prototype.setPlayType=function(a){this._gameName=a},b.prototype.setGoldenMj=function(){this.playTypeList&&this.playTypeList.length&&0!=this.playTypeList.length&&(-1!=this.playTypeList.indexOf(c.NoGhost)?this.playType=0:(-1!=this.playTypeList.indexOf(c.WhiteGhost)||-1!=this.playTypeList.indexOf(c.OneGhost)||this.playTypeList.indexOf(c.FourGhosts)||this.playTypeList.indexOf(c.TwoGhosts))&&(this.playType=1),-1!=this.playTypeList.indexOf(c.TwoGhost)&&(this.playType=2),-1!=this.playTypeList.indexOf(c.ZeroFlower)?this._HuiZhouFlowerNum=0:-1!=this.playTypeList.indexOf(c.TwoFlower)?this._HuiZhouFlowerNum=2:-1!=this.playTypeList.indexOf(c.FourFlower)?this._HuiZhouFlowerNum=4:-1!=this.playTypeList.indexOf(c.SixFlower)?this._HuiZhouFlowerNum=6:-1!=this.playTypeList.indexOf(c.EightFlower)&&(this._HuiZhouFlowerNum=8))},b.prototype.getOtherUid=function(){for(var a=[],b=0;b<this.userList.length;b++)this.userList[b].uid!=uniLib.UserInfo.uid&&a.push(this.userList[b].uid);return a},b.prototype.getAllNames=function(){for(var a="",b=0;b<this.userList.length;b++)""!=a&&(a+=","),a+=this.userList[b].nickName;return""!=a&&(a+="已入座"),a},b.prototype.getUidNotSendID=function(a){for(var b=[],c=0;c<this.userList.length;c++)this.userList[c].uid!=a&&b.push(this.userList[c].uid);return b},b.prototype.getPlayTypeByList=function(){if(!RES.hasRes("TablePlayTypeList_json"))return[];var b=[],c="";a.RoomInfo.getInstance().isTip=!1,this.playTypeList&&this.playTypeList.length&&0!=this.playTypeList.length||(this.playTypeList=[]),this.playTypeList.sort(function(a,b){return a>b?1:a==b?0:-1});for(var d=0;d<this.playTypeList.length;d++){if(-1!=this.playTypeList[d].toString().indexOf(".")){var e=this.playTypeList[d].toString().split("."),f=a.TablePlayTypeList.getInstance().getPlayTypeDes(Number(e[0]))+e[1].substr(0,e[1].length-1);c+=f,b.push(f)}var g=a.TablePlayTypeList.getInstance().getPlayTypeDes(this.playTypeList[d]);c=c+g+"   ",b.push(g)}return a.RoomInfo.getInstance().roomDesc=c,b},b.prototype.getHostMode=function(){ArrayUtil.isInArray(144,this.playTypeList),this.canHostMode=1},b.prototype.addLiangUser=function(a){for(var b=0;b<this.liangUser.length;b++)if(this.liangUser[b]==a)return},Object.defineProperty(b.prototype,"myNextUser",{get:function(){var a=this,b=[];this.userList.forEach(function(c){c.uid!=uniLib.UserInfo.uid?b.push(a.getSeatNoByUserId(c.uid)):b.push(1e4)});var c=b.indexOf(Math.min.apply(Math,b));return-1!=c?this.userList[c]:null},enumerable:!0,configurable:!0}),b.prototype.addFlowerCard=function(b){if("number"==typeof b){a.RoomInfo.getInstance().flcard=[];for(var c=0;c<4;c++){var d=Number(b.toString()+(c+1).toString());a.RoomInfo.getInstance().flcard.push(d)}a.RoomInfo.getInstance().flcard=a.RoomInfo.getInstance().flcard.slice()}},b.prototype.changeUserGPS=function(a){for(var b=0;b<this.userList.length;b++)a.uid==this.userList[b].uid&&this.userList[b].setGPS(a.lng,a.lat,a.address)},b.prototype.getEnguneVersion=function(){return Number(egret.Capabilities.engineVersion.substr(0,1))},b.prototype.setCashChicken=function(a){this.cashChicken=[];for(var b=0,c=a.length;b<c;b++)this.cashChicken[b]=new Cmd.ChickenStruct,this.cashChicken[b].uid=a[b][0],this.cashChicken[b].myself_grade=a[b][1],this.cashChicken[b].others_grade=a[b][2],this.cashChicken[b].rush_chicken=a[b][3],this.cashChicken[b].response_chicken=a[b][4],this.cashChicken[b].up_baseid=a[b][5],this.cashChicken[b].down_baseid=a[b][6],this.cashChicken[b].up_chicken=a[b][7],this.cashChicken[b].down_chicken=a[b][8],this.cashChicken[b].dark=a[b][9],this.cashChicken[b].light=a[b][10],this.cashChicken[b].climb=a[b][11],this.cashChicken[b].is_listen=Boolean(a[b][12]),this.cashChicken[b].lack=a[b][13],this.cashChicken[b].originalLack=a[b][14],this.cashChicken[b].rush_black_chicken=a[b][15],this.cashChicken[b].response_black_chicken=a[b][16],this.cashChicken[b].normal_black_chicken=a[b][17],this.cashChicken[b].up_chicken_num=a[b][18],this.cashChicken[b].down_chicken_num=a[b][19]},b.prototype.initRoundScore=function(){if(!(this.roundScore.length>0))for(var a=0;a<this.userList.length;a++){var b=this.userList[a],c=new Cmd.RoundScore;c.uid=b.uid,c.score=[],this.roundScore.push(c)}},b.prototype.checkFastDragon=function(){return"5"==egret.Capabilities.engineVersion.substr(0,1)},b.prototype.isZqGame=function(){return a.RoomInfo.getInstance().gameId<5e3},b}();a.RoomInfo=b;var c=function(){function a(){}return a.NoGhost=111,a.WhiteGhost=112,a.OneGhost=113,a.TwoGhost=114,a.FourGhosts=231,a.TwoGhosts=253,a.ZeroFlower=132,a.TwoFlower=133,a.FourFlower=134,a.SixFlower=135,a.EightFlower=136,a}();a.PlayStyle=c}(game||(game={}));var game;!function(a){var b=function(){function b(){this._isMyTime=!1,this._isCanOperate=!1,this.goldOutCardSet=[],this._audioPlayMode=!1,this.waitCard=0,this.lastCard=0,this.TempeLocation=[[(uniLib.Global.screenWidth-1136)/2+525,405],[(uniLib.Global.screenWidth-1136)/2+860,235],[(uniLib.Global.screenWidth-1136)/2+525,85],[(uniLib.Global.screenWidth-1136)/2+200,235]],this.ShortTalkArr=["又断线了，网络怎么这么差啊！","各位，真不好意思，我要离开一会","你的牌打得也忒好了！","下次咱们再玩吧！","不要走，决战到天亮！","快点吧，都等得我花都谢了！"],this.libVideoPanelY=uniLib.Global.screenHeight/2+67}return b.prototype.destory=function(){b.instance=null},b.getInstance=function(){return this.instance||(this.instance=new b),this.instance},Object.defineProperty(b.prototype,"isMyTime",{get:function(){return this._isMyTime},set:function(a){this._isMyTime=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"isCanOperate",{get:function(){return this._isCanOperate},set:function(a){this._isCanOperate=a,1==this._audioPlayMode&&(1==this._isCanOperate?AutoPlayMgr.instance.startAutoRecord():AutoPlayMgr.instance.stopAutoRecord())},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"audioPlayMode",{get:function(){return this._audioPlayMode},set:function(a){this._audioPlayMode=a},enumerable:!0,configurable:!0}),b.prototype.isGoldenCard=function(b){var c=a.RoomInfo.getInstance().goldenCard;if(a.RoomInfo.getInstance().goldenCard.length<=0)return!1;for(var d=0;d<c.length;d++)if(table.TableCard.thisIdToCardId(b)==table.TableCard.thisIdToCardId(c[d]))return!0;return!1},b.prototype.isDangerCard=function(b){var c=a.CardInfo.getInstance().dangerSet;if(c.length<=0)return!1;for(var d=0;d<c.length;d++)if(table.TableCard.thisIdToCardId(b)==table.TableCard.thisIdToCardId(c[d]))return!0},b.iskPoker=!1,b}();a.GameData=b}(game||(game={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(b){function c(){b.call(this,c.NAME)}return __extends(c,b),c.prototype.onRegister=function(){},c.prototype.initServer=function(){uniLib.UIMgr.instance.showProcessBar(null,99,100,"正在连接游戏服务器...","",!0);var b=Number(uniLib.BrowersUtils.GetRequest("gameId")),c=Number(uniLib.BrowersUtils.GetRequest("zoneId"));null==a.DataCache.gameInfo||null==a.DataCache.gameInfo.zoneInfo?(this._config=RES.getRes("config_json"),uniLib.NetMgr.init(this._config.LoginUrl,b||this._config.GameID,c||this._config.ZoneID,this.onHttpInitSucc,this.onHttpInitFail,this),this.gameId=b||this._config.GameID):(uniLib.NetMgr.init(uniLib.Global.defaultConfig.login_url,a.DataCache.gameInfo.zoneInfo.gameid,a.DataCache.gameInfo.zoneInfo.zoneid,this.onHttpInitSucc,this.onHttpInitFail,this),this.gameId=a.DataCache.gameInfo.zoneInfo.gameid),a.GameData.iskPoker&&a.NetworkTimeOut&&1==a.NetworkTimeOut.open&&a.NetworkTimeOut.up(5e3,15e3)},c.prototype.onHttpInitSucc=function(b){1==a.RoomInfo.getInstance().video?(this.loopback=!0,uniLib.NetMgr.initSocket(this.onSockInitSucc,this.onSockInitFail,this,"","","",!1,!0)):uniLib.NetMgr.initSocket(this.onSockInitSucc,this.onSockInitFail,this,"","","",!1,!0,uniLib.Global.gameGatewayUrl)},c.prototype.onHttpInitFail=function(b){return b?a.PublicManage.getInstance().showMildWarnShow("游戏登录失败:"+JSON.stringify(b)):a.PublicManage.getInstance().showMildWarnShow("游戏登录失败"),this.facade.sendNotification(a.MahjongFourFacadeConst.EXIT_GAME),!0},c.prototype.onSockInitSucc=function(){uniLib.UIMgr.instance.showProcessBar(null,100,100,"正在进入房间...","",!0);var b;if(a.GameData.iskPoker){var c=new Cmd.GameTimeSyncCmd_CS;uniLib.NetMgr.tcpSend(c),b=new Cmd.EnterRoomCmd_C}else b=new Cmd.EnterMahjongCmd_C;var d=Number(uniLib.BrowersUtils.GetRequest("roomId")),e=Number(uniLib.BrowersUtils.GetRequest("handCardInitId")),f=Number(uniLib.BrowersUtils.GetRequest("recordUid")),g=Number(uniLib.BrowersUtils.GetRequest("game")),h=Number(uniLib.BrowersUtils.GetRequest("robotId")),i=Number(uniLib.BrowersUtils.GetRequest("robotNum")),j=Number(uniLib.BrowersUtils.GetRequest("subGameType"));b.roomId=d||0,b.globalRoomId=d||111111,h>0&&(b.robotId=h),e>0&&(b.handCardInitId=e),i>0&&(b.robotNum=i),g>0&&(b.gameId=g),j>0&&(b.subGameType=j),f>0&&(b.recordUid=f),a.DataCache.platParam&&(b.globalRoomId=a.DataCache.platParam.globalRoomId,b.roomId=a.DataCache.platParam.roomId),this.sendData(b),console.error("gps"+a.RoomInfo.getInstance().isGPS),a.RoomInfo.getInstance().isGPS&&0==a.RoomInfo.getInstance().video?(console.error("请求定位"),this._location=uniLib.ZQGameSdk.getLocation(this.onGetLocation,this)):a.RoomInfo.getInstance().isGPS=!1,uniLib.Global.lastPingUpTimestamp=Date.now(),uniLib.Global.jsonCompressDefault||(uniLib.Global.jsonCompressDefault=new Cmd.JsonCompressNullUserPmd_CS,uniLib.Global.jsonCompressDefault.msglist=["Cmd.OutCardMahjongCmd_Brd","Cmd.OutCardMahjongCmd_S","Cmd.SelfCardMahjongCmd_S","Cmd.ReadyStartMahjongCmd_Brd","Cmd.ReadyStartMahjongCmd_S","Cmd.BarOutCardMahjongCmd_Brd","Cmd.BarCardMahjongCmd_Brd","Cmd.SendCardMahjongCmd_Brd","Cmd.SendCardMahjongCmd_S","Cmd.SetBankerMahjongCmd_Brd","Cmd.EnterMahjongCmd_Brd","Cmd.EnterMahjongCmd_S","Cmd.FinalScoreMahjongCmd_Brd","Cmd.GetPersonalPanel_S","Cmd.HostMahjongCmd_Brd","Cmd.SysMessageMahjongCmd_S","Cmd.TouchCardMahjongCmd_Brd","Cmd.OnlineStateMahjongCmd_Brd","Cmd.BarCardMahjongCmd_S","Cmd.BarDealCardMahjongCmd_Brd","Cmd.ReConnectMahjongCmd_S","Cmd.BarDealCardMahjongCmd_S","Cmd.BarDiceMahjongCmd_Brd","Cmd.ReplyDissolveRoom_Brd","Cmd.RequestChangeUserNbrRoom_Brd","Cmd.RequestChangeUserNbrRoom_C","Cmd.RequestDissolveRoom_Brd","Cmd.RequestDissolveRoom_S","Cmd.ReturnChangeUserNbrRoom_C","Cmd.SeaFloorCardMahjongCmd_Brd","Cmd.SeaRoamTurnMahjongCmd_Brd","Cmd.BirdMahjongCmd_Brd","Cmd.CancelOpMahjongCmd_S","Cmd.CommonChat_Brd","Cmd.SendGiftMahjongCmd_Brd","Cmd.EatCardMahjongCmd_Brd","Cmd.EatCardMahjongCmd_S","Cmd.ShowChangeUserNbrRoom_S","Cmd.StartMahjongCmd_Brd","Cmd.StartNewRoundOpCmd_Brd","Cmd.StartNewRoundOpCmd_S","Cmd.StartNewRoundOpTimeCmd_Brd","Cmd.SuccessDissolveRoom_Brd","Cmd.SupplyCardMahjongCmd_Brd","Cmd.SupplyCardMahjongCmd_S","Cmd.LeaveMahjongCmd_Brd","Cmd.LeaveMahjongCmd_S","Cmd.TouchCardMahjongCmd_S","Cmd.VoiceChat_Brd","Cmd.WinCardMahjongCmd_Brd","Cmd.WinMahjongCmd_S","Cmd.BarCardMahjongCmd_C","Cmd.BarOpMahjongCmd_C","Cmd.CancelOpMahjongCmd_C","Cmd.CommonChat_C","Cmd.EatCardMahjongCmd_C","Cmd.EnterMahjongCmd_C","Cmd.GetPersonalPanel_C","Cmd.HostMahjongCmd_C","Cmd.LeaveMahjongCmd_C","Cmd.OutCardMahjongCmd_C","Cmd.ReadyStartMahjongCmd_C","Cmd.ReplyDissolveRoom_C","Cmd.RequestDissolveRoom_C","Cmd.SeaRoamMahjongCmd_C","Cmd.SendGiftMahjongCmd_C","Cmd.ServerEchoMahjongCmd_SC","Cmd.SoundSet_C","Cmd.StartNewRoundOpCmd_C","Cmd.SupplyCardMahjongCmd_C","Cmd.TouchCardMahjongCmd_C","Cmd.VoiceChat_C","Cmd.CashChickenCmd_Brd","Cmd.WinMahjongCmd_C","Cmd.ClientEchoMahjongCmd_SC","Cmd.UpdateHuXiCmd_Brd","Cmd.SendZiCardCmd_S","Cmd.OutCardSuccessCmd_Brd","Cmd.WaitWinZiCardCmd_CS","Cmd.LiftCardMahjongCmd_Brd","Cmd.NestleCardMahjongCmd_Brd"],uniLib.Global.jsonCompressDefault.key=""+uniLib.StringUtils.MD5(JSON.stringify(uniLib.Global.jsonCompressDefault.msglist)));var k=new Cmd.JsonCompressNullUserPmd_CS;uniLib.Global.jsonCompress?k.key=uniLib.Global.jsonCompress.key:k.key=uniLib.Global.jsonCompressDefault.key,uniLib.NetMgr.tcpSend(k)},c.prototype.onGetLocation=function(b){console.info("定位"+JSON.stringify(b));var c=new Cmd.GetGPSLocationCmd_C;if(0==b.code){this._location.lng=b.data.longitude,this._location.lat=b.data.latitude,c.lat=this._location.lat,c.lng=this._location.lng;b.data.address&&(c.address=b.data.address)}else c.lat=0,c.lng=0,a.PublicManage.getInstance().showMildWarnShow("未获取到位置信息！");a.RoomInfo.getInstance().isZqGame()?0==b.code&&this.sendData(c):this.sendData(c)},c.prototype.onSockInitFail=function(b){return b?a.PublicManage.getInstance().showMildWarnShow("游戏服务器连接失败:"+JSON.stringify(b)):a.PublicManage.getInstance().showMildWarnShow("游戏服务器连接失败"),this.facade.sendNotification(a.MahjongFourFacadeConst.EXIT_GAME),!0},c.prototype.sendData=function(b){if(1==a.RoomInfo.getInstance().video&&uniLib.Global.dispatchEvent(uniLib.ZqEvent.EVENT_G2L,"game_load_start"),a.ResUtil.trace("sendData:"+JSON.stringify(b)),uniLib.NetMgr.ws&&uniLib.NetMgr.tcpSend(b),uniLib.NetMgr.setMsgTimeout(8,"ServerMJProxy.sendData"),"Cmd.OutCardMahjongCmd_C"==b.GetType()){var c=a.RoomInfo.getInstance().getUserVoByUid(uniLib.UserInfo.uid),d=table.TableCard.resSound(b.thisId,c.getGender());4077==a.RoomInfo.getInstance().gameId&&(d=""),""!=d&&uniLib.SoundMgr.instance.playSound(d),uniLib.SoundMgr.instance.playSound(a.SoundConsts.DISCARD),uniLib.Global.lastPingUpTimestamp=Date.now()}else"Cmd.ClientEchoMahjongCmd_SC"==b.GetType()&&(uniLib.Global.lastPingUpTimestamp=Date.now())},c.prototype.onPrivateChat=function(a){},c.prototype.onRoomChat=function(a){},c.prototype.onSystemMsg=function(a){},c.prototype.onRemove=function(){b.prototype.onRemove.call(this),uniLib.NetMgr.closeSocket(),a.GameData.getInstance().destory(),uniLib.Global.removeEventListener(uniLib.ZqEvent.ON_RECONNEC,this.onSockInitSucc,this)},c.prototype.closeSocket=function(){a.ResUtil.trace("closeSocket"),uniLib.NetMgr.closeSocket()},c.NAME="ServerMJProxy",c}(puremvc.Proxy);a.ServerMJProxy=b}(game||(game={}));var game;!function(a){var b=function(){function a(a,b){void 0===a&&(a=0),void 0===b&&(b=!1),this.cardId=a,this.isGoldPai=b}return Object.defineProperty(a.prototype,"TableInfo",{get:function(){return null!=this.tableInfo&&this.cardId==this.tableInfo.cardId||(this.tableInfo=table.TableCard.selectByCardId(this.cardId)),this.tableInfo},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"type",{get:function(){return this.TableInfo.type},enumerable:!0,configurable:!0}),a}();a.CardVo=b}(game||(game={}));var game;!function(a){var b=function(){function a(){}return a}();a.KongVo=b}(game||(game={}));var game;!function(a){var b=function(){function b(){this.fake=0}return b.prototype.setPongData=function(b){this.uid=b.uid,this.thisId=b.thisId,this.fromId=b.fromUid,this.cardSet=b.cardSet;var c=this.cardSet.indexOf(this.thisId);-1!=c&&this.cardSet.splice(c,1),this.type=Cmd.MahjongOpCardType.MahjongOpCardType_Touch,this.seatId=a.RoomInfo.getInstance().getSeatNoByUserId(b.uid),this.fromSeatId=a.RoomInfo.getInstance().getSeatNoByUserId(b.fromUid),b.fake?this.fake=b.fake:this.fake=0},b.prototype.setKongData=function(b){this.uid=b.uid,this.thisId=b.thisId,this.fromId=b.fromUid,this.cardSet=b.cardSet,this.type=b.barType,this.seatId=a.RoomInfo.getInstance().getSeatNoByUserId(b.uid),this.fromSeatId=a.RoomInfo.getInstance().getSeatNoByUserId(b.fromUid),b.fake?this.fake=b.fake:this.fake=0},b.prototype.setEatData=function(b){this.uid=b.uid,this.uid=b.uid,this.thisId=b.thisId,this.cardSet=[],this.cardSet.push(b.one),this.cardSet.push(b.two),this.cardSet.sort(function(a,b){return a-b}),this.type=Cmd.MahjongOpCardType.MahjongOpCardType_Eat,this.seatId=a.RoomInfo.getInstance().getSeatNoByUserId(b.uid),this.fromSeatId=a.RoomInfo.getInstance().getSeatNoByUserId(b.fromUid),b.fake?this.fake=b.fake:this.fake=0},b.prototype.setWindData=function(b,c){this.uid=b,this.seatId=a.RoomInfo.getInstance().getSeatNoByUserId(b),this.type=Cmd.MahjongOpCardType.MahjongOpCardType_windCard,this.index=c},b.prototype.setMyOperate=function(b){this.seatId=0,this.type=b.type,this.uid=uniLib.UserInfo.uid,this.thisId=b.thisId,this.fromId=b.fromUid,this.fromSeatId=a.RoomInfo.getInstance().getSeatNoByUserId(b.fromUid)},b.prototype.setZiData=function(b,c){void 0===c&&(c=0),this.thisId=b.cardList[0],this.fromId=b.fromUid?b.fromUid:uniLib.UserInfo.uid,this.seatId=c,this.fromSeatId=a.RoomInfo.getInstance().getSeatNoByUserId(this.fromId),this.cardSet=b.cardList,this.type=b.type},b}();a.OperatVo=b}(game||(game={}));var game;!function(a){var b=function(){function a(a){this.sid=0,this.bReady=0,this.handCardNum=0,this.multiPiao=0,this.jiaofen=0,this.setdata(a)}return a.prototype.setdata=function(a){this.uid=a.uid,a.sid&&(this.sid=a.sid),this.seatId=a.seatId,a.points?this.points=a.points:this.points=0,this.gender=a.gender,this.bReady=a.bReady,this.diamond=a.diamond,this.headUrl=a.headurl,this.chips=a.chips,this.nickName=a.nickname,this.remainder=a.points,this.onlineState=a.onlineState,a.handCardNum?this.handCardNum=a.handCardNum:this.handCardNum=0,a.lat&&(this.lat=a.lat),a.lng&&(this.lng=a.lng),a.address&&(this.address=a.address),a.nju&&(this.nju=a.nju),a.multiPiao?this.multiPiao=a.multiPiao:this.multiPiao=0,null!=a.specialpoints&&null!=a.points&&(this.remainder=a.specialpoints,this.jiaofen=a.points),a.vip?this.vip=a.vip:this.vip=0,a.ip&&(this.ip=a.ip),a.personalImage&&(this.personalImage=a.personalImage),a.userBasePoints&&a.userBasePoints instanceof Array&&(this.basePoints=a.userBasePoints),this.outLineSec=a.sec},a.prototype.setdiamond=function(a){this.diamond=a},a.prototype.setchips=function(a){this.chips=a},a.prototype.getGender=function(){return"男"==this.gender?0:1},a.prototype.setGPS=function(a,b,c){void 0===c&&(c=null),this.lng=a,this.lat=b,this.address=c},a}();a.UserVo=b}(game||(game={}));var game;!function(a){var b=function(){function a(){}return a}();a.VoiceDataVo=b}(game||(game={}));var game;!function(a){var b=function(){function a(){}return a}();a.GameViewConfig=b}(game||(game={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.initUI=function(){this.bg=a.ResUtil.createBitmapByName("setting_checkbg"),this.addChild(this.bg),this._checkIcon=a.ResUtil.createBitmapByName("setting_check",16,16),this.addChild(this._checkIcon),this.check=!1},Object.defineProperty(c.prototype,"check",{set:function(a){this._check=a,this._checkIcon.visible=a},enumerable:!0,configurable:!0}),c.prototype.seTTexture=function(b,c){void 0===b&&(b=null),void 0===c&&(c=null),b&&(this.bg.texture=a.ResUtil.createTexture(b)),c&&(this._checkIcon.texture=a.ResUtil.createTexture(c))},c.prototype.destory=function(){uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this._checkIcon=null},c.prototype.updateIconPos=function(a,b){this._checkIcon&&(this._checkIcon.x=a,this._checkIcon.y=b)},c}(a.BaseVc);a.CheckMc=b}(game||(game={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.destory=function(){this._dice&&(this._dice.animation.stop(),this._dice.hasEventListener(dragonBones.FrameEvent.ANIMATION_FRAME_EVENT)&&this._dice.removeEventListener(dragonBones.FrameEvent.ANIMATION_FRAME_EVENT,this.frame_event,this),this._dice.hasEventListener(dragonBones.AnimationEvent.COMPLETE)&&this._dice.removeEventListener(dragonBones.AnimationEvent.COMPLETE,this.animation_event,this),dragonBones.WorldClock.clock.remove(this._dice),uniLib.DisplayUtils.destoryDragonBonesArmature(this._dice,"shaizi"),this._dice.display&&a.ResUtil.removeFromParent(this._dice.display),this._dice=null),this._timerOutId&&(egret.clearTimeout(this._timerOutId),this._timerOutId=0),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this._diceArr=null,this._index=null},c.prototype.showDice=function(a){this._diceArr=a,this._index=0,this.onStartThrow()},c.prototype.onStartThrow=function(){this._dice||(this._dice=uniLib.DragonUtils.createDragonBonesDisplay("dice_drag_json","dice_json","dice_png","MovieClip"),this._dice.addEventListener(dragonBones.FrameEvent.ANIMATION_FRAME_EVENT,this.frame_event,this),this._dice.addEventListener(dragonBones.AnimationEvent.COMPLETE,this.animation_event,this),dragonBones.WorldClock.clock.add(this._dice)),this._dice.display.y=a.DataCache.defaultHeight/2-120,this._dice.display.x=a.DataCache.defaultWidth/2+22,this.addChild(this._dice.display),this.play()},c.prototype.play=function(){dragonBones.WorldClock.clock.contains(this._dice)||dragonBones.WorldClock.clock.add(this._dice),this._dice.animation.gotoAndPlay("shaizi",0,-1,1),uniLib.SoundMgr.instance.playSound(a.SoundConsts.DICE)},c.prototype.frame_event=function(a){if("DiceChange"==a.frameLabel){var b=this._dice.getSlot("mohu_04"),c=this._dice.getSlot("mohu_02"),d=uniLib.DisplayUtils.createBitmapByName("dice_"+this._diceArr.one),e=uniLib.DisplayUtils.createBitmapByName("dice_"+this._diceArr.two);d.anchorOffsetX=e.anchorOffsetX=d.width/2,d.anchorOffsetY=e.anchorOffsetY=d.height/2,b.setDisplay(d),c.setDisplay(e)}},c.prototype.animation_event=function(b){var c=this;this._index++,this._index>=1?this._timerOutId=egret.setTimeout(function(){a.ResUtil.removeFromParent(c._dice.display)},this,1e3):(uniLib.SoundMgr.instance.playSound(a.SoundConsts.DICE),this._timerOutId=egret.setTimeout(function(){c.play()},this,1e3))},c}(egret.DisplayObjectContainer);a.DiceMc=b}(game||(game={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(a){function b(){a.call(this),this.index=0}return __extends(b,a),b.prototype.initUI=function(){},Object.defineProperty(b.prototype,"giftId",{set:function(a){this._giftId=a,this._effectMc||(this._effectMc=uniLib.DragonUtils.createDragonBonesDisplay("gift_effect_drag_json","gift_effect_json","gift_effect_png","MovieClip"),dragonBones.WorldClock.clock.add(this._effectMc),this._effectMc.addEventListener(dragonBones.AnimationEvent.LOOP_COMPLETE,this.onAnimationEvent,this)),this._effectMc.animation.gotoAndStopByFrame("gift"+this._giftId,0),this.addChild(this._effectMc.display)},enumerable:!0,configurable:!0}),b.prototype.onAnimationEvent=function(){if(this.index++,4!=this._giftId&&3!=this._giftId){if(2==this.index){if(!this._effectMc)return;this._effectMc.animation.stop("gift"+this._giftId),this.destory(),this.index=0}}else if(1==this.index){if(!this._effectMc)return;this._effectMc.animation.stop("gift"+this._giftId),this.destory(),this.index=0}},b.prototype.play=function(){if(null!=this._effectMc){dragonBones.WorldClock.clock.contains(this._effectMc)||dragonBones.WorldClock.clock.add(this._effectMc),4!=this._giftId&&this._giftId,this._effectMc.animation.play("gift"+this._giftId);var a=table.TableCard.resSoundGift(this._giftId);""!=a&&uniLib.SoundMgr.instance.playSound(a)}},b.prototype.destory=function(){this._effectMc&&(dragonBones.WorldClock.clock.remove(this._effectMc),this._effectMc.animation.stop(),this._effectMc.removeEventListener(dragonBones.AnimationEvent.LOOP_COMPLETE,this.onAnimationEvent,this),uniLib.DisplayUtils.destoryDragonBonesArmature(this._effectMc,"gift"+this._giftId),this._effectMc.display&&this.removeChild(this._effectMc.display)),this._effectMc=null,uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},b}(a.BaseVc);a.GiftAnItem=b}(game||(game={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(a){function b(){a.call(this),this.index=0}return __extends(b,a),b.prototype.initUI=function(){},Object.defineProperty(b.prototype,"giftId",{set:function(a){this._giftId=a,this._effectMc||(this._effectMc=uniLib.DragonUtils.createFastDragonBones("gift_effect_drag_ske_dbmv","gift_effect_drag_tex_png","MovieClip","gift_drag"),this._effectMc.addEventListener(dragonBones.AnimationEvent.LOOP_COMPLETE,this.onAnimationEvent,this)),this._effectMc.play("gift"+this._giftId,0),this.addChild(this._effectMc)},enumerable:!0,configurable:!0}),b.prototype.onAnimationEvent=function(){if(this.index++,4!=this._giftId&&3!=this._giftId){if(2==this.index){if(!this._effectMc)return;this._effectMc.stop(),this.destory(),this.index=0}}else if(1==this.index){if(!this._effectMc)return;this._effectMc.stop(),this.destory(),this.index=0}},b.prototype.play=function(){if(null!=this._effectMc){dragonBones.WorldClock.clock.contains(this._effectMc)||dragonBones.WorldClock.clock.add(this._effectMc),4!=this._giftId&&this._giftId,this._effectMc.play("gift"+this._giftId);var a=table.TableCard.resSoundGift(this._giftId);""!=a&&uniLib.SoundMgr.instance.playSound(a)}},b.prototype.destory=function(){this._effectMc&&(dragonBones.WorldClock.clock.remove(this._effectMc),this._effectMc.stop(),this._effectMc.removeEventListener(dragonBones.AnimationEvent.LOOP_COMPLETE,this.onAnimationEvent,this),this._effectMc&&this.removeChild(this._effectMc)),this._effectMc=null,uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},b}(a.BaseVc);a.GiftAnItem_2d5=b}(game||(game={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(b){function c(c,d,e){if(void 0===c&&(c=0),void 0===d&&(d=0),void 0===e&&(e=!1),b.call(this),this._width=c,this._height=d,e){var f=new egret.Shape;f.graphics.beginFill(255),f.graphics.drawCircle(40,40,40),f.graphics.endFill(),this.addChild(f)}this._headMc=a.ResUtil.createBitmapByName("defaultHead"),this._headMc.width=this._width,this._headMc.height=this._height,this._headMc.mask=f,this.addChild(this._headMc)}return __extends(c,b),c.prototype.destory=function(){a.ResUtil.removeAllChildren(this),a.ResUtil.removeFromParent(this),this._headLoad&&(this._headLoad.destroy(),this._headLoad=null),this._headMc=null},Object.defineProperty(c.prototype,"headUrl",{set:function(b){if(b&&-1==b.indexOf("http")){if(!this._headUrl)return;b=this._headUrl}this._headUrl&&this._headUrl==b||(this._headUrl=b,this._headMc.texture=a.ResUtil.createTexture("defaultHead"),this._headLoad||(this._headLoad=new a.HeadLoader),this._headLoad.load(this._headUrl,this.loaded,null,this))},enumerable:!0,configurable:!0}),c.prototype.loaded=function(a){if(this._headMc)if(this._headMc.texture)this._headMc.texture.bitmapData=a;else{var b=new egret.Texture;b.bitmapData=a,this._headMc.texture=b,this.addChild(this._headMc)}else{var b=new egret.Texture;b.bitmapData=a,this._headMc=new egret.Bitmap(b),this._headMc.width=this._width,this._headMc.height=this._height,this.addChild(this._headMc)}},c}(egret.Sprite);a.HeadMc=b}(game||(game={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.initUI=function(){this._mask=new egret.Sprite,this._mask.graphics.beginFill(0,.01),this._mask.graphics.drawRect(0,0,a.DataCache.defaultWidth,a.DataCache.defaultHeight),this._mask.graphics.endFill(),this._mask.touchEnabled=!0,this.addChild(this._mask);var b=uniLib.DisplayUtils.createBitmapByName("video_bg_5");this.addChild(b),b.y=a.GameData.getInstance().libVideoPanelY,b.x=uniLib.Global.screenWidth/2-b.width/2,this._backBtn=new a.GameButton(["video_back1","video_back2"]),this.addChild(this._backBtn),this._backBtn.name="back",this._stopBtn=new a.GameButton(["video_stop1","video_stop2"]),this.addChild(this._stopBtn),this._stopBtn.name="stop",this._advanceBtn=new a.GameButton(["video_advance1","video_advance2"]),this.addChild(this._advanceBtn),this._advanceBtn.name="advance",this._helpBtn=new a.GameButton(["video_help1","video_help2"]),this.addChild(this._helpBtn),this._helpBtn.name="help",this._closeBtn=new a.GameButton(["video_close1","video_close2"]),this.addChild(this._closeBtn),this._closeBtn.name="close",this._backBtn.x=b.x+2,this._stopBtn.x=this._backBtn.x+this._backBtn.width+5,this._advanceBtn.x=this._stopBtn.x+this._stopBtn.width+5,this._helpBtn.x=this._advanceBtn.x+this._advanceBtn.width+3,this._closeBtn.x=this._helpBtn.x+this._helpBtn.width+3,this._helpBtn.y=this._backBtn.y=this._stopBtn.y=this._advanceBtn.y=this._closeBtn.y=b.y+5,this._backBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._stopBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._advanceBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._helpBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._closeBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this)},c.prototype.btnClick=function(b){switch(b.currentTarget.name){case"back":this.dispatchEventWith(a.UIEventConsts.VIDEO_BACK);break;case"stop":this.dispatchEventWith(a.UIEventConsts.VIDEO_STOP);break;case"advance":this.dispatchEventWith(a.UIEventConsts.VIDEO_ADVANCE);break;case"help":this.showRoomSetting();break;case"close":this.dispatchEventWith(a.UIEventConsts.VIDEO_CLOSE)}},c.prototype.showRoomSetting=function(){var b="",c=a.RoomInfo.getInstance().getPlayTypeByList();if(c.length<=0)b="房主什么都没选择,你们随意";else for(var d=0;d<c.length;d++)b=b+c[d]+"  ";a.PublicManage.getInstance().showVideoCommonPanel(b,[],[],null,this)},c.prototype.destory=function(){this._backBtn&&(this._backBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._backBtn=null),this._stopBtn&&(this._stopBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._stopBtn=null),this._advanceBtn&&(this._advanceBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._advanceBtn=null),this._closeBtn&&(this._closeBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._closeBtn=null),this._helpBtn&&(this._helpBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.btnClick,this),this._helpBtn=null),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},c}(a.BaseVc);a.LibVideoPanel=b}(game||(game={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(b){function c(a,d,e,f,g){void 0===e&&(e=c.LEFT),void 0===f&&(f=null),void 0===g&&(g=!0),b.call(this),this._defaultAsstes="num",this._spacing=-1,this._width=a,this._height=d,this._align=e,this._hideZero=g,f&&(this._defaultAsstes=f),this.init()}return __extends(c,b),c.prototype.init=function(){this._numMc=new egret.Sprite,this.addChild(this._numMc)},Object.defineProperty(c.prototype,"spacing",{set:function(a){this._spacing=a},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"value",{get:function(){return this._value},set:function(b){if(this._value=b,this.clear(),0!=b||!this._hideZero){for(var d,e,f=a.ResUtil.currencyFormat(b),g=0;g<f.length&&(e=f.charAt(g),","==e&&(e="10"),d=a.ResUtil.createBitmapByName(this._defaultAsstes+e),!(this._numMc.width+d.width>this._width));g++)"10"==e&&"num"==this._defaultAsstes&&(d.y=12),d.x=this._numMc.width>0?this._numMc.width+this._spacing:this._numMc.width,this._numMc.addChild(d);switch(this._align){case c.LEFT:this._numMc.x=0;break;case c.MIDDLE:this._numMc.x=Math.round((this._width-this._numMc.width)/2);break;case c.RIGHT:this._numMc.x=this._width-this._numMc.width}}},enumerable:!0,configurable:!0}),c.prototype.clear=function(){for(var a=this._numMc.numChildren,b=0;b<a;b++)this._numMc.removeChildAt(0)},c.prototype.getNumblerF=function(a){return","==a?12:Number(a)+1},c.prototype.destory=function(){this._numMc.parent.removeChild(this._numMc),this._numMc=null,this.clear(),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},c.LEFT=1,c.MIDDLE=2,c.RIGHT=3,c}(egret.Sprite);a.NumBitmapFormat=b}(game||(game={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(b){function c(){b.call(this)}return __extends(c,b),c.prototype.destory=function(){b.prototype.destory.call(this),this._armature&&(dragonBones.WorldClock.clock.remove(this._armature),this._armature.removeEventListener(dragonBones.AnimationEvent.LOOP_COMPLETE,this.onEffectOver,this),this._armature.display&&a.ResUtil.removeFromParent(this._armature.display)),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this._armature=null,this._bg=null},c.prototype.initUI=function(){this._bg=a.ResUtil.createBitmapByName("startEffect_bg_png"),this._bg.width=1136,this.addChild(this._bg)},c.prototype.play=function(){this.visible=!0,this._armature||(this._armature=uniLib.DragonUtils.createDragonBonesDisplay("star_effect_drag_json","star_effect"),this._armature.display.x=(a.DataCache.defaultWidth-this._armature.display.width)/2,this._armature.display.y=(a.DataCache.defaultHeight-this._armature.display.height)/2-15,this.addChild(this._armature.display)),dragonBones.WorldClock.clock.contains(this._armature)||dragonBones.WorldClock.clock.add(this._armature),this._armature.addEventListener(dragonBones.AnimationEvent.LOOP_COMPLETE,this.onEffectOver,this),this._armature.animation.play(),this._bg.height=0,this._bg.y=a.DataCache.defaultHeight/2,this._bg.alpha=1,egret.Tween.get(this._bg).to({height:178,y:(a.DataCache.defaultHeight-178)/2},250).wait(710).to({alpha:0},250)},c.prototype.onEffectOver=function(){this._armature&&(this._armature.animation.stop(),this._armature.removeEventListener(dragonBones.AnimationEvent.LOOP_COMPLETE,this.onEffectOver,this),dragonBones.WorldClock.clock.remove(this._armature),this._armature.display&&a.ResUtil.removeFromParent(this._armature.display)),this.dispatchEventWith(a.UIEventConsts.START_EFFECT_OVER),this._armature=null,this.hide()},c.prototype.hide=function(){this.visible=!1},c}(a.BaseVc);a.StartEffectMc=b}(game||(game={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(b){function c(){b.call(this,2)}return __extends(c,b),c.prototype.initPanel=function(){this.setSize(575,360),this.content=new egret.Sprite,this.content.x=60,this.content.y=60,this.addChild(this.content),this.noticeTxt=new egret.TextField,this.noticeTxt.size=28,this.noticeTxt.text="      "+a.RoomInfo.getInstance().notice,this.noticeTxt.width=475,this.noticeTxt.height=350,this.noticeTxt.textColor=0,this.content.addChild(this.noticeTxt)},c}(a.BasePanel);a.StopServicePanel=b}(game||(game={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(b){function c(a){void 0===a&&(a="yellow"),b.call(this),this._color="",this._color=a}return __extends(c,b),c.prototype.setType=function(b){if(!this._card){var c="lymj_blur";a.GameConst&&a.GameConst.cardStylePer&&(c=a.GameConst.cardStylePer+c),this._card=a.ResUtil.createBitmapByName(c),this.addChild(this._card)}"green"==this._color&&(this._card.texture=RES.getRes("green_blur")),1==b?(this._card.x=-2,this._card.y=-26,this._card.rotation=0):(this._card.x=-24,this._card.y=-1,this._card.rotation=90)},c.prototype.destory=function(){uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this._card=null},c}(a.BaseVc);a.BlurBackCard=b}(game||(game={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(b){function c(a){void 0===a&&(a="yellow"),b.call(this),this._color="",this._color=a}return __extends(c,b),c.prototype.setType=function(b){if(!this._card){var c="lymj_stack";a.GameConst&&a.GameConst.cardStylePer&&(c=a.GameConst.cardStylePer+c),this._card=a.ResUtil.createBitmapByName(c),this.addChild(this._card)}"green"==this._color&&(this._card.texture=RES.getRes("green_stack")),1==b?(this._card.x=-5,this._card.y=-20,this._card.rotation=0):(this._card.x=-29,this._card.y=-1,this._card.rotation=90)},c.prototype.destory=function(){uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this._card=null},c}(a.BaseVc);a.CardStack=b}(game||(game={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(b){function d(){b.call(this)}return __extends(d,b),d.prototype.initUI=function(){this._itemGroup=[],this._voiceBtn=new a.GameButton(["yaya_record","yaya_record"]),this._voiceBtn.x=14,this._voiceBtn.y=146,this.addChild(this._voiceBtn),this._inputBg=a.ResUtil.createBitmapByName("yaya_chat_bg",58,147),this.addChild(this._inputBg),this._curIndex=0,this.resetBtn(),this._voiceBtn.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this._voiceMc=new egret.Sprite,this._voiceMc.name="short_mc",this.addChild(this._voiceMc),this._scrollView=a.ResUtil.createScroll(this._voiceMc,350,250,20,5),this._scrollView.horizontalScrollPolicy="off",this._scrollView.verticalScrollPolicy="on",this.addChild(this._scrollView),this._tempTip=a.ResUtil.createTextFeild(3355443,egret.HorizontalAlign.CENTER,"暂无数据",20,0,110,335),this.addChild(this._tempTip)},d.prototype.initData=function(a){if(null!=a[0]){this._itemGroup=[],uniLib.DisplayUtils.removeAllChildren(this._voiceMc),this._tempTip.visible=!1;for(var b=0;b<a.length;b++)this.showOneVoice(a[b]);a.length>3&&this._scrollView.setScrollPosition(80*(a.length-3),0)}},d.prototype.showOneVoice=function(a){var b=new c;b.name="short_"+a.uid,b.setData(a),0!=this._voiceMc.height&&(b.y=this._voiceMc.height),b.touchChildren=!0,b.addEventListener(egret.TouchEvent.TOUCH_TAP,this.onPlayVoice,this),this._voiceMc.addChild(b),this._itemGroup.push(b)},d.prototype.onPlayEnd=function(a){a.currentTarget.removeEventListener(c.PLAY_END,this.onPlayEnd,this),this._curVoice=null},d.prototype.onPlayVoice=function(a){var b=a.currentTarget;this._curVoice==a.currentTarget?(b.stopPlay(),b.removeEventListener(c.PLAY_END,this.onPlayEnd,this)):(this._curVoice&&(this._curVoice.stopPlay(),this._curVoice.removeEventListener(c.PLAY_END,this.onPlayEnd,this)),b.startPlay(),b.addEventListener(c.PLAY_END,this.onPlayEnd,this),this._curVoice=b)},d.prototype.onClick=function(a){a.currentTarget==this._voiceBtn?this._curIndex=0:this._curIndex=1,this.resetBtn()},d.prototype.resetBtn=function(){0==this._curIndex?(this._inputBg.visible=!1,this._voiceBtn.visible=!1):(this._inputBg.visible=!0,this._voiceBtn.visible=!0)},d.prototype.destory=function(){this._voiceBtn&&(this._voiceBtn.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onClick,this),this._voiceBtn.destory()),this._voiceBtn=null;for(var a=0;a<this._itemGroup.length;a++){var b=this._itemGroup[a];b.removeEventListener(c.PLAY_END,this.onPlayEnd,this),b.removeEventListener(egret.TouchEvent.TOUCH_TAP,this.onPlayVoice,this),b.destory()}this._voiceMc&&uniLib.DisplayUtils.removeAllChildren(this._voiceMc),this._voiceMc=null,this._scrollView=null,uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this._inputBg=null,this._curVoice=null},d}(a.BaseVc);a.RecordItem=b;var c=function(b){function c(){b.call(this),this._second=0,this._totalWidth=300}return __extends(c,b),c.prototype.initUI=function(){this._content=uniLib.DisplayUtils.createMask(0,300,80,0),this._content.touchEnabled=!0,this._content.name="short_record_content",this.addChild(this._content),this._nameTxt=a.ResUtil.createTextFeild(10505256,egret.HorizontalAlign.LEFT,"me",18,0,5,150),this._content.addChild(this._nameTxt),this._timeTxt=a.ResUtil.createTextFeild(10505256,egret.HorizontalAlign.LEFT,"me",13,10+this._nameTxt.width,10,150),this._content.addChild(this._timeTxt),this._voiceIcon=a.ResUtil.createBitmapByName("chat_pop",0,30),this._voiceIcon.name="short_sound_pop",this._voiceIcon.scale9Grid=new egret.Rectangle(31,9,10,21),this._voiceIcon.width=300,this._content.addChild(this._voiceIcon),this._soundIcon=a.ResUtil.createBitmapByName("yaya_voice_icon",20,40),this._soundIcon.name="short_sound_icon",this._content.addChild(this._soundIcon),this._voiceLenTxt=a.ResUtil.createTextFeild(3355443,egret.HorizontalAlign.LEFT,"3''",22,142,45,50),this._voiceLenTxt.x=this._voiceIcon.width-this._voiceLenTxt.width,this._voiceLenTxt.name="short_voice_len",this._content.addChild(this._voiceLenTxt),this._voiceIcon.touchEnabled=!0},c.prototype.stopTimer=function(){this._soundIcon.visible=!0,this._timer_200&&this._timer_200.stop(),this._timer_200=null,this._second=0},c.prototype.onTimer=function(a){this._second++;var b=1e3*Number(this.data.time);this._second>=b/200?this.stopPlay():this._soundIcon.visible=!this._soundIcon.visible},c.prototype.startPlay=function(){this._data.uid!=uniLib.UserInfo.uid&&uniLib.ZQGameSdk.playRecord(this._data.url,this.playEndBack,this),this._voiceIcon.texture=a.ResUtil.createTexture("yaya_voice2"),this.stopTimer(),this._timer_200=new uniLib.TimerBase(200,this.onTimer,this),this._timer_200.start()},c.prototype.stopPlay=function(){uniLib.ZQGameSdk.stopPlayRecord(this._data.url),this.stopTimer(),this._voiceIcon.texture=a.ResUtil.createTexture("chat_pop")},c.prototype.playEndBack=function(a){this.stopTimer()},Object.defineProperty(c.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),c.prototype.setData=function(b){this._data=b,this._nameTxt.text=a.RoomInfo.getInstance().getUserVoByUid(b.uid).nickName,this._voiceLenTxt.text=b.time+"''",this._timeTxt.text=b.timestamp;var c=Number(b.time);this._voiceIcon.width=c<5?5/15*this._totalWidth:c/15*this._totalWidth,this._voiceLenTxt.x=this._voiceIcon.width-this._voiceLenTxt.width},c.prototype.destory=function(){b.prototype.destory.call(this),this.stopTimer(),this._content&&(uniLib.DisplayUtils.removeAllChildren(this._content),uniLib.DisplayUtils.removeFromParent(this._content)),this._data=null,this._content=null,this._nameTxt=null,this._soundIcon=null,this._voiceIcon=null,this._timeTxt=null,this._voiceLenTxt=null},c.PLAY_END="playEnd",c}(a.BaseVc);a.RecordVoiceItem=c}(game||(game={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(b){function c(d){b.call(this,c.NAME,d),this._voiceVc=d,this._voiceVc.addEventListener(a.UIEventConsts.SEND_RECORD,this.uiEventHandle,this)}return __extends(c,b),c.prototype.uiEventHandle=function(b){switch(b.type){case a.UIEventConsts.SEND_RECORD:var c=b.data,d=new Cmd.VoiceChat_C;d.url=c.url,d.time=c.time.toString(),d.words=c.text,this.sendNotification(a.MahjongFourFacadeConst.SEND_DATA,d,a.DataRequestCommand.GAME_DATA)}},c.prototype.listNotificationInterests=function(){return[a.MahjongFourFacadeConst.USER_ENTER_ROOM,a.MahjongFourFacadeConst.VOICE_NOTICE]},c.prototype.handleNotification=function(b){switch(b.getName()){case a.MahjongFourFacadeConst.VOICE_NOTICE:this._voiceVc.showVoice(b.getBody());break;case a.MahjongFourFacadeConst.USER_ENTER_ROOM:}},c.prototype.onRemove=function(){a.VoiceChat.VoicePlaying={},this._voiceVc&&(this._voiceVc.removeEventListener(a.UIEventConsts.SEND_RECORD,this.uiEventHandle,this),this._voiceVc.destory(),this._voiceVc=null),b.prototype.onRemove.call(this)},c.NAME="VoiceChatMediator",c}(puremvc.Mediator);a.VoiceChatMediator=b}(game||(game={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(b){function e(a){void 0===a&&(a=""),b.call(this),this.lobbyFrom="",this._isCancel=!1,this.lobbyFrom=a,this.updateUI()}return __extends(e,b),e.StartVoicePlaying=function(a){var b=!1;for(var c in e.VoicePlaying){1==e.VoicePlaying[c]&&(b=!0)}b||(e.soundOpen=uniLib.SoundMgr.instance.soundOpen,uniLib.SoundMgr.instance.soundOpen=!1,uniLib.SoundMgr.instance.pauseBgMusic()),e.VoicePlaying[a]=!0},e.StopVoicePlaying=function(a){if(0!=a){e.VoicePlaying[a]=!1;var b=!1;for(var c in e.VoicePlaying){1==e.VoicePlaying[c]&&(b=!0)}b||(uniLib.SoundMgr.instance.soundOpen=e.soundOpen,uniLib.SoundMgr.instance.resumeBgMusic())}else{uniLib.SoundMgr.instance.soundOpen=e.soundOpen,uniLib.SoundMgr.instance.resumeBgMusic();for(var c in e.VoicePlaying)e.VoicePlaying[c]=!1}},e.prototype.initUI=function(){},e.prototype.updateUI=function(){this._startBtn=new a.GameButton([this.lobbyFrom+"voice_btn2",this.lobbyFrom+"voice_btn1"]),this._startBtn.y=uniLib.Global.screenHeight-320,this._startBtn.x=uniLib.Global.screenWidth-this._startBtn.width-5,this.addChild(this._startBtn),this._startBtn.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.startRecord,this),this._recording=new d,this.addChild(this._recording),this._recording.x=(a.DataCache.defaultWidth-this._recording.width)/2,this._recording.y=(a.DataCache.defaultHeight-this._recording.height)/2,this._recording.addEventListener(a.UIEventConsts.RECORD_TIME_OUT,this.recordEvent,this),this._voiceArr=[],a.GameInfo.topLayer.addChild(this._recording)},Object.defineProperty(e.prototype,"voiceButtonX",{set:function(a){this._startBtn.x=a},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"voiceButtonY",{set:function(a){this._startBtn.y=a},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"voiceButtonWidth",{set:function(a){this._startBtn.iconWdith=a},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"voiceButtonHeight",{set:function(a){this._startBtn.iconHeight=a},enumerable:!0,configurable:!0}),e.prototype.updateBtnRes=function(a){this._startBtn.iconTexture(a),this._startBtn.y=uniLib.Global.screenHeight-240,this._startBtn.x=uniLib.Global.screenWidth-this._startBtn.width-10},e.prototype.setVoiceVisible=function(a){this._startBtn.visible=a},e.prototype.showVoice=function(b){var c=a.RoomInfo.getInstance().getSeatNoByUserId(b.uid),d=this.getVoiceItem(c);a.GameInfo.topLayer.addChildAt(d,0);var e=new a.VoiceDataVo;e.time=Number(b.time),e.url=b.url,e.uid=b.uid,d.setData(e)},e.prototype.getVoiceItem=function(b){if(this._voiceArr[b])return this._voiceArr[b];var d=a.PositionData.seatPosArr[b];if(!this._voiceArr[b]){var e=new c;0==b||3==b?e.x=d.x+100:(e.scaleX=-1,e.x=d.x-76,e.flip()),e.y=d.y+25,1!=b&&2!=b||(e.x=d.x-11),this._voiceArr[b]=e}return this._voiceArr[b]},e.prototype.recordEvent=function(a){this.stopRecord()},e.prototype.startRecord=function(b){if((new Date).getTime()-this._recording._startTime<3e3)return void a.PublicManage.getInstance().showMildWarnShow("操作速度过快,请稍后再试");this._isCancel=!1,this._curPosY=b.localY,egret.MainContext.instance.stage.addEventListener(egret.TouchEvent.TOUCH_END,this.stopRecord,this),egret.MainContext.instance.stage.addEventListener(egret.TouchEvent.TOUCH_MOVE,this.checkCancel,this),uniLib.ZQGameSdk.startRecord(),this._recording.startTimer()},e.prototype.checkCancel=function(a){a.localY>this._curPosY+20&&(this._isCancel=!0,egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.stopRecord,this),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.checkCancel,this),uniLib.ZQGameSdk.stopRecord(),this._recording.stopTimer())},e.prototype.stopRecord=function(a){if(void 0===a&&(a=null),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.stopRecord,this),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.checkCancel,this),this._recording.stopTimer()<1e3){var b=this;this.stopEvent&&this.stopEvent.stop(!0),this.stopEvent=uniLib.SetUniEventTimeout(egret.MainContext.instance.stage,function(){uniLib.ZQGameSdk.stopRecord(),b.stopEvent=null},1e3,1,this)}else uniLib.ZQGameSdk.stopRecord(this.onRecordBack,this)},e.prototype.onRecordBack=function(b){var c=b.data;if(0==b.code){var d=new a.VoiceDataVo;d.url=c.voiceUrl,d.time=Math.round(c.voiceDuration/1e3),d.nickName=uniLib.UserInfo.uid.toString(),d.text=c.text,d.status=0,isNaN(d.time)?a.GameInfo.manage.showMildWarnShow("语音发送失败"):0==this._isCancel&&this.dispatchEventWith(a.UIEventConsts.SEND_RECORD,!1,d)}else a.GameInfo.manage.showMildWarnShow(b.errMsg)},e.prototype.destory=function(){this._startBtn&&(this._startBtn.removeEventListener(egret.TouchEvent.TOUCH_BEGIN,this.startRecord,this),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_END,this.stopRecord,this),egret.MainContext.instance.stage.removeEventListener(egret.TouchEvent.TOUCH_MOVE,this.checkCancel,this),this._startBtn.destory()),this._startBtn=null,this._recording&&(a.ResUtil.removeFromParent(this._recording),this._recording.removeEventListener(a.UIEventConsts.RECORD_TIME_OUT,this.recordEvent,this),this._recording.destory()),this._recording=null;for(var b,c=0;c<this._voiceArr.length;c++)(b=this._voiceArr[c])&&(a.ResUtil.removeFromParent(b),b.destory(),b=null);this._voiceArr=null,uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this)},e.VoicePlaying={},e}(a.BaseVc);a.VoiceChat=b;var c=function(c){function d(){c.call(this),this._ifFlip=!1}return __extends(d,c),d.prototype.initUI=function(){this._bg=a.ResUtil.createBitmapByName("voice_paopao"),this._bg.scale9Grid=new egret.Rectangle(50,10,30,20),this.addChild(this._bg),this._soundIcon=a.ResUtil.createBitmapByName("voice_icon",24,11),this.addChild(this._soundIcon),this._timeTxt=a.ResUtil.createTextFeild(16777215,egret.HorizontalAlign.RIGHT,"",18,48,13,50),this.addChild(this._timeTxt)},d.prototype.onTimer=function(a){this._soundIcon.visible=!this._soundIcon.visible},d.prototype.stopTimer=function(a){b.StopVoicePlaying(a),this._soundIcon.visible=!0,this.visible=!1,this.flash_timer&&(this.flash_timer.stop(),this.flash_timer=null)},d.prototype.flip=function(){this._ifFlip=!0,this._timeTxt.skewY=180,this._timeTxt.textAlign=egret.HorizontalAlign.LEFT},d.prototype.setData=function(a){this.uid=a.uid,b.StartVoicePlaying(this.uid),a.uid!=uniLib.UserInfo.uid&&uniLib.ZQGameSdk.playRecord(a.url,this.playEndBack,this),a.time?this._timeTxt.text=a.time+"''":this._timeTxt.text="",this._soundTime=a.time?a.time:10,a.time<=3?this._bg.width=100:this._bg.width=100+5*(a.time-3),this._ifFlip?this._timeTxt.x=this._bg.width-12:this._timeTxt.x=this._bg.width-60,this.flash_timer&&this.flash_timer.stop(),this.flash_timer=uniLib.SetUniTimerTimeout(this,this.onTimer,200,!0,this),uniLib.SetUniEventTimeout(this,function(){this.stopTimer(a.uid)},1e3*(this._soundTime+1),1,this),this.visible=!0},d.prototype.playEndBack=function(a){this.stopTimer(this.uid)},d.prototype.destory=function(){this.stopTimer(0),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this._bg=null,this._soundIcon=null},d}(a.BaseVc);a.VoiceMc=c;var d=function(b){function c(){b.call(this),this._startTime=0,this._maxTime=15,this._msTime=0}return __extends(c,b),c.prototype.initUI=function(){var b=a.ResUtil.createBitmapByName("voice_recording");this.addChild(b),this._moving=new egret.DisplayObjectContainer,this._moving.x=104,this._moving.y=102;var c=a.ResUtil.createBitmapByName("voiceloading");c.x=-c.width/2,c.y=-c.height/2,this._moving.addChild(c),this.addChild(this._moving),this._time=a.ResUtil.createTextFeild(13031390,egret.HorizontalAlign.CENTER,"8''",22,74,136,75),this.addChild(this._time),this.visible=!1},c.prototype.startTimer=function(){this.stopTimer(),this.visible=!0,this._startTimer=new egret.Timer(50,0);var a=new Date;this._startTime=a.getTime(),this._startTimer.addEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._startTimer.start()},c.prototype.stopTimer=function(){return this.visible=!1,this._startTimer&&(this._startTimer.removeEventListener(egret.TimerEvent.TIMER,this.onTimer,this),this._startTimer.stop(),this._startTimer=null),this._msTime},c.prototype.onTimer=function(b){var c=new Date,d=c.getTime(),e=Math.floor((d-this._startTime)/1e3);this._time.text=e+1+"''",this._moving.rotation+=15,e>=this._maxTime&&this.dispatchEventWith(a.UIEventConsts.RECORD_TIME_OUT),this._msTime=d-this._startTime},c.prototype.dispose=function(){this.stopTimer(),this._moving&&(uniLib.DisplayUtils.removeAllChildren(this._moving),uniLib.DisplayUtils.removeFromParent(this._moving)),uniLib.DisplayUtils.removeAllChildren(this),uniLib.DisplayUtils.removeFromParent(this),this._moving=null,this._time=null},c}(a.BaseVc);a.RecordingMc=d}(game||(game={}));var game;!function(a){var b=function(){function a(){}return a.prototype.load=function(a,b,c,d){this.destroy(),this._completeFun=b,this._errorFun=c,this._callObj=d,this._headUrl=a;var e=this.getHeadCache(a);e?this._completeFun&&this._completeFun.call(this._callObj,e):(this._imageLoader=new egret.ImageLoader,this._imageLoader.addEventListener(egret.Event.COMPLETE,this.loadCompleteHandler,this),this._imageLoader.addEventListener(egret.IOErrorEvent.IO_ERROR,this.onIOError,this),this._imageLoader.load(this._headUrl))},a.prototype.loadCompleteHandler=function(a){this._imageLoader.removeEventListener(egret.Event.COMPLETE,this.loadCompleteHandler,this),this._imageLoader.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onIOError,this),this.saveHeadCache(this._headUrl,this._imageLoader.data),this._completeFun&&this._completeFun.call(this._callObj,this._imageLoader.data)},a.prototype.onIOError=function(a){this._imageLoader.removeEventListener(egret.Event.COMPLETE,this.loadCompleteHandler,this),this._imageLoader.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onIOError,this),this._errorFun&&this._errorFun.call(this._callObj,[])},a.prototype.destroy=function(){this._imageLoader&&(this._imageLoader.removeEventListener(egret.Event.COMPLETE,this.loadCompleteHandler,this),this._imageLoader.removeEventListener(egret.IOErrorEvent.IO_ERROR,this.onIOError,this),this._imageLoader=null),this._completeFun=null,this._errorFun=null,this._callObj=null,this._headUrl=null},a.prototype.getHeadCache=function(a){if(uniLib.Global.localCache){if(uniLib.Global.localCache[a])return uniLib.Global.localCache[a]}else uniLib.Global.localCache={};return null},a.prototype.saveHeadCache=function(a,b){uniLib.Global.localCache||(uniLib.Global.localCache={}),uniLib.Global.localCache[a]=b},a}();a.HeadLoader=b}(game||(game={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},game;!function(a){var b=function(a){function b(b){a.call(this),this._soundType=b,this.load()}return __extends(b,a),b.prototype.load=function(){var a=new egret.URLLoader;a.dataFormat=egret.URLLoaderDataFormat.SOUND,a.addEventListener(egret.Event.COMPLETE,this.onLoadComplete,this);var b="resource/assets/sound/"+this._soundType,c=new egret.URLRequest(b);a.load(c)},b.prototype.onLoadComplete=function(a){var c=a.target,d=c.data;this.dispatchEventWith(b.LOADED,!1,{type:this._soundType,data:d})},b.LOADED="loaded",b}(egret.EventDispatcher);a.SoundLoader=b}(game||(game={}));var __extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},ui;!function(a){var b=function(a){function b(){a.call(this),this._hAlign="left",this.tf=new egret.BitmapText,this.addChild(this.tf)}return __extends(b,a),Object.defineProperty(b.prototype,"hAlign",{set:function(a){this._hAlign!=a&&(this._hAlign=a,this.updatePos())},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"font",{get:function(){return this.tf.font},set:function(a){this.tf.font=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"letterSpacing",{set:function(a){this.tf.letterSpacing=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"lineSpacing",{set:function(a){this.tf.lineSpacing=a},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"text",{get:function(){return this.tf.text},set:function(a){this.tf.text=a,this.updatePos()},enumerable:!0,configurable:!0}),b.prototype.updatePos=function(){var a=0;switch(this._hAlign){case egret.HorizontalAlign.LEFT:a=0;break;case egret.HorizontalAlign.RIGHT:a=this.width-this.tf.width;break;case egret.HorizontalAlign.CENTER:a=this.width/2-this.tf.width/2;break;default:a=0}this.tf.x=a},b}(egret.Sprite);a.AlignBitmapText=b}(ui||(ui={}));var ArrayUtil=function(){function a(){}return a.mergeArray=function(a,b){var c,d=new Array;c=a.length>=b.length?a.length:b.length;for(var e=0;e<c;e++)a[e]&&d.push(a[e]),b[e]&&d.push(b[e]);return d},a.removeByValue=function(a,b){if(!(a&&a instanceof Array))return[];for(var c=a.length,d=0;d<c;d++)if(a[d]==b)return a.splice(d,1),a;return a||[]},a.removeValue=function(a,b){if(!(a&&a instanceof Array))return[];for(var c=a.length,d=c-1;d>=0;d--)if(a[d]==b||a[d].cardId&&a[d].cardId==b)return a.splice(d,1),a;return a||[]},a.isInArray=function(a,b){var c=!1;if(!(b&&b instanceof Array))return c;for(var d=0;d<b.length;d++)if(b[d]==a)return!0;return c},a.deleteValue=function(a,b){if(!(b&&b instanceof Array))return[];for(var c=0;c<b.length;c++)if(b[c].thisId==a)return b.splice(c,1);return b},a.numberResolveToArray=function(a,b){for(var c=[],d=0;d<b.length;d++){for(;a>=b[d];)c.push(b[d]),a-=b[d];if(0==a)break}return c},a.deepcopy=function(a){for(var b=[],c=0,d=a.length;c<d;c++)a[c]instanceof Array?b[c]=this.deepcopy(a[c]):b[c]=a[c];return b},a.reverse=function(a){for(var b=[],c=a.length,d=0;d<c;d++)b.unshift(a[d]);return b},a}(),AutoPlayMgr=function(){function a(){this._soundRes={},this.voiceStrArr=["一万","二万","三万","四万","五万","六万","七万","八万","九万","一条","二条","三条","四条","五条","六条","七条","八条","九条","一饼","二饼","三饼","四饼","五饼","六饼","七饼","八饼","九饼","东风","南风","西风","北风","红中","发财","白板","胡","过","碰","杠","吃"],this.voiceCard=[11,12,13,14,15,16,17,18,19,21,22,23,24,25,26,27,28,29,31,32,33,34,35,36,37,38,39,41,42,44,45,46,46,47,1,2,3,4,5]}return a.prototype.init=function(a){for(var b="",c=0;c<this.voiceStrArr.length;c++)b+=this.voiceStrArr[c]+"\n";var d=new uniLib.XFSetParam;d.grammar=b,d.grammarType=uniLib.GRAMMARTYPE.OFFLINE,d.speechType=uniLib.SPEECHTYPE.GRAMMAR,console.error("xfinit:"+JSON.stringify(d,null,2)),uniLib.ZQGameSdk.xfSpeechInit(a,this.onXFinited,this,d)},a.prototype.onXFinited=function(a){console.error("#####xfinited#####")},Object.defineProperty(a,"instance",{get:function(){return this._instance||(this._instance=new a),this._instance},enumerable:!0,configurable:!0}),a.prototype.onGetResult=function(a){console.error("######card#####"+JSON.stringify(a,null,2));var b=0;if(0==a.code){var c=a.data.word,d=this.voiceStrArr.indexOf(c);d>=0&&(b=Number(this.voiceCard[d]));var e;if(console.error("cardId:"+b),b<=5){switch(b){case 1:e=new Cmd.WinMahjongCmd_C,uniLib.NetMgr.tcpSend(e);break;case 2:e=new Cmd.CancelOpMahjongCmd_C,uniLib.NetMgr.tcpSend(e);break;case 3:var f=new Cmd.TouchCardMahjongCmd_C;uniLib.NetMgr.tcpSend(f);break;case 4:if(game.CardInfo.getInstance().drawData)if(game.RoomInfo.getInstance().host_mode||1==game.CardInfo.getInstance().drawData.barSet.length){var g=new Cmd.BarCardMahjongCmd_C;uniLib.NetMgr.tcpSend(g)}else Cmd.gameDispatch(game.MahjongFourFacadeConst.VOICE_SELECT_OPERATE,2);else{var h=new Cmd.BarCardMahjongCmd_C;uniLib.NetMgr.tcpSend(h)}break;case 5:if(game.RoomInfo.getInstance().host_mode||1==game.RoomInfo.getInstance().OutCard.eatSet.length){var i=new Cmd.EatCardMahjongCmd_C,j=game.RoomInfo.getInstance().OutCard,k=j&&j.eatSet&&j.eatSet instanceof Array?j.eatSet[0]:null;k&&(i.one=k.one,i.two=k.two,i.thisId=k.two),uniLib.NetMgr.tcpSend(i)}else Cmd.gameDispatch(game.MahjongFourFacadeConst.VOICE_SELECT_OPERATE,4)}return}var l=game.CardInfo.getInstance().getHandCardBySeat(0);console.error("mythisCards:"+JSON.stringify(l));for(var m=[],n=0;n<l.length;n++)m.push(table.TableCard.thisIdToCardId(l[n]));if(console.error("myCards:"+JSON.stringify(m)),m.length>0){var o=m.indexOf(b);if(o>=0){var p=new Cmd.OutCardMahjongCmd_C;p.thisId=l[o],console.error(JSON.stringify(p)),uniLib.NetMgr.tcpSend(p)}else 1==game.GameData.getInstance().isCanOperate&&uniLib.ZQGameSdk.xfSpeechStart(this.onGetResult,this.onGetEnd,this)}else console.error("######找不到牌######:"+b)}else console.error("语音识别错误"),1==game.GameData.getInstance().isCanOperate&&uniLib.ZQGameSdk.xfSpeechStart(this.onGetResult,this.onGetEnd,this)},a.prototype.onGetEnd=function(a){},a.prototype.stopAutoRecord=function(){uniLib.ZQGameSdk.xfSpeechStop()},a.prototype.startAutoRecord=function(){console.error("开始语音识别"),uniLib.ZQGameSdk.xfSpeechStart(this.onGetResult,this.onGetEnd,this)},a.START_RECORD="start_record",a.STOP_RECORD="stop_record",a}(),MathUtil=function(){function a(){}return a.pow=function(a){return void 0===a&&(a=0),a*a},a.vectorRotation=function(a,b){return new egret.Point(Math.cos(b)*Math.sqrt(a.x*a.x+a.y*a.y),Math.sin(b)*Math.sqrt(a.x*a.x+a.y*a.y))},a.disTest=function(b,c,d,e){return void 0===e&&(e=0),a.pow(b.x-d.x)+a.pow(b.y-d.y)<=a.pow(c+e)},a.random=function(a,b){return Math.round(Math.random()*(b-a)+a)},a.RandomNumBoth=function(a,b){var c=b-a,d=Math.random();return a+Math.round(d*c)},a.pointIsInRound=function(b,c,d,e,f){return a.pow(b-e)+a.pow(c-f)<a.pow(d)},a.binary=function(b,c,d,e){if(d<=e){if(c[d]==b)return d;if(c[e]==b)return e;var f=Math.ceil((e+d)/2);return c[f]==b?f:c[f]>b?a.binary(b,c,d,f-1):a.binary(b,c,f+1,e)}return-1},a.getStrRealLength=function(a){var b={GetLength:null};return b.GetLength=function(a){return Number(a.replace(/[\u0391-\uFFE5]/g,"aa").length)},b.GetLength(a)},a}(),game;!function(a){var b=function(){function b(){}return b.addPopUp=function(b,c,d,e,f,g,h){void 0===c&&(c=!1),void 0===d&&(d=!1),void 0===e&&(e=!0),void 0===f&&(f=0),void 0===g&&(g=0),void 0===h&&(h=!1),null==this._popUpMask&&(this._popUpMask=new egret.Sprite,this._popUpMask.graphics.beginFill(0,.3),a.GameInfo.isAllSceneApa()?this._popUpMask.graphics.drawRect((uniLib.Global.designWidth-uniLib.Global.screenWidth)/2,0,uniLib.Global.screenWidth,uniLib.Global.screenHeight):this._popUpMask.graphics.drawRect(0,0,uniLib.Global.screenWidth,uniLib.Global.screenHeight),this._popUpMask.graphics.endFill(),this._popUpMask.touchEnabled=!0),this._popUpMask.visible=!!c,h?a.GameInfo.topLayer&&(a.GameInfo.main.addChild(this._popUpMask),a.GameInfo.main.addChild(b)):a.GameInfo.topLayer&&(a.GameInfo.topLayer.addChild(this._popUpMask),a.GameInfo.topLayer.addChild(b));var i,j;d?(i=f?a.DataCache.defaultWidth-f>>1:a.DataCache.defaultWidth-b.width>>1,j=g?a.DataCache.defaultHeight*uniLib.ScreenUtils.scaleFactor-g>>1:a.DataCache.defaultHeight*uniLib.ScreenUtils.scaleFactor-b.height>>1):(i=b.x,j=b.y),e?(b.y=b.y-200,b.x=i,b.alpha=0,egret.Tween.removeTweens(b),egret.Tween.get(b).to({x:i,y:j,alpha:1})):(b.x=i,b.y=j)},b.removePopUp=function(a,b){void 0===b&&(b=!1),null!=this._popUpMask&&(this._popUpMask.visible=!1),b?(egret.Tween.removeTweens(a),egret.Tween.get(a).to({y:a.y-200,alpha:0}).call(this.removeTarget,this,[a])):a.parent&&a.parent.removeChild(a)},b.removeTarget=function(a){a.alpha=1,egret.Tween.removeTweens(a),a.parent&&a.parent.removeChild(a)},b}();a.PopupManager=b}(game||(game={}));var game;!function(a){var b=function(){function b(){this.showList=[]}return b.getInstance=function(){return b.instance||(b.instance=new b),b.instance},b.prototype.showMildWarnShow=function(b){if(a.ResUtil.trace("轻度提示："+b),b){if(MJLobby&&MJLobby.MJLobbyData&&MJLobby.MJLobbyData.getInstance()&&MJLobby.MJLobbyData.getInstance().xianLobby)return void this.midSingleWarnShow(b);var c=new a.MildAlertVC;if(c.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeStage,this),c.setText(b),a.GameInfo.isAllSceneApa()?c.x=(uniLib.Global.designWidth-c.width)/2:c.x=(uniLib.Global.screenWidth-c.width)/2,this.getContainer().addChild(c),this.showList.length>0)for(var d=0;d<this.showList.length;d++)this.showList[d].y-=c.height;this.showList.push(c)}},b.prototype.midSingleWarnShow=function(b){var c=this;if(a.ResUtil.trace("单个轻度提示："+b),b){null!=this.singleAlert&&(egret.Tween.removeTweens(this.singleAlert),uniLib.DisplayUtils.removeFromParent(this.singleAlert),this.singleAlert=null),this.singleAlert=new a.MildAlertVC,this.singleAlert.addEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeStage,this),this.singleAlert.setSingleText(b);var d=this;return egret.Tween.get(this.singleAlert).to({scaleX:0,scaleY:0,y:d.singleAlert.y+100}).wait(100).call(function(){d.getContainer().addChild(c.singleAlert)}).to({scaleX:1,scaleY:1,y:d.singleAlert.y+50},100).to({alpha:.5,y:d.singleAlert.y-50},2e3).call(function(){d.singleAlert.destory(),d.singleAlert=null}),this.singleAlert}},b.prototype.getContainer=function(){return a.GameInfo.topLayer?a.GameInfo.topLayer:uniLib.SceneMgr.instance.currentScene.topLayer?uniLib.SceneMgr.instance.currentScene.topLayer:uniLib.SceneMgr.instance.currentScene},b.prototype.removeStage=function(a){var b=a.currentTarget;b.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.removeStage,this),this.showList.splice(this.showList.indexOf(b),1),b.destory(),b=null},b.prototype.showConfirmPanel=function(b,c,d,e,f,g,h){void 0===d&&(d=null),void 0===e&&(e=null),void 0===g&&(g=0),void 0===h&&(h=!0);var i=new a.MsgBox(h);e||(e=""),i.setData(e,b,c,d,f,g),a.GameInfo.isAllSceneApa()?(i.x=Math.round((uniLib.Global.designWidth-i.width)/2),i.y=Math.round((uniLib.Global.designHeight*uniLib.ScreenUtils.scaleFactor-i.height)/2)):(i.x=Math.round((uniLib.Global.screenWidth-i.width)/2),i.y=Math.round((uniLib.Global.screenHeight*uniLib.ScreenUtils.scaleFactor-i.height)/2)),a.PopupManager.addPopUp(i,!0)},b.prototype.showMask=function(){this.maskMc||(this.maskMc=new egret.Sprite,this.maskMc.graphics.beginFill(0,.5),this.maskMc.graphics.drawRect(0,0,a.DataCache.defaultWidth,a.DataCache.defaultHeight),this.maskMc.graphics.endFill()),a.GameInfo.topLayer.addChild(this.maskMc)},b.prototype.hideMask=function(){this.maskMc&&a.GameInfo.topLayer.removeChild(this.maskMc)},b.prototype.showMarket=function(){},b.prototype.backHall=function(){},b.prototype.showVideoCommonPanel=function(b,c,d,e,f,g,h){void 0===d&&(d=null),void 0===e&&(e=null),void 0===g&&(g=0),void 0===h&&(h=!0);var i=new a.MsgBox(!0);i.setData(e,b,c,d,f,g),a.GameInfo.isAllSceneApa()?(i.x=Math.round((uniLib.Global.designWidth-i.width)/2),i.y=Math.round((uniLib.Global.designHeight*uniLib.ScreenUtils.scaleFactor-i.height)/2)):(i.x=Math.round((a.DataCache.defaultWidth-i.width)/2),i.y=Math.round((a.DataCache.defaultHeight*uniLib.ScreenUtils.scaleFactor-i.height)/2)),a.PopupManager.addPopUp(i,!0,!1,!0,0,0,!0)},b}();a.PublicManage=b}(game||(game={}));var game;!function(a){var b=function(){function a(){}return a.getURLData=function(){if(!this.initParams){this.initParams={};var b=window.location.search;if(""==b)return;if("?"==b.charAt(0)){b=b.slice(1),a.trace("getURLData"+b);for(var c,d=b.split(/&/),e=0;e<d.length;e++)c=d[e].split(/=/),2==c.length&&(this.initParams[c[0]]=c[1],a.trace("getURLData1"+c[0],c[1]))}}return this.initParams},a.createBitmapByName=function(a,b,c,d){void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=1);var e=new egret.Bitmap,f=RES.getRes(a);return e.texture=f,e.smoothing=!0,e.x=b,e.y=c,e.scaleX=e.scaleY=d,e},a.createTexture=function(a){return RES.getRes(a)},a.trace=function(){for(var a=[],b=0;b<arguments.length;b++)a[b-0]=arguments[b];uniLib.Console.log(a.join(","))},a.randRange=function(a,b){var c=b-a;return a+Math.floor(Math.random()*c)},a.currencyFormat=function(a,b){void 0===b&&(b=-1);var c=Math.abs(a).toString(),d="";a<0&&(d="-");var e="";if(c.indexOf(".")>-1&&(e=c.substring(c.indexOf("."),c.length),c=c.substring(0,c.indexOf("."))),-1!=b)for(;c.length<b;)c="0"+c;for(var f=c.split(""),g=f.length,h=1,i=g-1;i>0;i--,h++)h/3==1&&(h=0,f[i]=","+f[i]);return d+f.join("")+e},a.backToNumber=function(a){var b=/,/g;return a=a.replace(b,""),Math.round(Number(a))},a.getCharLength=function(a){var b=new egret.ByteArray;return b.writeUTF(a),b.position=0,b.bytesAvailable},a.createMovieClip=function(a,b,c){var d,e=RES.getRes(b),f=RES.getRes(c),g=new egret.MovieClipDataFactory(e,f);return d=new egret.MovieClip(g.generateMovieClipData(a)),d.gotoAndStop(1),d.name=a,d},a.createTextFeild=function(a,b,c,d,e,f,g,h,i){void 0===e&&(e=0),void 0===f&&(f=0),void 0===g&&(g=-1),void 0===h&&(h=!1),void 0===i&&(i=0);var j=new egret.TextField;return-1!=g&&(j.width=g),j.fontFamily="微软雅黑",j.bold=h,j.textColor=a,j.textAlign=b,j.text=c,j.size=d,j.lineSpacing=i,j.x=e,j.y=f,j.multiline=!1,j},a.createFontText=function(a,b,c,d,e){void 0===b&&(b=0),void 0===c&&(c=0),void 0===d&&(d=-1),e||(e=RES.getRes("betTipText_fnt"));var f=new egret.BitmapText;return-1!=d&&(f.width=d),f.font=e,f.text=a,f.x=b,f.y=c,f},a.createScroll=function(a,b,c,d,e){void 0===d&&(d=0),void 0===e&&(e=0);var f=new egret.ScrollView;return f.width=b,f.height=c,f.x=d,f.y=e,f.setContent(a),f},a.removeFromParent=function(a){a&&a.parent&&a.parent.removeChild(a)},a.removeAllChildren=function(a){for(;a.numChildren>0;)this.removeFromParent(a.getChildAt(0))},a.getTimeStr2=function(){var a=new Date;return a.getHours()+":"+a.getMinutes()+":"+a.getSeconds()+" >>> "},a.numFormat=function(a,b){void 0===b&&(b=0);var c,d="",e="";a<0&&(a=-a,e="-");var f,g;f=[1e9,1e6,1e3],g=["B","M","K"],c=String(a);for(var h=0;h<f.length;h++)if(a>=f[h]){d=g[h],c=-1==b?String(a/f[h]):String(this.setDot(a/f[h],b));break}if(-1!=c.indexOf(".")){for(var i=0;i<b;i++)0==Number(c.charAt(c.length-1))&&(c=i+1==b?c.slice(0,c.length-2):c.slice(0,c.length-1));"."==c.charAt(c.length-1)&&(c=c.slice(0,c.length-1))}return e+c.concat(d)},a.setDot=function(a,b){return void 0===b&&(b=-1),b>0?Math.floor(a*Math.pow(10,b))/Math.pow(10,b):0==b?Math.floor(a):a},a.changeYAxis=function(a){return uniLib.Global.screenHeight-(640-a)},a}();a.ResUtil=b}(game||(game={}));var game;!function(a){var b=function(){function b(){this._soundRes={},this._curSounds=[]}return Object.defineProperty(b,"instance",{get:function(){return this._instance||(this._instance=new b),this._instance},enumerable:!0,configurable:!0}),b.prototype.playSound=function(b){var c;if(this._soundRes[b])c=this._soundRes[b],this.play(c);else{new a.SoundLoader(b).addEventListener(a.SoundLoader.LOADED,this.onSoundLoaded,this)}},b.prototype.stopSound=function(){for(var a,b=this._curSounds.length,c=0;c<b;c++)a=this._curSounds[0],a.stop(),a.removeEventListener(egret.Event.SOUND_COMPLETE,this.onSoundComplete,this),this._curSounds.splice(0,1)},b.prototype.play=function(a){var b=a.play(0,1);b.addEventListener(egret.Event.SOUND_COMPLETE,this.onSoundComplete,this),this._curSounds.push(b)},b.prototype.startPlay=function(a){var b=a.data,c=b.play(0,1);c.addEventListener(egret.Event.SOUND_COMPLETE,this.onSoundComplete,this),this._curSounds.push(c)},b.prototype.onSoundComplete=function(a){var b=a.currentTarget;b.stop(),b.removeEventListener(egret.Event.SOUND_COMPLETE,this.onSoundComplete,this);var c=this._curSounds.indexOf(b);this._curSounds.splice(c,1)},b.prototype.onSoundLoaded=function(b){b.currentTarget.removeEventListener(a.SoundLoader.LOADED,this.onSoundLoaded,this);var c=b.data.data;this._soundRes[b.data.type]=c,this.play(c)},b}();a.SoundManager=b}(game||(game={})),table.TableCard.instance=function(){return null==table.TableCard.$instance&&(table.TableCard.$instance=loadTable("TableCard_json")),table.TableCard.$instance},table.TableCard.selectByCardId=function(a){for(var b=0,c=table.TableCard.instance();b<c.length;b++){var d=c[b];if(d.cardId==a)return d}},table.TableCard.selectByThisId=function(a){for(var b=0,c=table.TableCard.instance();b<c.length;b++){var d=c[b];if(d.thisId==a)return d}},table.TableCard.thisIdToCardId=function(a){return Math.floor(.1*a)},table.TableCard.cardIdToType=function(a){return Math.floor(.1*a)},table.TableCard.thisIdToType=function(a){return Math.floor(.01*a)},table.TableCard.thisIdToIcon=function(a){var b=table.TableCard.selectByThisId(a);return b&&b.icon?b.icon:0},table.TableCard.resNormal=function(a){var b,c=table.TableCard.thisIdToIcon(a);return b=0!=c?c.toString():a.toString(),"Card_1_"+b.charAt(0)+"_"+b.charAt(1)},table.TableCard.resPutOut=function(a,b){var c,d=table.TableCard.thisIdToIcon(a);return c=0!=d?d.toString():a.toString(),"PutOutCard"+b+"_"+c.charAt(0)+"_"+c.charAt(1)},table.TableCard.resWin=function(a){var b,c=table.TableCard.thisIdToIcon(a);return b=0!=c?c.toString():a.toString(),"WinCard0_"+b.charAt(0)+"_"+b.charAt(1)},table.TableCard.resOpen=function(a){var b,c=table.TableCard.thisIdToIcon(a);return b=0!=c?c.toString():a.toString(),"OpenCard0_"+b.charAt(0)+"_"+b.charAt(1)},table.TableCard.resSound=function(a,b){var c=table.TableCard.thisIdToIcon(a);0==c&&(c=table.TableCard.thisIdToCardId(a));var d="voice_"+game.RoomInfo.getInstance().languageMode+"_"+b+"_"+c+"_mp3",e=Math.floor(10*Math.random())%game.RoomInfo.getInstance().soundRandomNum,f="voice_"+game.RoomInfo.getInstance().languageMode+"_"+b+"_"+c+"_0_mp3",g="voice_"+game.RoomInfo.getInstance().languageMode+"_"+b+"_"+c+"_"+e+"_mp3";return RES.hasRes(g)?g:RES.hasRes(f)?f:RES.hasRes(d)?d:""},table.TableCard.resSoundAction=function(a,b){var c="action_"+game.RoomInfo.getInstance().languageMode+"_"+b.toString()+a.toString()+"_mp3",d=Math.floor(10*Math.random())%game.RoomInfo.getInstance().soundRandomNum,e="action_"+game.RoomInfo.getInstance().languageMode+"_"+b.toString()+a.toString()+"_0_mp3",f="action_"+game.RoomInfo.getInstance().languageMode+"_"+b.toString()+a.toString()+"_"+d+"_mp3";return RES.hasRes(f)?f:RES.hasRes(e)?e:RES.hasRes(c)?c:""},table.TableCard.resSoundGift=function(a){var b="GiftSound"+a+"_mp3";return RES.hasRes(b)?b:""},table.TableCard.res2D5CardName=function(a){var b,c=table.TableCard.thisIdToIcon(a);return b=0!=c?c.toString():a.toString(),"D25_"+b.charAt(0)+"_"+b.charAt(1)},table.TableGift.instance=function(){return null==table.TableGift.$instance&&(table.TableGift.$instance=loadTable("TableGift_json")),table.TableGift.$instance},table.TableServerReturnCode.instance=function(){return null==table.TableServerReturnCode.$instance&&(table.TableServerReturnCode.$instance=loadTable("TableServerReturnCode_json")),table.TableServerReturnCode.$instance},table.TableVoice.instance=function(){return null==table.TableVoice.$instance&&(table.TableVoice.$instance=loadTable("TableVoice_json")),table.TableVoice.$instance},table.TableVoice.select=function(a){for(var b=0,c=table.TableVoice.instance();b<c.length;b++){var d=c[b];if(d.text==a)return d.cardId}return 0},table.TableMahjongMulti.instance=function(){return null==table.TableMahjongMulti.$instance&&(table.TableMahjongMulti.$instance=loadTable("TableMahjongMulti_json")),table.TableMahjongMulti.$instance},table.TableMahjongMulti.selectNameById=function(a){for(var b=0,c=table.TableMahjongMulti.instance();b<c.length;b++){var d=c[b];if(d.gameId==game.RoomInfo.getInstance().gameId&&d.id==a)return d.name}return""},table.TableMahjongMulti.selectTypeById=function(a){for(var b=0,c=table.TableMahjongMulti.instance();b<c.length;b++){var d=c[b];if(d.id==a)return d.type}return"+"},table.TableMahjongMulti.selectBaohuById=function(a){for(var b=0,c=table.TableMahjongMulti.instance();b<c.length;b++){var d=c[b];if(d.gameId==game.RoomInfo.getInstance().gameId&&d.id==a)return d.baohu}return 0},table.TableMahjongMulti.selectCartoonById=function(a){for(var b=0,c=table.TableMahjongMulti.instance();b<c.length;b++){var d=c[b];if(d.gameId==game.RoomInfo.getInstance().gameId&&d.id==a)return d.cartoon}return""},table.TableMahjongMulti.selectItemById=function(a){for(var b=0,c=table.TableMahjongMulti.instance();b<c.length;b++){var d=c[b];if(d.id==a&&d.gameId==uniLib.Global.gameId)return d}return null},table.TablePlayTypeList.instance=function(){return null==table.TablePlayTypeList.$instance&&(table.TablePlayTypeList.$instance=loadTable("TablePlayTypeList_json")),table.TablePlayTypeList.$instance},table.TablePlayTypeList.getPlayTypeDes=function(a){try{for(var b=0,c=table.TablePlayTypeList.instance();b<c.length;b++){var d=c[b];if(d.id==a)return d.desc}return""}catch(a){console.error("这是单独运行游戏时候TablePlayTypeList_json报错")}},table.TablePlayTypeList.getConfig=function(a){for(var b=table.TablePlayTypeList.instance(),c=0,d=b;c<d.length;c++){var e=d[c];if(e.id==a)return e}};